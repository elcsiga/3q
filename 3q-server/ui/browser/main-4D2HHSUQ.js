var _b=Object.create;var Vs=Object.defineProperty,Ib=Object.defineProperties,wb=Object.getOwnPropertyDescriptor,bb=Object.getOwnPropertyDescriptors,Eb=Object.getOwnPropertyNames,Hs=Object.getOwnPropertySymbols,Sb=Object.getPrototypeOf,Nu=Object.prototype.hasOwnProperty,Eh=Object.prototype.propertyIsEnumerable;var bh=(e,t,n)=>t in e?Vs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,p=(e,t)=>{for(var n in t||={})Nu.call(t,n)&&bh(e,n,t[n]);if(Hs)for(var n of Hs(t))Eh.call(t,n)&&bh(e,n,t[n]);return e},g=(e,t)=>Ib(e,bb(t));var Wt=(e,t)=>{var n={};for(var r in e)Nu.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&Hs)for(var r of Hs(e))t.indexOf(r)<0&&Eh.call(e,r)&&(n[r]=e[r]);return n};var Ru=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Tb=(e,t)=>{for(var n in t)Vs(e,n,{get:t[n],enumerable:!0})},xb=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Eb(t))!Nu.call(e,o)&&o!==n&&Vs(e,o,{get:()=>t[o],enumerable:!(r=wb(t,o))||r.enumerable});return e};var Sh=(e,t,n)=>(n=e!=null?_b(Sb(e)):{},xb(t||!e||!e.__esModule?Vs(n,"default",{value:e,enumerable:!0}):n,e));var LI=Ru((p9,PI)=>{"use strict";var Fo=1e3,$o=Fo*60,Uo=$o*60,Sr=Uo*24,rN=Sr*7,oN=Sr*365.25;PI.exports=function(e,t){t=t||{};var n=typeof e;if(n==="string"&&e.length>0)return iN(e);if(n==="number"&&isFinite(e))return t.long?aN(e):sN(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function iN(e){if(e=String(e),!(e.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]),r=(t[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return n*oN;case"weeks":case"week":case"w":return n*rN;case"days":case"day":case"d":return n*Sr;case"hours":case"hour":case"hrs":case"hr":case"h":return n*Uo;case"minutes":case"minute":case"mins":case"min":case"m":return n*$o;case"seconds":case"second":case"secs":case"sec":case"s":return n*Fo;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}function sN(e){var t=Math.abs(e);return t>=Sr?Math.round(e/Sr)+"d":t>=Uo?Math.round(e/Uo)+"h":t>=$o?Math.round(e/$o)+"m":t>=Fo?Math.round(e/Fo)+"s":e+"ms"}function aN(e){var t=Math.abs(e);return t>=Sr?su(e,t,Sr,"day"):t>=Uo?su(e,t,Uo,"hour"):t>=$o?su(e,t,$o,"minute"):t>=Fo?su(e,t,Fo,"second"):e+" ms"}function su(e,t,n,r){var o=t>=n*1.5;return Math.round(e/n)+" "+r+(o?"s":"")}});var FI=Ru((h9,jI)=>{"use strict";function cN(e){n.debug=n,n.default=n,n.coerce=u,n.disable=s,n.enable=o,n.enabled=a,n.humanize=LI(),n.destroy=l,Object.keys(e).forEach(d=>{n[d]=e[d]}),n.names=[],n.skips=[],n.formatters={};function t(d){let f=0;for(let m=0;m<d.length;m++)f=(f<<5)-f+d.charCodeAt(m),f|=0;return n.colors[Math.abs(f)%n.colors.length]}n.selectColor=t;function n(d){let f,m=null,h,y;function v(..._){if(!v.enabled)return;let I=v,w=Number(new Date),N=w-(f||w);I.diff=N,I.prev=f,I.curr=w,f=w,_[0]=n.coerce(_[0]),typeof _[0]!="string"&&_.unshift("%O");let S=0;_[0]=_[0].replace(/%([a-zA-Z%])/g,(R,Y)=>{if(R==="%%")return"%";S++;let ie=n.formatters[Y];if(typeof ie=="function"){let he=_[S];R=ie.call(I,he),_.splice(S,1),S--}return R}),n.formatArgs.call(I,_),(I.log||n.log).apply(I,_)}return v.namespace=d,v.useColors=n.useColors(),v.color=n.selectColor(d),v.extend=r,v.destroy=n.destroy,Object.defineProperty(v,"enabled",{enumerable:!0,configurable:!1,get:()=>m!==null?m:(h!==n.namespaces&&(h=n.namespaces,y=n.enabled(d)),y),set:_=>{m=_}}),typeof n.init=="function"&&n.init(v),v}function r(d,f){let m=n(this.namespace+(typeof f>"u"?":":f)+d);return m.log=this.log,m}function o(d){n.save(d),n.namespaces=d,n.names=[],n.skips=[];let f=(typeof d=="string"?d:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(let m of f)m[0]==="-"?n.skips.push(m.slice(1)):n.names.push(m)}function i(d,f){let m=0,h=0,y=-1,v=0;for(;m<d.length;)if(h<f.length&&(f[h]===d[m]||f[h]==="*"))f[h]==="*"?(y=h,v=m,h++):(m++,h++);else if(y!==-1)h=y+1,v++,m=v;else return!1;for(;h<f.length&&f[h]==="*";)h++;return h===f.length}function s(){let d=[...n.names,...n.skips.map(f=>"-"+f)].join(",");return n.enable(""),d}function a(d){for(let f of n.skips)if(i(d,f))return!1;for(let f of n.names)if(i(d,f))return!0;return!1}function u(d){return d instanceof Error?d.stack||d.message:d}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}jI.exports=cN});var _p=Ru((Ve,au)=>{"use strict";Ve.formatArgs=lN;Ve.save=dN;Ve.load=fN;Ve.useColors=uN;Ve.storage=pN();Ve.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();Ve.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function uN(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let e;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function lN(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+au.exports.humanize(this.diff),!this.useColors)return;let t="color: "+this.color;e.splice(1,0,t,"color: inherit");let n=0,r=0;e[0].replace(/%[a-zA-Z%]/g,o=>{o!=="%%"&&(n++,o==="%c"&&(r=n))}),e.splice(r,0,t)}Ve.log=console.debug||console.log||(()=>{});function dN(e){try{e?Ve.storage.setItem("debug",e):Ve.storage.removeItem("debug")}catch{}}function fN(){let e;try{e=Ve.storage.getItem("debug")||Ve.storage.getItem("DEBUG")}catch{}return!e&&typeof process<"u"&&"env"in process&&(e=process.env.DEBUG),e}function pN(){try{return localStorage}catch{}}au.exports=FI()(Ve);var{formatters:hN}=au.exports;hN.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}});var xe=null,Bs=!1,ku=1,Cb=null,Ke=Symbol("SIGNAL");function z(e){let t=xe;return xe=e,t}function zs(){return xe}var qs={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Gs(e){if(Bs)throw new Error("");if(xe===null)return;xe.consumerOnSignalRead(e);let t=xe.producersTail;if(t!==void 0&&t.producer===e)return;let n,r=xe.recomputing;if(r&&(n=t!==void 0?t.nextProducer:xe.producers,n!==void 0&&n.producer===e)){xe.producersTail=n,n.lastReadVersion=e.version;return}let o=e.consumersTail;if(o!==void 0&&o.consumer===xe&&(!r||Mb(o,xe)))return;let i=Ur(xe),s={producer:e,consumer:xe,nextProducer:n,prevConsumer:o,lastReadVersion:e.version,nextConsumer:void 0};xe.producersTail=s,t!==void 0?t.nextProducer=s:xe.producers=s,i&&Mh(e,s)}function Th(){ku++}function xh(e){if(!(Ur(e)&&!e.dirty)&&!(!e.dirty&&e.lastCleanEpoch===ku)){if(!e.producerMustRecompute(e)&&!Zs(e)){Ou(e);return}e.producerRecomputeValue(e),Ou(e)}}function Pu(e){if(e.consumers===void 0)return;let t=Bs;Bs=!0;try{for(let n=e.consumers;n!==void 0;n=n.nextConsumer){let r=n.consumer;r.dirty||Db(r)}}finally{Bs=t}}function Lu(){return xe?.consumerAllowSignalWrites!==!1}function Db(e){e.dirty=!0,Pu(e),e.consumerMarkedDirty?.(e)}function Ou(e){e.dirty=!1,e.lastCleanEpoch=ku}function Ws(e){return e&&Ch(e),z(e)}function Ch(e){e.producersTail=void 0,e.recomputing=!0}function ju(e,t){z(t),e&&Dh(e)}function Dh(e){e.recomputing=!1;let t=e.producersTail,n=t!==void 0?t.nextProducer:e.producers;if(n!==void 0){if(Ur(e))do n=Fu(n);while(n!==void 0);t!==void 0?t.nextProducer=void 0:e.producers=void 0}}function Zs(e){for(let t=e.producers;t!==void 0;t=t.nextProducer){let n=t.producer,r=t.lastReadVersion;if(r!==n.version||(xh(n),r!==n.version))return!0}return!1}function Yo(e){if(Ur(e)){let t=e.producers;for(;t!==void 0;)t=Fu(t)}e.producers=void 0,e.producersTail=void 0,e.consumers=void 0,e.consumersTail=void 0}function Mh(e,t){let n=e.consumersTail,r=Ur(e);if(n!==void 0?(t.nextConsumer=n.nextConsumer,n.nextConsumer=t):(t.nextConsumer=void 0,e.consumers=t),t.prevConsumer=n,e.consumersTail=t,!r)for(let o=e.producers;o!==void 0;o=o.nextProducer)Mh(o.producer,o)}function Fu(e){let t=e.producer,n=e.nextProducer,r=e.nextConsumer,o=e.prevConsumer;if(e.nextConsumer=void 0,e.prevConsumer=void 0,r!==void 0?r.prevConsumer=o:t.consumersTail=o,o!==void 0)o.nextConsumer=r;else if(t.consumers=r,!Ur(t)){let i=t.producers;for(;i!==void 0;)i=Fu(i)}return n}function Ur(e){return e.consumerIsAlwaysLive||e.consumers!==void 0}function Ah(e){Cb?.(e)}function Mb(e,t){let n=t.producersTail;if(n!==void 0){let r=t.producers;do{if(r===e)return!0;if(r===n)break;r=r.nextProducer}while(r!==void 0)}return!1}function Nh(e,t){return Object.is(e,t)}function Ab(){throw new Error}var Rh=Ab;function Oh(e){Rh(e)}function $u(e){Rh=e}var Nb=null;function Uu(e,t){let n=Object.create(Js);n.value=e,t!==void 0&&(n.equal=t);let r=()=>kh(n);return r[Ke]=n,Ah(n),[r,s=>Ko(n,s),s=>Ph(n,s)]}function kh(e){return Gs(e),e.value}function Ko(e,t){Lu()||Oh(e),e.equal(e.value,t)||(e.value=t,Rb(e))}function Ph(e,t){Lu()||Oh(e),Ko(e,t(e.value))}var Js=g(p({},qs),{equal:Nh,value:void 0,kind:"signal"});function Rb(e){e.version++,Th(),Pu(e),Nb?.(e)}function Hu(e){let t=z(null);try{return e()}finally{z(t)}}function U(e){return typeof e=="function"}function Hr(e){let n=e(r=>{Error.call(r),r.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Qs=Hr(e=>function(n){e(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((r,o)=>`${o+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function Xo(e,t){if(e){let n=e.indexOf(t);0<=n&&e.splice(n,1)}}var Ie=class e{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let i of n)i.remove(this);else n.remove(this);let{initialTeardown:r}=this;if(U(r))try{r()}catch(i){t=i instanceof Qs?i.errors:[i]}let{_finalizers:o}=this;if(o){this._finalizers=null;for(let i of o)try{Lh(i)}catch(s){t=t??[],s instanceof Qs?t=[...t,...s.errors]:t.push(s)}}if(t)throw new Qs(t)}}add(t){var n;if(t&&t!==this)if(this.closed)Lh(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(t)}}_hasParent(t){let{_parentage:n}=this;return n===t||Array.isArray(n)&&n.includes(t)}_addParent(t){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(t),n):n?[n,t]:t}_removeParent(t){let{_parentage:n}=this;n===t?this._parentage=null:Array.isArray(n)&&Xo(n,t)}remove(t){let{_finalizers:n}=this;n&&Xo(n,t),t instanceof e&&t._removeParent(this)}};Ie.EMPTY=(()=>{let e=new Ie;return e.closed=!0,e})();var Vu=Ie.EMPTY;function Ys(e){return e instanceof Ie||e&&"closed"in e&&U(e.remove)&&U(e.add)&&U(e.unsubscribe)}function Lh(e){U(e)?e():e.unsubscribe()}var ut={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Vr={setTimeout(e,t,...n){let{delegate:r}=Vr;return r?.setTimeout?r.setTimeout(e,t,...n):setTimeout(e,t,...n)},clearTimeout(e){let{delegate:t}=Vr;return(t?.clearTimeout||clearTimeout)(e)},delegate:void 0};function Ks(e){Vr.setTimeout(()=>{let{onUnhandledError:t}=ut;if(t)t(e);else throw e})}function ei(){}var jh=Bu("C",void 0,void 0);function Fh(e){return Bu("E",void 0,e)}function $h(e){return Bu("N",e,void 0)}function Bu(e,t,n){return{kind:e,value:t,error:n}}var Un=null;function Br(e){if(ut.useDeprecatedSynchronousErrorHandling){let t=!Un;if(t&&(Un={errorThrown:!1,error:null}),e(),t){let{errorThrown:n,error:r}=Un;if(Un=null,n)throw r}}else e()}function Uh(e){ut.useDeprecatedSynchronousErrorHandling&&Un&&(Un.errorThrown=!0,Un.error=e)}var Hn=class extends Ie{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,Ys(t)&&t.add(this)):this.destination=Pb}static create(t,n,r){return new zr(t,n,r)}next(t){this.isStopped?qu($h(t),this):this._next(t)}error(t){this.isStopped?qu(Fh(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?qu(jh,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},Ob=Function.prototype.bind;function zu(e,t){return Ob.call(e,t)}var Gu=class{constructor(t){this.partialObserver=t}next(t){let{partialObserver:n}=this;if(n.next)try{n.next(t)}catch(r){Xs(r)}}error(t){let{partialObserver:n}=this;if(n.error)try{n.error(t)}catch(r){Xs(r)}else Xs(t)}complete(){let{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(n){Xs(n)}}},zr=class extends Hn{constructor(t,n,r){super();let o;if(U(t)||!t)o={next:t??void 0,error:n??void 0,complete:r??void 0};else{let i;this&&ut.useDeprecatedNextContext?(i=Object.create(t),i.unsubscribe=()=>this.unsubscribe(),o={next:t.next&&zu(t.next,i),error:t.error&&zu(t.error,i),complete:t.complete&&zu(t.complete,i)}):o=t}this.destination=new Gu(o)}};function Xs(e){ut.useDeprecatedSynchronousErrorHandling?Uh(e):Ks(e)}function kb(e){throw e}function qu(e,t){let{onStoppedNotification:n}=ut;n&&Vr.setTimeout(()=>n(e,t))}var Pb={closed:!0,next:ei,error:kb,complete:ei};var qr=typeof Symbol=="function"&&Symbol.observable||"@@observable";function lt(e){return e}function Wu(...e){return Zu(e)}function Zu(e){return e.length===0?lt:e.length===1?e[0]:function(n){return e.reduce((r,o)=>o(r),n)}}var K=(()=>{class e{constructor(n){n&&(this._subscribe=n)}lift(n){let r=new e;return r.source=this,r.operator=n,r}subscribe(n,r,o){let i=jb(n)?n:new zr(n,r,o);return Br(()=>{let{operator:s,source:a}=this;i.add(s?s.call(i,a):a?this._subscribe(i):this._trySubscribe(i))}),i}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return r=Hh(r),new r((o,i)=>{let s=new zr({next:a=>{try{n(a)}catch(u){i(u),s.unsubscribe()}},error:i,complete:o});this.subscribe(s)})}_subscribe(n){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(n)}[qr](){return this}pipe(...n){return Zu(n)(this)}toPromise(n){return n=Hh(n),new n((r,o)=>{let i;this.subscribe(s=>i=s,s=>o(s),()=>r(i))})}}return e.create=t=>new e(t),e})();function Hh(e){var t;return(t=e??ut.Promise)!==null&&t!==void 0?t:Promise}function Lb(e){return e&&U(e.next)&&U(e.error)&&U(e.complete)}function jb(e){return e&&e instanceof Hn||Lb(e)&&Ys(e)}function Fb(e){return U(e?.lift)}function te(e){return t=>{if(Fb(t))return t.lift(function(n){try{return e(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function re(e,t,n,r,o){return new Ju(e,t,n,r,o)}var Ju=class extends Hn{constructor(t,n,r,o,i,s){super(t),this.onFinalize=i,this.shouldUnsubscribe=s,this._next=n?function(a){try{n(a)}catch(u){t.error(u)}}:super._next,this._error=o?function(a){try{o(a)}catch(u){t.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){t.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((t=this.onFinalize)===null||t===void 0||t.call(this))}}};var Vh=Hr(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var we=(()=>{class e extends K{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let r=new ea(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new Vh}next(n){Br(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(n)}})}error(n){Br(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){Br(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:r,isStopped:o,observers:i}=this;return r||o?Vu:(this.currentObservers=null,i.push(n),new Ie(()=>{this.currentObservers=null,Xo(i,n)}))}_checkFinalizedStatuses(n){let{hasError:r,thrownError:o,isStopped:i}=this;r?n.error(o):i&&n.complete()}asObservable(){let n=new K;return n.source=this,n}}return e.create=(t,n)=>new ea(t,n),e})(),ea=class extends we{constructor(t,n){super(),this.destination=t,this.source=n}next(t){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.next)===null||r===void 0||r.call(n,t)}error(t){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.error)===null||r===void 0||r.call(n,t)}complete(){var t,n;(n=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||n===void 0||n.call(t)}_subscribe(t){var n,r;return(r=(n=this.source)===null||n===void 0?void 0:n.subscribe(t))!==null&&r!==void 0?r:Vu}};var be=class extends we{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){let n=super._subscribe(t);return!n.closed&&t.next(this._value),n}getValue(){let{hasError:t,thrownError:n,_value:r}=this;if(t)throw n;return this._throwIfClosed(),r}next(t){super.next(this._value=t)}};var Fe=new K(e=>e.complete());function Bh(e){return e&&U(e.schedule)}function zh(e){return e[e.length-1]}function qh(e){return U(zh(e))?e.pop():void 0}function hn(e){return Bh(zh(e))?e.pop():void 0}function Wh(e,t,n,r){function o(i){return i instanceof n?i:new n(function(s){s(i)})}return new(n||(n=Promise))(function(i,s){function a(d){try{l(r.next(d))}catch(f){s(f)}}function u(d){try{l(r.throw(d))}catch(f){s(f)}}function l(d){d.done?i(d.value):o(d.value).then(a,u)}l((r=r.apply(e,t||[])).next())})}function Gh(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Vn(e){return this instanceof Vn?(this.v=e,this):new Vn(e)}function Zh(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),o,i=[];return o=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),o[Symbol.asyncIterator]=function(){return this},o;function s(h){return function(y){return Promise.resolve(y).then(h,f)}}function a(h,y){r[h]&&(o[h]=function(v){return new Promise(function(_,I){i.push([h,v,_,I])>1||u(h,v)})},y&&(o[h]=y(o[h])))}function u(h,y){try{l(r[h](y))}catch(v){m(i[0][3],v)}}function l(h){h.value instanceof Vn?Promise.resolve(h.value.v).then(d,f):m(i[0][2],h)}function d(h){u("next",h)}function f(h){u("throw",h)}function m(h,y){h(y),i.shift(),i.length&&u(i[0][0],i[0][1])}}function Jh(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof Gh=="function"?Gh(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=e[i]&&function(s){return new Promise(function(a,u){s=e[i](s),o(a,u,s.done,s.value)})}}function o(i,s,a,u){Promise.resolve(u).then(function(l){i({value:l,done:a})},s)}}var ta=e=>e&&typeof e.length=="number"&&typeof e!="function";function na(e){return U(e?.then)}function ra(e){return U(e[qr])}function oa(e){return Symbol.asyncIterator&&U(e?.[Symbol.asyncIterator])}function ia(e){return new TypeError(`You provided ${e!==null&&typeof e=="object"?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function $b(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var sa=$b();function aa(e){return U(e?.[sa])}function ca(e){return Zh(this,arguments,function*(){let n=e.getReader();try{for(;;){let{value:r,done:o}=yield Vn(n.read());if(o)return yield Vn(void 0);yield yield Vn(r)}}finally{n.releaseLock()}})}function ua(e){return U(e?.getReader)}function me(e){if(e instanceof K)return e;if(e!=null){if(ra(e))return Ub(e);if(ta(e))return Hb(e);if(na(e))return Vb(e);if(oa(e))return Qh(e);if(aa(e))return Bb(e);if(ua(e))return zb(e)}throw ia(e)}function Ub(e){return new K(t=>{let n=e[qr]();if(U(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Hb(e){return new K(t=>{for(let n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}function Vb(e){return new K(t=>{e.then(n=>{t.closed||(t.next(n),t.complete())},n=>t.error(n)).then(null,Ks)})}function Bb(e){return new K(t=>{for(let n of e)if(t.next(n),t.closed)return;t.complete()})}function Qh(e){return new K(t=>{qb(e,t).catch(n=>t.error(n))})}function zb(e){return Qh(ca(e))}function qb(e,t){var n,r,o,i;return Wh(this,void 0,void 0,function*(){try{for(n=Jh(e);r=yield n.next(),!r.done;){let s=r.value;if(t.next(s),t.closed)return}}catch(s){o={error:s}}finally{try{r&&!r.done&&(i=n.return)&&(yield i.call(n))}finally{if(o)throw o.error}}t.complete()})}function $e(e,t,n,r=0,o=!1){let i=t.schedule(function(){n(),o?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(i),!o)return i}function la(e,t=0){return te((n,r)=>{n.subscribe(re(r,o=>$e(r,e,()=>r.next(o),t),()=>$e(r,e,()=>r.complete(),t),o=>$e(r,e,()=>r.error(o),t)))})}function da(e,t=0){return te((n,r)=>{r.add(e.schedule(()=>n.subscribe(r),t))})}function Yh(e,t){return me(e).pipe(da(t),la(t))}function Kh(e,t){return me(e).pipe(da(t),la(t))}function Xh(e,t){return new K(n=>{let r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}function em(e,t){return new K(n=>{let r;return $e(n,t,()=>{r=e[sa](),$e(n,t,()=>{let o,i;try{({value:o,done:i}=r.next())}catch(s){n.error(s);return}i?n.complete():n.next(o)},0,!0)}),()=>U(r?.return)&&r.return()})}function fa(e,t){if(!e)throw new Error("Iterable cannot be null");return new K(n=>{$e(n,t,()=>{let r=e[Symbol.asyncIterator]();$e(n,t,()=>{r.next().then(o=>{o.done?n.complete():n.next(o.value)})},0,!0)})})}function tm(e,t){return fa(ca(e),t)}function nm(e,t){if(e!=null){if(ra(e))return Yh(e,t);if(ta(e))return Xh(e,t);if(na(e))return Kh(e,t);if(oa(e))return fa(e,t);if(aa(e))return em(e,t);if(ua(e))return tm(e,t)}throw ia(e)}function ge(e,t){return t?nm(e,t):me(e)}function Z(...e){let t=hn(e);return ge(e,t)}function Qu(e,t){let n=U(e)?e:()=>e,r=o=>o.error(n());return new K(t?o=>t.schedule(r,0,o):r)}function pa(e){return!!e&&(e instanceof K||U(e.lift)&&U(e.subscribe))}var Bn=Hr(e=>function(){e(this),this.name="EmptyError",this.message="no elements in sequence"});function se(e,t){return te((n,r)=>{let o=0;n.subscribe(re(r,i=>{r.next(e.call(t,i,o++))}))})}var{isArray:Gb}=Array;function Wb(e,t){return Gb(t)?e(...t):e(t)}function rm(e){return se(t=>Wb(e,t))}var{isArray:Zb}=Array,{getPrototypeOf:Jb,prototype:Qb,keys:Yb}=Object;function om(e){if(e.length===1){let t=e[0];if(Zb(t))return{args:t,keys:null};if(Kb(t)){let n=Yb(t);return{args:n.map(r=>t[r]),keys:n}}}return{args:e,keys:null}}function Kb(e){return e&&typeof e=="object"&&Jb(e)===Qb}function im(e,t){return e.reduce((n,r,o)=>(n[r]=t[o],n),{})}function Yu(...e){let t=hn(e),n=qh(e),{args:r,keys:o}=om(e);if(r.length===0)return ge([],t);let i=new K(Xb(r,t,o?s=>im(o,s):lt));return n?i.pipe(rm(n)):i}function Xb(e,t,n=lt){return r=>{sm(t,()=>{let{length:o}=e,i=new Array(o),s=o,a=o;for(let u=0;u<o;u++)sm(t,()=>{let l=ge(e[u],t),d=!1;l.subscribe(re(r,f=>{i[u]=f,d||(d=!0,a--),a||r.next(n(i.slice()))},()=>{--s||r.complete()}))},r)},r)}}function sm(e,t,n){e?$e(n,e,t):t()}function am(e,t,n,r,o,i,s,a){let u=[],l=0,d=0,f=!1,m=()=>{f&&!u.length&&!l&&t.complete()},h=v=>l<r?y(v):u.push(v),y=v=>{i&&t.next(v),l++;let _=!1;me(n(v,d++)).subscribe(re(t,I=>{o?.(I),i?h(I):t.next(I)},()=>{_=!0},void 0,()=>{if(_)try{for(l--;u.length&&l<r;){let I=u.shift();s?$e(t,s,()=>y(I)):y(I)}m()}catch(I){t.error(I)}}))};return e.subscribe(re(t,h,()=>{f=!0,m()})),()=>{a?.()}}function Me(e,t,n=1/0){return U(t)?Me((r,o)=>se((i,s)=>t(r,i,o,s))(me(e(r,o))),n):(typeof t=="number"&&(n=t),te((r,o)=>am(r,o,e,n)))}function cm(e=1/0){return Me(lt,e)}function um(){return cm(1)}function Gr(...e){return um()(ge(e,hn(e)))}function ti(e){return new K(t=>{me(e()).subscribe(t)})}function Ct(e,t){return te((n,r)=>{let o=0;n.subscribe(re(r,i=>e.call(t,i,o++)&&r.next(i)))})}function ni(e){return te((t,n)=>{let r=null,o=!1,i;r=t.subscribe(re(n,void 0,void 0,s=>{i=me(e(s,ni(e)(t))),r?(r.unsubscribe(),r=null,i.subscribe(n)):o=!0})),o&&(r.unsubscribe(),r=null,i.subscribe(n))})}function ha(e,t){return U(t)?Me(e,t,1):Me(e,1)}function Ku(e){return te((t,n)=>{let r=!1;t.subscribe(re(n,o=>{r=!0,n.next(o)},()=>{r||n.next(e),n.complete()}))})}function Zt(e){return e<=0?()=>Fe:te((t,n)=>{let r=0;t.subscribe(re(n,o=>{++r<=e&&(n.next(o),e<=r&&n.complete())}))})}function lm(e=eE){return te((t,n)=>{let r=!1;t.subscribe(re(n,o=>{r=!0,n.next(o)},()=>r?n.complete():n.error(e())))})}function eE(){return new Bn}function Xu(e){return te((t,n)=>{try{t.subscribe(n)}finally{n.add(e)}})}function Jt(e,t){let n=arguments.length>=2;return r=>r.pipe(e?Ct((o,i)=>e(o,i,r)):lt,Zt(1),n?Ku(t):lm(()=>new Bn))}function ma(e){return e<=0?()=>Fe:te((t,n)=>{let r=[];t.subscribe(re(n,o=>{r.push(o),e<r.length&&r.shift()},()=>{for(let o of r)n.next(o);n.complete()},void 0,()=>{r=null}))})}function el(...e){let t=hn(e);return te((n,r)=>{(t?Gr(e,n,t):Gr(e,n)).subscribe(r)})}function Dt(e,t){return te((n,r)=>{let o=null,i=0,s=!1,a=()=>s&&!o&&r.complete();n.subscribe(re(r,u=>{o?.unsubscribe();let l=0,d=i++;me(e(u,d)).subscribe(o=re(r,f=>r.next(t?t(u,f,d,l++):f),()=>{o=null,a()}))},()=>{s=!0,a()}))})}function ri(e){return te((t,n)=>{me(e).subscribe(re(n,()=>n.complete(),ei)),!n.closed&&t.subscribe(n)})}function Ae(e,t,n){let r=U(e)||t||n?{next:e,error:t,complete:n}:e;return r?te((o,i)=>{var s;(s=r.subscribe)===null||s===void 0||s.call(r);let a=!0;o.subscribe(re(i,u=>{var l;(l=r.next)===null||l===void 0||l.call(r,u),i.next(u)},()=>{var u;a=!1,(u=r.complete)===null||u===void 0||u.call(r),i.complete()},u=>{var l;a=!1,(l=r.error)===null||l===void 0||l.call(r,u),i.error(u)},()=>{var u,l;a&&((u=r.unsubscribe)===null||u===void 0||u.call(r)),(l=r.finalize)===null||l===void 0||l.call(r)}))}):lt}var tl;function ga(){return tl}function Mt(e){let t=tl;return tl=e,t}var dm=Symbol("NotFound");function Wr(e){return e===dm||e?.name==="\u0275NotFound"}var P=class extends Error{code;constructor(t,n){super(ui(t,n)),this.code=t}};function oE(e){return`NG0${Math.abs(e)}`}function ui(e,t){return`${oE(e)}${t?": "+t:""}`}function ne(e){for(let t in e)if(e[t]===ne)return t;throw Error("")}function mn(e){if(typeof e=="string")return e;if(Array.isArray(e))return`[${e.map(mn).join(", ")}]`;if(e==null)return""+e;let t=e.overriddenName||e.name;if(t)return`${t}`;let n=e.toString();if(n==null)return""+n;let r=n.indexOf(`
`);return r>=0?n.slice(0,r):n}function gl(e,t){return e?t?`${e} ${t}`:e:t||""}var iE=ne({__forward_ref__:ne});function ba(e){return e.__forward_ref__=ba,e.toString=function(){return mn(this())},e}function Ue(e){return yl(e)?e():e}function yl(e){return typeof e=="function"&&e.hasOwnProperty(iE)&&e.__forward_ref__===ba}function j(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function li(e){return sE(e,Ea)}function vl(e){return li(e)!==null}function sE(e,t){return e.hasOwnProperty(t)&&e[t]||null}function aE(e){let t=e?.[Ea]??null;return t||null}function rl(e){return e&&e.hasOwnProperty(va)?e[va]:null}var Ea=ne({\u0275prov:ne}),va=ne({\u0275inj:ne}),L=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(t,n){this._desc=t,this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=j({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function _l(e){return e&&!!e.\u0275providers}var Il=ne({\u0275cmp:ne}),wl=ne({\u0275dir:ne}),bl=ne({\u0275pipe:ne}),El=ne({\u0275mod:ne}),ii=ne({\u0275fac:ne}),Jn=ne({__NG_ELEMENT_ID__:ne}),fm=ne({__NG_ENV_ID__:ne});function gm(e){return typeof e=="string"?e:e==null?"":String(e)}function ym(e){return typeof e=="function"?e.name||e.toString():typeof e=="object"&&e!=null&&typeof e.type=="function"?e.type.name||e.type.toString():gm(e)}var vm=ne({ngErrorCode:ne}),cE=ne({ngErrorMessage:ne}),uE=ne({ngTokenPath:ne});function Sl(e,t){return _m("",-200,t)}function Sa(e,t){throw new P(-201,!1)}function _m(e,t,n){let r=new P(t,e);return r[vm]=t,r[cE]=e,n&&(r[uE]=n),r}function lE(e){return e[vm]}var ol;function Im(){return ol}function qe(e){let t=ol;return ol=e,t}function Tl(e,t,n){let r=li(e);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(n&8)return null;if(t!==void 0)return t;Sa(e,"Injector")}var dE={},zn=dE,fE="__NG_DI_FLAG__",il=class{injector;constructor(t){this.injector=t}retrieve(t,n){let r=qn(n)||0;try{return this.injector.get(t,r&8?null:zn,r)}catch(o){if(Wr(o))return o;throw o}}};function pE(e,t=0){let n=ga();if(n===void 0)throw new P(-203,!1);if(n===null)return Tl(e,void 0,t);{let r=hE(t),o=n.retrieve(e,r);if(Wr(o)){if(r.optional)return null;throw o}return o}}function G(e,t=0){return(Im()||pE)(Ue(e),t)}function x(e,t){return G(e,qn(t))}function qn(e){return typeof e>"u"||typeof e=="number"?e:0|(e.optional&&8)|(e.host&&1)|(e.self&&2)|(e.skipSelf&&4)}function hE(e){return{optional:!!(e&8),host:!!(e&1),self:!!(e&2),skipSelf:!!(e&4)}}function sl(e){let t=[];for(let n=0;n<e.length;n++){let r=Ue(e[n]);if(Array.isArray(r)){if(r.length===0)throw new P(900,!1);let o,i=0;for(let s=0;s<r.length;s++){let a=r[s],u=mE(a);typeof u=="number"?u===-1?o=a.token:i|=u:o=a}t.push(G(o,i))}else t.push(G(r))}return t}function mE(e){return e[fE]}function Gn(e,t){let n=e.hasOwnProperty(ii);return n?e[ii]:null}function wm(e,t,n){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++){let o=e[r],i=t[r];if(n&&(o=n(o),i=n(i)),i!==o)return!1}return!0}function bm(e){return e.flat(Number.POSITIVE_INFINITY)}function Ta(e,t){e.forEach(n=>Array.isArray(n)?Ta(n,t):t(n))}function xl(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function di(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}var Qn={},Wn=[],Yn=new L(""),Cl=new L("",-1),Dl=new L(""),si=class{get(t,n=zn){if(n===zn){let o=_m("",-201);throw o.name="\u0275NotFound",o}return n}};function Ml(e){return e[El]||null}function yn(e){return e[Il]||null}function Al(e){return e[wl]||null}function Em(e){return e[bl]||null}function Kn(e){return{\u0275providers:e}}function Sm(e){return Kn([{provide:Yn,multi:!0,useValue:e}])}function Tm(...e){return{\u0275providers:Nl(!0,e),\u0275fromNgModule:!0}}function Nl(e,...t){let n=[],r=new Set,o,i=s=>{n.push(s)};return Ta(t,s=>{let a=s;_a(a,i,[],r)&&(o||=[],o.push(a))}),o!==void 0&&xm(o,i),n}function xm(e,t){for(let n=0;n<e.length;n++){let{ngModule:r,providers:o}=e[n];Rl(o,i=>{t(i,r)})}}function _a(e,t,n,r){if(e=Ue(e),!e)return!1;let o=null,i=rl(e),s=!i&&yn(e);if(!i&&!s){let u=e.ngModule;if(i=rl(u),i)o=u;else return!1}else{if(s&&!s.standalone)return!1;o=e}let a=r.has(o);if(s){if(a)return!1;if(r.add(o),s.dependencies){let u=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let l of u)_a(l,t,n,r)}}else if(i){if(i.imports!=null&&!a){r.add(o);let l;try{Ta(i.imports,d=>{_a(d,t,n,r)&&(l||=[],l.push(d))})}finally{}l!==void 0&&xm(l,t)}if(!a){let l=Gn(o)||(()=>new o);t({provide:o,useFactory:l,deps:Wn},o),t({provide:Dl,useValue:o,multi:!0},o),t({provide:Yn,useValue:()=>G(o),multi:!0},o)}let u=i.providers;if(u!=null&&!a){let l=e;Rl(u,d=>{t(d,l)})}}else return!1;return o!==e&&e.providers!==void 0}function Rl(e,t){for(let n of e)_l(n)&&(n=n.\u0275providers),Array.isArray(n)?Rl(n,t):t(n)}var gE=ne({provide:String,useValue:ne});function Cm(e){return e!==null&&typeof e=="object"&&gE in e}function yE(e){return!!(e&&e.useExisting)}function vE(e){return!!(e&&e.useFactory)}function Ia(e){return typeof e=="function"}var fi=new L(""),ya={},pm={},nl;function pi(){return nl===void 0&&(nl=new si),nl}var Ee=class{},Zn=class extends Ee{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(t,n,r,o){super(),this.parent=n,this.source=r,this.scopes=o,cl(t,s=>this.processProvider(s)),this.records.set(Cl,Zr(void 0,this)),o.has("environment")&&this.records.set(Ee,Zr(void 0,this));let i=this.records.get(fi);i!=null&&typeof i.value=="string"&&this.scopes.add(i.value),this.injectorDefTypes=new Set(this.get(Dl,Wn,{self:!0}))}retrieve(t,n){let r=qn(n)||0;try{return this.get(t,zn,r)}catch(o){if(Wr(o))return o;throw o}}destroy(){oi(this),this._destroyed=!0;let t=z(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let n=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of n)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),z(t)}}onDestroy(t){return oi(this),this._onDestroyHooks.push(t),()=>this.removeOnDestroy(t)}runInContext(t){oi(this);let n=Mt(this),r=qe(void 0),o;try{return t()}finally{Mt(n),qe(r)}}get(t,n=zn,r){if(oi(this),t.hasOwnProperty(fm))return t[fm](this);let o=qn(r),i,s=Mt(this),a=qe(void 0);try{if(!(o&4)){let l=this.records.get(t);if(l===void 0){let d=EE(t)&&li(t);d&&this.injectableDefInScope(d)?l=Zr(al(t),ya):l=null,this.records.set(t,l)}if(l!=null)return this.hydrate(t,l,o)}let u=o&2?pi():this.parent;return n=o&8&&n===zn?null:n,u.get(t,n)}catch(u){let l=lE(u);throw l===-200||l===-201?new P(l,null):u}finally{qe(a),Mt(s)}}resolveInjectorInitializers(){let t=z(null),n=Mt(this),r=qe(void 0),o;try{let i=this.get(Yn,Wn,{self:!0});for(let s of i)s()}finally{Mt(n),qe(r),z(t)}}toString(){let t=[],n=this.records;for(let r of n.keys())t.push(mn(r));return`R3Injector[${t.join(", ")}]`}processProvider(t){t=Ue(t);let n=Ia(t)?t:Ue(t&&t.provide),r=IE(t);if(!Ia(t)&&t.multi===!0){let o=this.records.get(n);o||(o=Zr(void 0,ya,!0),o.factory=()=>sl(o.multi),this.records.set(n,o)),n=t,o.multi.push(t)}this.records.set(n,r)}hydrate(t,n,r){let o=z(null);try{if(n.value===pm)throw Sl(mn(t));return n.value===ya&&(n.value=pm,n.value=n.factory(void 0,r)),typeof n.value=="object"&&n.value&&bE(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}finally{z(o)}}injectableDefInScope(t){if(!t.providedIn)return!1;let n=Ue(t.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(t){let n=this._onDestroyHooks.indexOf(t);n!==-1&&this._onDestroyHooks.splice(n,1)}};function al(e){let t=li(e),n=t!==null?t.factory:Gn(e);if(n!==null)return n;if(e instanceof L)throw new P(204,!1);if(e instanceof Function)return _E(e);throw new P(204,!1)}function _E(e){if(e.length>0)throw new P(204,!1);let n=aE(e);return n!==null?()=>n.factory(e):()=>new e}function IE(e){if(Cm(e))return Zr(void 0,e.useValue);{let t=Dm(e);return Zr(t,ya)}}function Dm(e,t,n){let r;if(Ia(e)){let o=Ue(e);return Gn(o)||al(o)}else if(Cm(e))r=()=>Ue(e.useValue);else if(vE(e))r=()=>e.useFactory(...sl(e.deps||[]));else if(yE(e))r=(o,i)=>G(Ue(e.useExisting),i!==void 0&&i&8?8:void 0);else{let o=Ue(e&&(e.useClass||e.provide));if(wE(e))r=()=>new o(...sl(e.deps));else return Gn(o)||al(o)}return r}function oi(e){if(e.destroyed)throw new P(205,!1)}function Zr(e,t,n=!1){return{factory:e,value:t,multi:n?[]:void 0}}function wE(e){return!!e.deps}function bE(e){return e!==null&&typeof e=="object"&&typeof e.ngOnDestroy=="function"}function EE(e){return typeof e=="function"||typeof e=="object"&&e.ngMetadataName==="InjectionToken"}function cl(e,t){for(let n of e)Array.isArray(n)?cl(n,t):n&&_l(n)?cl(n.\u0275providers,t):t(n)}function Re(e,t){let n;e instanceof Zn?(oi(e),n=e):n=new il(e);let r,o=Mt(n),i=qe(void 0);try{return t()}finally{Mt(o),qe(i)}}function Mm(){return Im()!==void 0||ga()!=null}var dt=0,F=1,H=2,ye=3,Xe=4,et=5,hi=6,Qr=7,Se=8,vn=9,Kt=10,He=11,Yr=12,Ol=13,Xn=14,tt=15,_n=16,er=17,Nt=18,mi=19,kl=20,Qt=21,xa=22,gi=23,We=24,Ca=25,yi=26,Oe=27,Am=1;var In=7,vi=8,tr=9,Ce=10;function Xt(e){return Array.isArray(e)&&typeof e[Am]=="object"}function ft(e){return Array.isArray(e)&&e[Am]===!0}function Pl(e){return(e.flags&4)!==0}function nr(e){return e.componentOffset>-1}function Da(e){return(e.flags&1)===1}function rr(e){return!!e.template}function Kr(e){return(e[H]&512)!==0}function or(e){return(e[H]&256)===256}var Nm="svg",Rm="math";function pt(e){for(;Array.isArray(e);)e=e[dt];return e}function en(e,t){return pt(t[e.index])}function Ma(e,t){return e.data[t]}function Rt(e,t){let n=t[e];return Xt(n)?n:n[dt]}function Om(e){return(e[H]&4)===4}function Aa(e){return(e[H]&128)===128}function km(e){return ft(e[ye])}function wn(e,t){return t==null?null:e[t]}function Ll(e){e[er]=0}function jl(e){e[H]&1024||(e[H]|=1024,Aa(e)&&Ii(e))}function Pm(e,t){for(;e>0;)t=t[Xn],e--;return t}function _i(e){return!!(e[H]&9216||e[We]?.dirty)}function Na(e){e[Kt].changeDetectionScheduler?.notify(8),e[H]&64&&(e[H]|=1024),_i(e)&&Ii(e)}function Ii(e){e[Kt].changeDetectionScheduler?.notify(0);let t=gn(e);for(;t!==null&&!(t[H]&8192||(t[H]|=8192,!Aa(t)));)t=gn(t)}function Fl(e,t){if(or(e))throw new P(911,!1);e[Qt]===null&&(e[Qt]=[]),e[Qt].push(t)}function Lm(e,t){if(e[Qt]===null)return;let n=e[Qt].indexOf(t);n!==-1&&e[Qt].splice(n,1)}function gn(e){let t=e[ye];return ft(t)?t[ye]:t}function $l(e){return e[Qr]??=[]}function Ul(e){return e.cleanup??=[]}function jm(e,t,n,r){let o=$l(t);o.push(n),e.firstCreatePass&&Ul(e).push(r,o.length-1)}var Q={lFrame:Qm(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var ul=!1;function Fm(){return Q.lFrame.elementDepthCount}function $m(){Q.lFrame.elementDepthCount++}function Hl(){Q.lFrame.elementDepthCount--}function Um(){return Q.bindingsEnabled}function Hm(){return Q.skipHydrationRootTNode!==null}function Vl(e){return Q.skipHydrationRootTNode===e}function Bl(){Q.skipHydrationRootTNode=null}function ce(){return Q.lFrame.lView}function bn(){return Q.lFrame.tView}function Xr(e){return Q.lFrame.contextLView=e,e[Se]}function eo(e){return Q.lFrame.contextLView=null,e}function ht(){let e=zl();for(;e!==null&&e.type===64;)e=e.parent;return e}function zl(){return Q.lFrame.currentTNode}function Vm(){let e=Q.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}function wi(e,t){let n=Q.lFrame;n.currentTNode=e,n.isParent=t}function ql(){return Q.lFrame.isParent}function Bm(){Q.lFrame.isParent=!1}function Gl(){return ul}function Wl(e){let t=ul;return ul=e,t}function zm(e){return Q.lFrame.bindingIndex=e}function qm(){return Q.lFrame.bindingIndex++}function Gm(){return Q.lFrame.inI18n}function Wm(e,t){let n=Q.lFrame;n.bindingIndex=n.bindingRootIndex=e,Ra(t)}function Zm(){return Q.lFrame.currentDirectiveIndex}function Ra(e){Q.lFrame.currentDirectiveIndex=e}function Zl(){return Q.lFrame.currentQueryIndex}function Oa(e){Q.lFrame.currentQueryIndex=e}function SE(e){let t=e[F];return t.type===2?t.declTNode:t.type===1?e[et]:null}function Jl(e,t,n){if(n&4){let o=t,i=e;for(;o=o.parent,o===null&&!(n&1);)if(o=SE(i),o===null||(i=i[Xn],o.type&10))break;if(o===null)return!1;t=o,e=i}let r=Q.lFrame=Jm();return r.currentTNode=t,r.lView=e,!0}function ka(e){let t=Jm(),n=e[F];Q.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function Jm(){let e=Q.lFrame,t=e===null?null:e.child;return t===null?Qm(e):t}function Qm(e){let t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return e!==null&&(e.child=t),t}function Ym(){let e=Q.lFrame;return Q.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}var Ql=Ym;function Pa(){let e=Ym();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function Km(e){return(Q.lFrame.contextLView=Pm(e,Q.lFrame.contextLView))[Se]}function Yl(){return Q.lFrame.selectedIndex}function En(e){Q.lFrame.selectedIndex=e}function Xm(){return Q.lFrame.currentNamespace}var eg=!0;function Kl(){return eg}function Xl(e){eg=e}function ll(e,t=null,n=null,r){let o=ed(e,t,n,r);return o.resolveInjectorInitializers(),o}function ed(e,t=null,n=null,r,o=new Set){let i=[n||Wn,Tm(e)];return r=r||(typeof e=="object"?void 0:mn(e)),new Zn(i,t||pi(),r||null,o)}var At=class e{static THROW_IF_NOT_FOUND=zn;static NULL=new si;static create(t,n){if(Array.isArray(t))return ll({name:""},n,t,"");{let r=t.name??"";return ll({name:r},t.parent,t.providers,r)}}static \u0275prov=j({token:e,providedIn:"any",factory:()=>G(Cl)});static __NG_ELEMENT_ID__=-1},de=new L(""),ir=(()=>{class e{static __NG_ELEMENT_ID__=TE;static __NG_ENV_ID__=n=>n}return e})(),dl=class extends ir{_lView;constructor(t){super(),this._lView=t}get destroyed(){return or(this._lView)}onDestroy(t){let n=this._lView;return Fl(n,t),()=>Lm(n,t)}};function TE(){return new dl(ce())}var tg=!1,Sn=(()=>{class e{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new be(!1);get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new K(n=>{n.next(!1),n.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let n=this.taskId++;return this.pendingTasks.add(n),n}has(n){return this.pendingTasks.has(n)}remove(n){this.pendingTasks.delete(n),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=j({token:e,providedIn:"root",factory:()=>new e})}return e})(),fl=class extends we{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(t=!1){super(),this.__isAsync=t,Mm()&&(this.destroyRef=x(ir,{optional:!0})??void 0,this.pendingTasks=x(Sn,{optional:!0})??void 0)}emit(t){let n=z(null);try{super.next(t)}finally{z(n)}}subscribe(t,n,r){let o=t,i=n||(()=>null),s=r;if(t&&typeof t=="object"){let u=t;o=u.next?.bind(u),i=u.error?.bind(u),s=u.complete?.bind(u)}this.__isAsync&&(i=this.wrapInTimeout(i),o&&(o=this.wrapInTimeout(o)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:o,error:i,complete:s});return t instanceof Ie&&t.add(a),a}wrapInTimeout(t){return n=>{let r=this.pendingTasks?.add();setTimeout(()=>{try{t(n)}finally{r!==void 0&&this.pendingTasks?.remove(r)}})}}},Ne=fl;function wa(...e){}function td(e){let t,n;function r(){e=wa;try{n!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(n),t!==void 0&&clearTimeout(t)}catch{}}return t=setTimeout(()=>{e(),r()}),typeof requestAnimationFrame=="function"&&(n=requestAnimationFrame(()=>{e(),r()})),()=>r()}function nd(e){return queueMicrotask(()=>e()),()=>{e=wa}}var rd="isAngularZone",ai=rd+"_ID",xE=0,Ge=class e{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new Ne(!1);onMicrotaskEmpty=new Ne(!1);onStable=new Ne(!1);onError=new Ne(!1);constructor(t){let{enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:o=!1,scheduleInRootZone:i=tg}=t;if(typeof Zone>"u")throw new P(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!o&&r,s.shouldCoalesceRunChangeDetection=o,s.callbackScheduled=!1,s.scheduleInRootZone=i,ME(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(rd)===!0}static assertInAngularZone(){if(!e.isInAngularZone())throw new P(909,!1)}static assertNotInAngularZone(){if(e.isInAngularZone())throw new P(909,!1)}run(t,n,r){return this._inner.run(t,n,r)}runTask(t,n,r,o){let i=this._inner,s=i.scheduleEventTask("NgZoneEvent: "+o,t,CE,wa,wa);try{return i.runTask(s,n,r)}finally{i.cancelTask(s)}}runGuarded(t,n,r){return this._inner.runGuarded(t,n,r)}runOutsideAngular(t){return this._outer.run(t)}},CE={};function od(e){if(e._nesting==0&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function DE(e){if(e.isCheckStableRunning||e.callbackScheduled)return;e.callbackScheduled=!0;function t(){td(()=>{e.callbackScheduled=!1,pl(e),e.isCheckStableRunning=!0,od(e),e.isCheckStableRunning=!1})}e.scheduleInRootZone?Zone.root.run(()=>{t()}):e._outer.run(()=>{t()}),pl(e)}function ME(e){let t=()=>{DE(e)},n=xE++;e._inner=e._inner.fork({name:"angular",properties:{[rd]:!0,[ai]:n,[ai+n]:!0},onInvokeTask:(r,o,i,s,a,u)=>{if(AE(u))return r.invokeTask(i,s,a,u);try{return hm(e),r.invokeTask(i,s,a,u)}finally{(e.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||e.shouldCoalesceRunChangeDetection)&&t(),mm(e)}},onInvoke:(r,o,i,s,a,u,l)=>{try{return hm(e),r.invoke(i,s,a,u,l)}finally{e.shouldCoalesceRunChangeDetection&&!e.callbackScheduled&&!NE(u)&&t(),mm(e)}},onHasTask:(r,o,i,s)=>{r.hasTask(i,s),o===i&&(s.change=="microTask"?(e._hasPendingMicrotasks=s.microTask,pl(e),od(e)):s.change=="macroTask"&&(e.hasPendingMacrotasks=s.macroTask))},onHandleError:(r,o,i,s)=>(r.handleError(i,s),e.runOutsideAngular(()=>e.onError.emit(s)),!1)})}function pl(e){e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&e.callbackScheduled===!0?e.hasPendingMicrotasks=!0:e.hasPendingMicrotasks=!1}function hm(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function mm(e){e._nesting--,od(e)}var ci=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new Ne;onMicrotaskEmpty=new Ne;onStable=new Ne;onError=new Ne;run(t,n,r){return t.apply(n,r)}runGuarded(t,n,r){return t.apply(n,r)}runOutsideAngular(t){return t()}runTask(t,n,r,o){return t.apply(n,r)}};function AE(e){return ng(e,"__ignore_ng_zone__")}function NE(e){return ng(e,"__scheduler_tick__")}function ng(e,t){return!Array.isArray(e)||e.length!==1?!1:e[0]?.data?.[t]===!0}var Yt=class{_console=console;handleError(t){this._console.error("ERROR",t)}},Ot=new L("",{factory:()=>{let e=x(Ge),t=x(Ee),n;return r=>{e.runOutsideAngular(()=>{t.destroyed&&!n?setTimeout(()=>{throw r}):(n??=t.get(Yt),n.handleError(r))})}}}),rg={provide:Yn,useValue:()=>{let e=x(Yt,{optional:!0})},multi:!0},RE=new L("",{factory:()=>{let e=x(de).defaultView;if(!e)return;let t=x(Ot),n=i=>{t(i.reason),i.preventDefault()},r=i=>{i.error?t(i.error):t(new Error(i.message,{cause:i})),i.preventDefault()},o=()=>{e.addEventListener("unhandledrejection",n),e.addEventListener("error",r)};typeof Zone<"u"?Zone.root.run(o):o(),x(ir).onDestroy(()=>{e.removeEventListener("error",r),e.removeEventListener("unhandledrejection",n)})}});function id(){return Kn([Sm(()=>void x(RE))])}function kt(e,t){let[n,r,o]=Uu(e,t?.equal),i=n,s=i[Ke];return i.set=r,i.update=o,i.asReadonly=og.bind(i),i}function og(){let e=this[Ke];if(e.readonlyFn===void 0){let t=()=>this();t[Ke]=e,e.readonlyFn=t}return e.readonlyFn}var Jr=class{},bi=new L("",{factory:()=>!0});var sd=new L("");var ad=(()=>{class e{static \u0275prov=j({token:e,providedIn:"root",factory:()=>new hl})}return e})(),hl=class{dirtyEffectCount=0;queues=new Map;add(t){this.enqueue(t),this.schedule(t)}schedule(t){t.dirty&&this.dirtyEffectCount++}remove(t){let n=t.zone,r=this.queues.get(n);r.has(t)&&(r.delete(t),t.dirty&&this.dirtyEffectCount--)}enqueue(t){let n=t.zone;this.queues.has(n)||this.queues.set(n,new Set);let r=this.queues.get(n);r.has(t)||r.add(t)}flush(){for(;this.dirtyEffectCount>0;){let t=!1;for(let[n,r]of this.queues)n===null?t||=this.flushQueue(r):t||=n.run(()=>this.flushQueue(r));t||(this.dirtyEffectCount=0)}}flushQueue(t){let n=!1;for(let r of t)r.dirty&&(this.dirtyEffectCount--,n=!0,r.run());return n}},ml=class{[Ke];constructor(t){this[Ke]=t}destroy(){this[Ke].destroy()}};function tn(e){return Hu(e)}function Xa(e){return{toString:e}.toString()}function zE(e){return typeof e=="function"}function Ag(e,t,n,r){t!==null?t.applyValueToInputSignal(t,r):e[n]=r}var Ua=class{previousValue;currentValue;firstChange;constructor(t,n,r){this.previousValue=t,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}},Ad=(()=>{let e=()=>Ng;return e.ngInherit=!0,e})();function Ng(e){return e.type.prototype.ngOnChanges&&(e.setInput=GE),qE}function qE(){let e=Og(this),t=e?.current;if(t){let n=e.previous;if(n===Qn)e.previous=t;else for(let r in t)n[r]=t[r];e.current=null,this.ngOnChanges(t)}}function GE(e,t,n,r,o){let i=this.declaredInputs[r],s=Og(e)||WE(e,{previous:Qn,current:null}),a=s.current||(s.current={}),u=s.previous,l=u[i];a[i]=new Ua(l&&l.currentValue,n,u===Qn),Ag(e,t,o,n)}var Rg="__ngSimpleChanges__";function Og(e){return e[Rg]||null}function WE(e,t){return e[Rg]=t}var ig=[];var oe=function(e,t=null,n){for(let r=0;r<ig.length;r++){let o=ig[r];o(e,t,n)}},X=(function(e){return e[e.TemplateCreateStart=0]="TemplateCreateStart",e[e.TemplateCreateEnd=1]="TemplateCreateEnd",e[e.TemplateUpdateStart=2]="TemplateUpdateStart",e[e.TemplateUpdateEnd=3]="TemplateUpdateEnd",e[e.LifecycleHookStart=4]="LifecycleHookStart",e[e.LifecycleHookEnd=5]="LifecycleHookEnd",e[e.OutputStart=6]="OutputStart",e[e.OutputEnd=7]="OutputEnd",e[e.BootstrapApplicationStart=8]="BootstrapApplicationStart",e[e.BootstrapApplicationEnd=9]="BootstrapApplicationEnd",e[e.BootstrapComponentStart=10]="BootstrapComponentStart",e[e.BootstrapComponentEnd=11]="BootstrapComponentEnd",e[e.ChangeDetectionStart=12]="ChangeDetectionStart",e[e.ChangeDetectionEnd=13]="ChangeDetectionEnd",e[e.ChangeDetectionSyncStart=14]="ChangeDetectionSyncStart",e[e.ChangeDetectionSyncEnd=15]="ChangeDetectionSyncEnd",e[e.AfterRenderHooksStart=16]="AfterRenderHooksStart",e[e.AfterRenderHooksEnd=17]="AfterRenderHooksEnd",e[e.ComponentStart=18]="ComponentStart",e[e.ComponentEnd=19]="ComponentEnd",e[e.DeferBlockStateStart=20]="DeferBlockStateStart",e[e.DeferBlockStateEnd=21]="DeferBlockStateEnd",e[e.DynamicComponentStart=22]="DynamicComponentStart",e[e.DynamicComponentEnd=23]="DynamicComponentEnd",e[e.HostBindingsUpdateStart=24]="HostBindingsUpdateStart",e[e.HostBindingsUpdateEnd=25]="HostBindingsUpdateEnd",e})(X||{});function ZE(e,t,n){let{ngOnChanges:r,ngOnInit:o,ngDoCheck:i}=t.type.prototype;if(r){let s=Ng(t);(n.preOrderHooks??=[]).push(e,s),(n.preOrderCheckHooks??=[]).push(e,s)}o&&(n.preOrderHooks??=[]).push(0-e,o),i&&((n.preOrderHooks??=[]).push(e,i),(n.preOrderCheckHooks??=[]).push(e,i))}function JE(e,t){for(let n=t.directiveStart,r=t.directiveEnd;n<r;n++){let i=e.data[n].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:u,ngAfterViewChecked:l,ngOnDestroy:d}=i;s&&(e.contentHooks??=[]).push(-n,s),a&&((e.contentHooks??=[]).push(n,a),(e.contentCheckHooks??=[]).push(n,a)),u&&(e.viewHooks??=[]).push(-n,u),l&&((e.viewHooks??=[]).push(n,l),(e.viewCheckHooks??=[]).push(n,l)),d!=null&&(e.destroyHooks??=[]).push(n,d)}}function La(e,t,n){kg(e,t,3,n)}function ja(e,t,n,r){(e[H]&3)===n&&kg(e,t,n,r)}function cd(e,t){let n=e[H];(n&3)===t&&(n&=16383,n+=1,e[H]=n)}function kg(e,t,n,r){let o=r!==void 0?e[er]&65535:0,i=r??-1,s=t.length-1,a=0;for(let u=o;u<s;u++)if(typeof t[u+1]=="number"){if(a=t[u],r!=null&&a>=r)break}else t[u]<0&&(e[er]+=65536),(a<i||i==-1)&&(QE(e,n,t,u),e[er]=(e[er]&4294901760)+u+2),u++}function sg(e,t){oe(X.LifecycleHookStart,e,t);let n=z(null);try{t.call(e)}finally{z(n),oe(X.LifecycleHookEnd,e,t)}}function QE(e,t,n,r){let o=n[r]<0,i=n[r+1],s=o?-n[r]:n[r],a=e[s];o?e[H]>>14<e[er]>>16&&(e[H]&3)===t&&(e[H]+=16384,sg(a,i)):sg(a,i)}var no=-1,Ti=class{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(t,n,r,o){this.factory=t,this.name=o,this.canSeeViewProviders=n,this.injectImpl=r}};function YE(e){return(e.flags&8)!==0}function KE(e){return(e.flags&16)!==0}function XE(e,t,n){let r=0;for(;r<n.length;){let o=n[r];if(typeof o=="number"){if(o!==0)break;r++;let i=n[r++],s=n[r++],a=n[r++];e.setAttribute(t,s,a,i)}else{let i=o,s=n[++r];tS(i)?e.setProperty(t,i,s):e.setAttribute(t,i,s),r++}}return r}function eS(e){return e===3||e===4||e===6}function tS(e){return e.charCodeAt(0)===64}function ec(e,t){if(!(t===null||t.length===0))if(e===null||e.length===0)e=t.slice();else{let n=-1;for(let r=0;r<t.length;r++){let o=t[r];typeof o=="number"?n=o:n===0||(n===-1||n===2?ag(e,n,o,null,t[++r]):ag(e,n,o,null,null))}}return e}function ag(e,t,n,r,o){let i=0,s=e.length;if(t===-1)s=-1;else for(;i<e.length;){let a=e[i++];if(typeof a=="number"){if(a===t){s=-1;break}else if(a>t){s=i-1;break}}}for(;i<e.length;){let a=e[i];if(typeof a=="number")break;if(a===n){o!==null&&(e[i+1]=o);return}i++,o!==null&&i++}s!==-1&&(e.splice(s,0,t),i=s+1),e.splice(i++,0,n),o!==null&&e.splice(i++,0,o)}function Pg(e){return e!==no}function Ha(e){return e&32767}function nS(e){return e>>16}function Va(e,t){let n=nS(e),r=t;for(;n>0;)r=r[Xn],n--;return r}var fd=!0;function cg(e){let t=fd;return fd=e,t}var rS=256,Lg=rS-1,jg=5,oS=0,Pt={};function iS(e,t,n){let r;typeof n=="string"?r=n.charCodeAt(0)||0:n.hasOwnProperty(Jn)&&(r=n[Jn]),r==null&&(r=n[Jn]=oS++);let o=r&Lg,i=1<<o;t.data[e+(o>>jg)]|=i}function Fg(e,t){let n=$g(e,t);if(n!==-1)return n;let r=t[F];r.firstCreatePass&&(e.injectorIndex=t.length,ud(r.data,e),ud(t,null),ud(r.blueprint,null));let o=Nd(e,t),i=e.injectorIndex;if(Pg(o)){let s=Ha(o),a=Va(o,t),u=a[F].data;for(let l=0;l<8;l++)t[i+l]=a[s+l]|u[s+l]}return t[i+8]=o,i}function ud(e,t){e.push(0,0,0,0,0,0,0,0,t)}function $g(e,t){return e.injectorIndex===-1||e.parent&&e.parent.injectorIndex===e.injectorIndex||t[e.injectorIndex+8]===null?-1:e.injectorIndex}function Nd(e,t){if(e.parent&&e.parent.injectorIndex!==-1)return e.parent.injectorIndex;let n=0,r=null,o=t;for(;o!==null;){if(r=zg(o),r===null)return no;if(n++,o=o[Xn],r.injectorIndex!==-1)return r.injectorIndex|n<<16}return no}function sS(e,t,n){iS(e,t,n)}function Ug(e,t,n){if(n&8||e!==void 0)return e;Sa(t,"NodeInjector")}function Hg(e,t,n,r){if(n&8&&r===void 0&&(r=null),(n&3)===0){let o=e[vn],i=qe(void 0);try{return o?o.get(t,r,n&8):Tl(t,r,n&8)}finally{qe(i)}}return Ug(r,t,n)}function Vg(e,t,n,r=0,o){if(e!==null){if(t[H]&2048&&!(r&2)){let s=lS(e,t,n,r,Pt);if(s!==Pt)return s}let i=Bg(e,t,n,r,Pt);if(i!==Pt)return i}return Hg(t,n,r,o)}function Bg(e,t,n,r,o){let i=cS(n);if(typeof i=="function"){if(!Jl(t,e,r))return r&1?Ug(o,n,r):Hg(t,n,r,o);try{let s;if(s=i(r),s==null&&!(r&8))Sa(n);else return s}finally{Ql()}}else if(typeof i=="number"){let s=null,a=$g(e,t),u=no,l=r&1?t[tt][et]:null;for((a===-1||r&4)&&(u=a===-1?Nd(e,t):t[a+8],u===no||!lg(r,!1)?a=-1:(s=t[F],a=Ha(u),t=Va(u,t)));a!==-1;){let d=t[F];if(ug(i,a,d.data)){let f=aS(a,t,n,s,r,l);if(f!==Pt)return f}u=t[a+8],u!==no&&lg(r,t[F].data[a+8]===l)&&ug(i,a,t)?(s=d,a=Ha(u),t=Va(u,t)):a=-1}}return o}function aS(e,t,n,r,o,i){let s=t[F],a=s.data[e+8],u=r==null?nr(a)&&fd:r!=s&&(a.type&3)!==0,l=o&1&&i===a,d=Fa(a,s,n,u,l);return d!==null?Ba(t,s,d,a,o):Pt}function Fa(e,t,n,r,o){let i=e.providerIndexes,s=t.data,a=i&1048575,u=e.directiveStart,l=e.directiveEnd,d=i>>20,f=r?a:a+d,m=o?a+d:l;for(let h=f;h<m;h++){let y=s[h];if(h<u&&n===y||h>=u&&y.type===n)return h}if(o){let h=s[u];if(h&&rr(h)&&h.type===n)return u}return null}function Ba(e,t,n,r,o){let i=e[n],s=t.data;if(i instanceof Ti){let a=i;if(a.resolving){let h=ym(s[n]);throw Sl(h)}let u=cg(a.canSeeViewProviders);a.resolving=!0;let l=s[n].type||s[n],d,f=a.injectImpl?qe(a.injectImpl):null,m=Jl(e,r,0);try{i=e[n]=a.factory(void 0,o,s,e,r),t.firstCreatePass&&n>=r.directiveStart&&ZE(n,s[n],t)}finally{f!==null&&qe(f),cg(u),a.resolving=!1,Ql()}}return i}function cS(e){if(typeof e=="string")return e.charCodeAt(0)||0;let t=e.hasOwnProperty(Jn)?e[Jn]:void 0;return typeof t=="number"?t>=0?t&Lg:uS:t}function ug(e,t,n){let r=1<<e;return!!(n[t+(e>>jg)]&r)}function lg(e,t){return!(e&2)&&!(e&1&&t)}var sr=class{_tNode;_lView;constructor(t,n){this._tNode=t,this._lView=n}get(t,n,r){return Vg(this._tNode,this._lView,t,qn(r),n)}};function uS(){return new sr(ht(),ce())}function tc(e){return Xa(()=>{let t=e.prototype.constructor,n=t[ii]||pd(t),r=Object.prototype,o=Object.getPrototypeOf(e.prototype).constructor;for(;o&&o!==r;){let i=o[ii]||pd(o);if(i&&i!==n)return i;o=Object.getPrototypeOf(o)}return i=>new i})}function pd(e){return yl(e)?()=>{let t=pd(Ue(e));return t&&t()}:Gn(e)}function lS(e,t,n,r,o){let i=e,s=t;for(;i!==null&&s!==null&&s[H]&2048&&!Kr(s);){let a=Bg(i,s,n,r|2,Pt);if(a!==Pt)return a;let u=i.parent;if(!u){let l=s[kl];if(l){let d=l.get(n,Pt,r);if(d!==Pt)return d}u=zg(s),s=s[Xn]}i=u}return o}function zg(e){let t=e[F],n=t.type;return n===2?t.declTNode:n===1?e[et]:null}function dS(){return ao(ht(),ce())}function ao(e,t){return new Mi(en(e,t))}var Mi=(()=>{class e{nativeElement;constructor(n){this.nativeElement=n}static __NG_ELEMENT_ID__=dS}return e})();function fS(e){return e instanceof Mi?e.nativeElement:e}function pS(){return this._results[Symbol.iterator]()}var za=class{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new we}constructor(t=!1){this._emitDistinctChangesOnly=t}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,n){return this._results.reduce(t,n)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,n){this.dirty=!1;let r=bm(t);(this._changesDetected=!wm(this._results,r,n))&&(this._results=r,this.length=r.length,this.last=r[this.length-1],this.first=r[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(t){this._onDirty=t}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=pS};function qg(e){return(e.flags&128)===128}var Rd=(function(e){return e[e.OnPush=0]="OnPush",e[e.Default=1]="Default",e})(Rd||{}),Gg=new Map,hS=0;function mS(){return hS++}function gS(e){Gg.set(e[mi],e)}function hd(e){Gg.delete(e[mi])}var dg="__ngContext__";function ro(e,t){Xt(t)?(e[dg]=t[mi],gS(t)):e[dg]=t}function Wg(e){return Jg(e[Yr])}function Zg(e){return Jg(e[Xe])}function Jg(e){for(;e!==null&&!ft(e);)e=e[Xe];return e}var yS;function Od(e){yS=e}var nc=new L("",{factory:()=>vS}),vS="ng";var rc=new L(""),Ai=new L("",{providedIn:"platform",factory:()=>"unknown"});var oc=new L("",{factory:()=>x(de).body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var Qg=!1,Yg=new L("",{factory:()=>Qg});var _S=(e,t,n,r)=>{};function IS(e,t,n,r){_S(e,t,n,r)}function kd(e){return(e.flags&32)===32}var wS=()=>null;function Kg(e,t,n=!1){return wS(e,t,n)}function Xg(e,t){let n=e.contentQueries;if(n!==null){let r=z(null);try{for(let o=0;o<n.length;o+=2){let i=n[o],s=n[o+1];if(s!==-1){let a=e.data[s];Oa(i),a.contentQueries(2,t[s],s)}}}finally{z(r)}}}function md(e,t,n){Oa(0);let r=z(null);try{t(e,n)}finally{z(r)}}function ey(e,t,n){if(Pl(t)){let r=z(null);try{let o=t.directiveStart,i=t.directiveEnd;for(let s=o;s<i;s++){let a=e.data[s];if(a.contentQueries){let u=n[s];a.contentQueries(1,u,s)}}}finally{z(r)}}}var gt=(function(e){return e[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",e[e.ExperimentalIsolatedShadowDom=4]="ExperimentalIsolatedShadowDom",e})(gt||{});function ty(e,t,n){return e.createElement(t,n)}function qa(e,t,n,r,o){e.insertBefore(t,n,r,o)}function ny(e,t,n){e.appendChild(t,n)}function fg(e,t,n,r,o){r!==null?qa(e,t,n,r,o):ny(e,t,n)}function bS(e,t,n,r){e.removeChild(null,t,n,r)}function ES(e,t,n){e.setAttribute(t,"style",n)}function SS(e,t,n){n===""?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n)}function ry(e,t,n){let{mergedAttrs:r,classes:o,styles:i}=n;r!==null&&XE(e,t,r),o!==null&&SS(e,t,o),i!==null&&ES(e,t,i)}function oy(e){return e instanceof Function?e():e}function TS(e,t,n){let r=e.length;for(;;){let o=e.indexOf(t,n);if(o===-1)return o;if(o===0||e.charCodeAt(o-1)<=32){let i=t.length;if(o+i===r||e.charCodeAt(o+i)<=32)return o}n=o+1}}var iy="ng-template";function xS(e,t,n,r){let o=0;if(r){for(;o<t.length&&typeof t[o]=="string";o+=2)if(t[o]==="class"&&TS(t[o+1].toLowerCase(),n,0)!==-1)return!0}else if(Pd(e))return!1;if(o=t.indexOf(1,o),o>-1){let i;for(;++o<t.length&&typeof(i=t[o])=="string";)if(i.toLowerCase()===n)return!0}return!1}function Pd(e){return e.type===4&&e.value!==iy}function CS(e,t,n){let r=e.type===4&&!n?iy:e.value;return t===r}function DS(e,t,n){let r=4,o=e.attrs,i=o!==null?NS(o):0,s=!1;for(let a=0;a<t.length;a++){let u=t[a];if(typeof u=="number"){if(!s&&!mt(r)&&!mt(u))return!1;if(s&&mt(u))continue;s=!1,r=u|r&1;continue}if(!s)if(r&4){if(r=2|r&1,u!==""&&!CS(e,u,n)||u===""&&t.length===1){if(mt(r))return!1;s=!0}}else if(r&8){if(o===null||!xS(e,o,u,n)){if(mt(r))return!1;s=!0}}else{let l=t[++a],d=MS(u,o,Pd(e),n);if(d===-1){if(mt(r))return!1;s=!0;continue}if(l!==""){let f;if(d>i?f="":f=o[d+1].toLowerCase(),r&2&&l!==f){if(mt(r))return!1;s=!0}}}}return mt(r)||s}function mt(e){return(e&1)===0}function MS(e,t,n,r){if(t===null)return-1;let o=0;if(r||!n){let i=!1;for(;o<t.length;){let s=t[o];if(s===e)return o;if(s===3||s===6)i=!0;else if(s===1||s===2){let a=t[++o];for(;typeof a=="string";)a=t[++o];continue}else{if(s===4)break;if(s===0){o+=4;continue}}o+=i?1:2}return-1}else return RS(t,e)}function AS(e,t,n=!1){for(let r=0;r<t.length;r++)if(DS(e,t[r],n))return!0;return!1}function NS(e){for(let t=0;t<e.length;t++){let n=e[t];if(eS(n))return t}return e.length}function RS(e,t){let n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){let r=e[n];if(typeof r=="number")return-1;if(r===t)return n;n++}return-1}function pg(e,t){return e?":not("+t.trim()+")":t}function OS(e){let t=e[0],n=1,r=2,o="",i=!1;for(;n<e.length;){let s=e[n];if(typeof s=="string")if(r&2){let a=e[++n];o+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else r&8?o+="."+s:r&4&&(o+=" "+s);else o!==""&&!mt(s)&&(t+=pg(i,o),o=""),r=s,i=i||!mt(r);n++}return o!==""&&(t+=pg(i,o)),t}function kS(e){return e.map(OS).join(",")}function PS(e){let t=[],n=[],r=1,o=2;for(;r<e.length;){let i=e[r];if(typeof i=="string")o===2?i!==""&&t.push(i,e[++r]):o===8&&n.push(i);else{if(!mt(o))break;o=i}r++}return n.length&&t.push(1,...n),t}var Ni={};function Ld(e,t,n,r,o,i,s,a,u,l,d){let f=Oe+r,m=f+o,h=LS(f,m),y=typeof l=="function"?l():l;return h[F]={type:e,blueprint:h,template:n,queries:null,viewQuery:a,declTNode:t,data:h.slice().fill(null,f),bindingStartIndex:f,expandoStartIndex:m,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof i=="function"?i():i,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:u,consts:y,incompleteFirstPass:!1,ssrId:d}}function LS(e,t){let n=[];for(let r=0;r<t;r++)n.push(r<e?null:Ni);return n}function jS(e){let t=e.tView;return t===null||t.incompleteFirstPass?e.tView=Ld(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts,e.id):t}function jd(e,t,n,r,o,i,s,a,u,l,d){let f=t.blueprint.slice();return f[dt]=o,f[H]=r|4|128|8|64|1024,(l!==null||e&&e[H]&2048)&&(f[H]|=2048),Ll(f),f[ye]=f[Xn]=e,f[Se]=n,f[Kt]=s||e&&e[Kt],f[He]=a||e&&e[He],f[vn]=u||e&&e[vn]||null,f[et]=i,f[mi]=mS(),f[hi]=d,f[kl]=l,f[tt]=t.type==2?e[tt]:f,f}function FS(e,t,n){let r=en(t,e),o=jS(n),i=e[Kt].rendererFactory,s=Fd(e,jd(e,o,null,sy(n),r,t,null,i.createRenderer(r,n),null,null,null));return e[t.index]=s}function sy(e){let t=16;return e.signals?t=4096:e.onPush&&(t=64),t}function ay(e,t,n,r){if(n===0)return-1;let o=t.length;for(let i=0;i<n;i++)t.push(r),e.blueprint.push(r),e.data.push(null);return o}function Fd(e,t){return e[Yr]?e[Ol][Xe]=t:e[Yr]=t,e[Ol]=t,t}function $d(e=1){cy(bn(),ce(),Yl()+e,!1)}function cy(e,t,n,r){if(!r)if((t[H]&3)===3){let i=e.preOrderCheckHooks;i!==null&&La(t,i,n)}else{let i=e.preOrderHooks;i!==null&&ja(t,i,0,n)}En(n)}var ic=(function(e){return e[e.None=0]="None",e[e.SignalBased=1]="SignalBased",e[e.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",e})(ic||{});function gd(e,t,n,r){let o=z(null);try{let[i,s,a]=e.inputs[n],u=null;(s&ic.SignalBased)!==0&&(u=t[i][Ke]),u!==null&&u.transformFn!==void 0?r=u.transformFn(r):a!==null&&(r=a.call(t,r)),e.setInput!==null?e.setInput(t,u,r,n,i):Ag(t,u,i,r)}finally{z(o)}}var cr=(function(e){return e[e.Important=1]="Important",e[e.DashCase=2]="DashCase",e})(cr||{}),$S;function Ud(e,t){return $S(e,t)}var oo=new Set,Hd=(function(e){return e[e.CHANGE_DETECTION=0]="CHANGE_DETECTION",e[e.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",e})(Hd||{}),Ri=new L(""),hg=new Set;function co(e){hg.has(e)||(hg.add(e),performance?.mark?.("mark_feature_usage",{detail:{feature:e}}))}var uy=(()=>{class e{impl=null;execute(){this.impl?.execute()}static \u0275prov=j({token:e,providedIn:"root",factory:()=>new e})}return e})();var US=new L("",{factory:()=>({queue:new Set,isScheduled:!1,scheduler:null,injector:x(Ee)})});function ly(e,t,n){let r=e.get(US);if(Array.isArray(t))for(let o of t)r.queue.add(o),n?.detachedLeaveAnimationFns?.push(o);else r.queue.add(t),n?.detachedLeaveAnimationFns?.push(t);r.scheduler&&r.scheduler(e)}function HS(e,t){for(let[n,r]of t)ly(e,r.animateFns)}function mg(e,t,n,r){let o=e?.[yi]?.enter;t!==null&&o&&o.has(n.index)&&HS(r,o)}function to(e,t,n,r,o,i,s,a){if(o!=null){let u,l=!1;ft(o)?u=o:Xt(o)&&(l=!0,o=o[dt]);let d=pt(o);e===0&&r!==null?(mg(a,r,i,n),s==null?ny(t,r,d):qa(t,r,d,s||null,!0)):e===1&&r!==null?(mg(a,r,i,n),qa(t,r,d,s||null,!0)):e===2?gg(a,i,n,f=>{bS(t,d,l,f)}):e===3&&gg(a,i,n,()=>{t.destroyNode(d)}),u!=null&&eT(t,e,n,u,i,r,s)}}function VS(e,t){dy(e,t),t[dt]=null,t[et]=null}function BS(e,t,n,r,o,i){r[dt]=o,r[et]=t,sc(e,r,n,1,o,i)}function dy(e,t){t[Kt].changeDetectionScheduler?.notify(9),sc(e,t,t[He],2,null,null)}function zS(e){let t=e[Yr];if(!t)return ld(e[F],e);for(;t;){let n=null;if(Xt(t))n=t[Yr];else{let r=t[Ce];r&&(n=r)}if(!n){for(;t&&!t[Xe]&&t!==e;)Xt(t)&&ld(t[F],t),t=t[ye];t===null&&(t=e),Xt(t)&&ld(t[F],t),n=t&&t[Xe]}t=n}}function Vd(e,t){let n=e[tr],r=n.indexOf(t);n.splice(r,1)}function Bd(e,t){if(or(t))return;let n=t[He];n.destroyNode&&sc(e,t,n,3,null,null),zS(t)}function ld(e,t){if(or(t))return;let n=z(null);try{t[H]&=-129,t[H]|=256,t[We]&&Yo(t[We]),WS(e,t),GS(e,t),t[F].type===1&&t[He].destroy();let r=t[_n];if(r!==null&&ft(t[ye])){r!==t[ye]&&Vd(r,t);let o=t[Nt];o!==null&&o.detachView(e)}hd(t)}finally{z(n)}}function gg(e,t,n,r){let o=e?.[yi];if(o==null||o.leave==null||!o.leave.has(t.index))return r(!1);e&&oo.add(e),ly(n,()=>{if(o.leave&&o.leave.has(t.index)){let s=o.leave.get(t.index),a=[];if(s){for(let u=0;u<s.animateFns.length;u++){let l=s.animateFns[u],{promise:d}=l();a.push(d)}o.detachedLeaveAnimationFns=void 0}o.running=Promise.allSettled(a),qS(e,r)}else e&&oo.delete(e),r(!1)},o)}function qS(e,t){let n=e[yi]?.running;if(n){n.then(()=>{e[yi].running=void 0,oo.delete(e),t(!0)});return}t(!1)}function GS(e,t){let n=e.cleanup,r=t[Qr];if(n!==null)for(let s=0;s<n.length-1;s+=2)if(typeof n[s]=="string"){let a=n[s+3];a>=0?r[a]():r[-a].unsubscribe(),s+=2}else{let a=r[n[s+1]];n[s].call(a)}r!==null&&(t[Qr]=null);let o=t[Qt];if(o!==null){t[Qt]=null;for(let s=0;s<o.length;s++){let a=o[s];a()}}let i=t[gi];if(i!==null){t[gi]=null;for(let s of i)s.destroy()}}function WS(e,t){let n;if(e!=null&&(n=e.destroyHooks)!=null)for(let r=0;r<n.length;r+=2){let o=t[n[r]];if(!(o instanceof Ti)){let i=n[r+1];if(Array.isArray(i))for(let s=0;s<i.length;s+=2){let a=o[i[s]],u=i[s+1];oe(X.LifecycleHookStart,a,u);try{u.call(a)}finally{oe(X.LifecycleHookEnd,a,u)}}else{oe(X.LifecycleHookStart,o,i);try{i.call(o)}finally{oe(X.LifecycleHookEnd,o,i)}}}}}function ZS(e,t,n){return JS(e,t.parent,n)}function JS(e,t,n){let r=t;for(;r!==null&&r.type&168;)t=r,r=t.parent;if(r===null)return n[dt];if(nr(r)){let{encapsulation:o}=e.data[r.directiveStart+r.componentOffset];if(o===gt.None||o===gt.Emulated)return null}return en(r,n)}function QS(e,t,n){return KS(e,t,n)}function YS(e,t,n){return e.type&40?en(e,n):null}var KS=YS,yg;function fy(e,t,n,r){let o=ZS(e,r,t),i=t[He],s=r.parent||t[et],a=QS(s,r,t);if(o!=null)if(Array.isArray(n))for(let u=0;u<n.length;u++)fg(i,o,n[u],a,!1);else fg(i,o,n,a,!1);yg!==void 0&&yg(i,r,t,n,o)}function Ei(e,t){if(t!==null){let n=t.type;if(n&3)return en(t,e);if(n&4)return yd(-1,e[t.index]);if(n&8){let r=t.child;if(r!==null)return Ei(e,r);{let o=e[t.index];return ft(o)?yd(-1,o):pt(o)}}else{if(n&128)return Ei(e,t.next);if(n&32)return Ud(t,e)()||pt(e[t.index]);{let r=py(e,t);if(r!==null){if(Array.isArray(r))return r[0];let o=gn(e[tt]);return Ei(o,r)}else return Ei(e,t.next)}}}return null}function py(e,t){if(t!==null){let r=e[tt][et],o=t.projection;return r.projection[o]}return null}function yd(e,t){let n=Ce+e+1;if(n<t.length){let r=t[n],o=r[F].firstChild;if(o!==null)return Ei(r,o)}return t[In]}function zd(e,t,n,r,o,i,s){for(;n!=null;){let a=r[vn];if(n.type===128){n=n.next;continue}let u=r[n.index],l=n.type;if(s&&t===0&&(u&&ro(pt(u),r),n.flags|=2),!kd(n))if(l&8)zd(e,t,n.child,r,o,i,!1),to(t,e,a,o,u,n,i,r);else if(l&32){let d=Ud(n,r),f;for(;f=d();)to(t,e,a,o,f,n,i,r);to(t,e,a,o,u,n,i,r)}else l&16?XS(e,t,r,n,o,i):to(t,e,a,o,u,n,i,r);n=s?n.projectionNext:n.next}}function sc(e,t,n,r,o,i){zd(n,r,e.firstChild,t,o,i,!1)}function XS(e,t,n,r,o,i){let s=n[tt],u=s[et].projection[r.projection];if(Array.isArray(u))for(let l=0;l<u.length;l++){let d=u[l];to(t,e,n[vn],o,d,r,i,n)}else{let l=u,d=s[ye];qg(r)&&(l.flags|=128),zd(e,t,l,d,o,i,!0)}}function eT(e,t,n,r,o,i,s){let a=r[In],u=pt(r);a!==u&&to(t,e,n,i,a,o,s);for(let l=Ce;l<r.length;l++){let d=r[l];sc(d[F],d,e,t,i,a)}}function hy(e,t,n,r,o){let i=Yl(),s=r&2;try{En(-1),s&&t.length>Oe&&cy(e,t,Oe,!1);let a=s?X.TemplateUpdateStart:X.TemplateCreateStart;oe(a,o,n),n(r,o)}finally{En(i);let a=s?X.TemplateUpdateEnd:X.TemplateCreateEnd;oe(a,o,n)}}function my(e,t,n){oT(e,t,n),(n.flags&64)===64&&iT(e,t,n)}function qd(e,t,n=en){let r=t.localNames;if(r!==null){let o=t.index+1;for(let i=0;i<r.length;i+=2){let s=r[i+1],a=s===-1?n(t,e):e[s];e[o++]=a}}}function tT(e,t,n,r){let i=r.get(Yg,Qg)||n===gt.ShadowDom||n===gt.ExperimentalIsolatedShadowDom,s=e.selectRootElement(t,i);return nT(s),s}function nT(e){rT(e)}var rT=()=>null;function oT(e,t,n){let r=n.directiveStart,o=n.directiveEnd;nr(n)&&FS(t,n,e.data[r+n.componentOffset]),e.firstCreatePass||Fg(n,t);let i=n.initialInputs;for(let s=r;s<o;s++){let a=e.data[s],u=Ba(t,e,s,n);if(ro(u,t),i!==null&&cT(t,s-r,u,a,n,i),rr(a)){let l=Rt(n.index,t);l[Se]=Ba(t,e,s,n)}}}function iT(e,t,n){let r=n.directiveStart,o=n.directiveEnd,i=n.index,s=Zm();try{En(i);for(let a=r;a<o;a++){let u=e.data[a],l=t[a];Ra(a),(u.hostBindings!==null||u.hostVars!==0||u.hostAttrs!==null)&&sT(u,l)}}finally{En(-1),Ra(s)}}function sT(e,t){e.hostBindings!==null&&e.hostBindings(1,t)}function aT(e,t){let n=e.directiveRegistry,r=null;if(n)for(let o=0;o<n.length;o++){let i=n[o];AS(t,i.selectors,!1)&&(r??=[],rr(i)?r.unshift(i):r.push(i))}return r}function cT(e,t,n,r,o,i){let s=i[t];if(s!==null)for(let a=0;a<s.length;a+=2){let u=s[a],l=s[a+1];gd(r,n,u,l)}}function gy(e,t,n,r,o){let i=Oe+n,s=t[F],a=o(s,t,e,r,n);t[i]=a,wi(e,!0);let u=e.type===2;return u?(ry(t[He],a,e),(Fm()===0||Da(e))&&ro(a,t),$m()):ro(a,t),Kl()&&(!u||!kd(e))&&fy(s,t,a,e),e}function yy(e){let t=e;return ql()?Bm():(t=t.parent,wi(t,!1)),t}function uT(e,t){let n=e[vn];if(!n)return;let r;try{r=n.get(Ot,null)}catch{r=null}r?.(t)}function vy(e,t,n,r,o){let i=e.inputs?.[r],s=e.hostDirectiveInputs?.[r],a=!1;if(s)for(let u=0;u<s.length;u+=2){let l=s[u],d=s[u+1],f=t.data[l];gd(f,n[l],d,o),a=!0}if(i)for(let u of i){let l=n[u],d=t.data[u];gd(d,l,r,o),a=!0}return a}function lT(e,t){let n=Rt(t,e),r=n[F];dT(r,n);let o=n[dt];o!==null&&n[hi]===null&&(n[hi]=Kg(o,n[vn])),oe(X.ComponentStart);try{Gd(r,n,n[Se])}finally{oe(X.ComponentEnd,n[Se])}}function dT(e,t){for(let n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])}function Gd(e,t,n){ka(t);try{let r=e.viewQuery;r!==null&&md(1,r,n);let o=e.template;o!==null&&hy(e,t,o,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),t[Nt]?.finishViewCreation(e),e.staticContentQueries&&Xg(e,t),e.staticViewQueries&&md(2,e.viewQuery,n);let i=e.components;i!==null&&fT(t,i)}catch(r){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),r}finally{t[H]&=-5,Pa()}}function fT(e,t){for(let n=0;n<t.length;n++)lT(e,t[n])}function _y(e,t,n,r){let o=z(null);try{let i=t.tView,a=e[H]&4096?4096:16,u=jd(e,i,n,a,null,t,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),l=e[t.index];u[_n]=l;let d=e[Nt];return d!==null&&(u[Nt]=d.createEmbeddedView(i)),Gd(i,u,n),u}finally{z(o)}}function vd(e,t){return!t||t.firstChild===null||qg(e)}function xi(e,t,n,r,o=!1){for(;n!==null;){if(n.type===128){n=o?n.projectionNext:n.next;continue}let i=t[n.index];i!==null&&r.push(pt(i)),ft(i)&&Iy(i,r);let s=n.type;if(s&8)xi(e,t,n.child,r);else if(s&32){let a=Ud(n,t),u;for(;u=a();)r.push(u)}else if(s&16){let a=py(t,n);if(Array.isArray(a))r.push(...a);else{let u=gn(t[tt]);xi(u[F],u,a,r,!0)}}n=o?n.projectionNext:n.next}return r}function Iy(e,t){for(let n=Ce;n<e.length;n++){let r=e[n],o=r[F].firstChild;o!==null&&xi(r[F],r,o,t)}e[In]!==e[dt]&&t.push(e[In])}function wy(e){if(e[Ca]!==null){for(let t of e[Ca])t.impl.addSequence(t);e[Ca].length=0}}var by=[];function pT(e){return e[We]??hT(e)}function hT(e){let t=by.pop()??Object.create(gT);return t.lView=e,t}function mT(e){e.lView[We]!==e&&(e.lView=null,by.push(e))}var gT=g(p({},qs),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:e=>{Ii(e.lView)},consumerOnSignalRead(){this.lView[We]=this}});function yT(e){let t=e[We]??Object.create(vT);return t.lView=e,t}var vT=g(p({},qs),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:e=>{let t=gn(e.lView);for(;t&&!Ey(t[F]);)t=gn(t);t&&jl(t)},consumerOnSignalRead(){this.lView[We]=this}});function Ey(e){return e.type!==2}function Sy(e){if(e[gi]===null)return;let t=!0;for(;t;){let n=!1;for(let r of e[gi])r.dirty&&(n=!0,r.zone===null||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));t=n&&!!(e[H]&8192)}}var _T=100;function Ty(e,t=0){let r=e[Kt].rendererFactory,o=!1;o||r.begin?.();try{IT(e,t)}finally{o||r.end?.()}}function IT(e,t){let n=Gl();try{Wl(!0),_d(e,t);let r=0;for(;_i(e);){if(r===_T)throw new P(103,!1);r++,_d(e,1)}}finally{Wl(n)}}function wT(e,t,n,r){if(or(t))return;let o=t[H],i=!1,s=!1;ka(t);let a=!0,u=null,l=null;i||(Ey(e)?(l=pT(t),u=Ws(l)):zs()===null?(a=!1,l=yT(t),u=Ws(l)):t[We]&&(Yo(t[We]),t[We]=null));try{Ll(t),zm(e.bindingStartIndex),n!==null&&hy(e,t,n,2,r);let d=(o&3)===3;if(!i)if(d){let h=e.preOrderCheckHooks;h!==null&&La(t,h,null)}else{let h=e.preOrderHooks;h!==null&&ja(t,h,0,null),cd(t,0)}if(s||bT(t),Sy(t),xy(t,0),e.contentQueries!==null&&Xg(e,t),!i)if(d){let h=e.contentCheckHooks;h!==null&&La(t,h)}else{let h=e.contentHooks;h!==null&&ja(t,h,1),cd(t,1)}ST(e,t);let f=e.components;f!==null&&Dy(t,f,0);let m=e.viewQuery;if(m!==null&&md(2,m,r),!i)if(d){let h=e.viewCheckHooks;h!==null&&La(t,h)}else{let h=e.viewHooks;h!==null&&ja(t,h,2),cd(t,2)}if(e.firstUpdatePass===!0&&(e.firstUpdatePass=!1),t[xa]){for(let h of t[xa])h();t[xa]=null}i||(wy(t),t[H]&=-73)}catch(d){throw i||Ii(t),d}finally{l!==null&&(ju(l,u),a&&mT(l)),Pa()}}function xy(e,t){for(let n=Wg(e);n!==null;n=Zg(n))for(let r=Ce;r<n.length;r++){let o=n[r];Cy(o,t)}}function bT(e){for(let t=Wg(e);t!==null;t=Zg(t)){if(!(t[H]&2))continue;let n=t[tr];for(let r=0;r<n.length;r++){let o=n[r];jl(o)}}}function ET(e,t,n){oe(X.ComponentStart);let r=Rt(t,e);try{Cy(r,n)}finally{oe(X.ComponentEnd,r[Se])}}function Cy(e,t){Aa(e)&&_d(e,t)}function _d(e,t){let r=e[F],o=e[H],i=e[We],s=!!(t===0&&o&16);if(s||=!!(o&64&&t===0),s||=!!(o&1024),s||=!!(i?.dirty&&Zs(i)),s||=!1,i&&(i.dirty=!1),e[H]&=-9217,s)wT(r,e,r.template,e[Se]);else if(o&8192){let a=z(null);try{Sy(e),xy(e,1);let u=r.components;u!==null&&Dy(e,u,1),wy(e)}finally{z(a)}}}function Dy(e,t,n){for(let r=0;r<t.length;r++)ET(e,t[r],n)}function ST(e,t){let n=e.hostBindingOpCodes;if(n!==null)try{for(let r=0;r<n.length;r++){let o=n[r];if(o<0)En(~o);else{let i=o,s=n[++r],a=n[++r];Wm(s,i);let u=t[i];oe(X.HostBindingsUpdateStart,u);try{a(2,u)}finally{oe(X.HostBindingsUpdateEnd,u)}}}}finally{En(-1)}}function Wd(e,t){let n=Gl()?64:1088;for(e[Kt].changeDetectionScheduler?.notify(t);e;){e[H]|=n;let r=gn(e);if(Kr(e)&&!r)return e;e=r}return null}function My(e,t,n,r){return[e,!0,0,t,null,r,null,n,null,null]}function TT(e,t){let n=Ce+t;if(n<e.length)return e[n]}function Ay(e,t,n,r=!0){let o=t[F];if(CT(o,t,e,n),r){let s=yd(n,e),a=t[He],u=a.parentNode(e[In]);u!==null&&BS(o,e[et],a,t,u,s)}let i=t[hi];i!==null&&i.firstChild!==null&&(i.firstChild=null)}function xT(e,t){let n=Ga(e,t);return n!==void 0&&Bd(n[F],n),n}function Ga(e,t){if(e.length<=Ce)return;let n=Ce+t,r=e[n];if(r){let o=r[_n];o!==null&&o!==e&&Vd(o,r),t>0&&(e[n-1][Xe]=r[Xe]);let i=di(e,Ce+t);VS(r[F],r);let s=i[Nt];s!==null&&s.detachView(i[F]),r[ye]=null,r[Xe]=null,r[H]&=-129}return r}function CT(e,t,n,r){let o=Ce+r,i=n.length;r>0&&(n[o-1][Xe]=t),r<i-Ce?(t[Xe]=n[o],xl(n,Ce+r,t)):(n.push(t),t[Xe]=null),t[ye]=n;let s=t[_n];s!==null&&n!==s&&Ny(s,t);let a=t[Nt];a!==null&&a.insertView(e),Na(t),t[H]|=128}function Ny(e,t){let n=e[tr],r=t[ye];if(Xt(r))e[H]|=2;else{let o=r[ye][tt];t[tt]!==o&&(e[H]|=2)}n===null?e[tr]=[t]:n.push(t)}var Tn=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let t=this._lView,n=t[F];return xi(n,t,n.firstChild,[])}constructor(t,n){this._lView=t,this._cdRefInjectingView=n}get context(){return this._lView[Se]}set context(t){this._lView[Se]=t}get destroyed(){return or(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let t=this._lView[ye];if(ft(t)){let n=t[vi],r=n?n.indexOf(this):-1;r>-1&&(Ga(t,r),di(n,r))}this._attachedToViewContainer=!1}Bd(this._lView[F],this._lView)}onDestroy(t){Fl(this._lView,t)}markForCheck(){Wd(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[H]&=-129}reattach(){Na(this._lView),this._lView[H]|=128}detectChanges(){this._lView[H]|=1024,Ty(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new P(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let t=Kr(this._lView),n=this._lView[_n];n!==null&&!t&&Vd(n,this._lView),dy(this._lView[F],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new P(902,!1);this._appRef=t;let n=Kr(this._lView),r=this._lView[_n];r!==null&&!n&&Ny(r,this._lView),Na(this._lView)}};var Ci=(()=>{class e{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=DT;constructor(n,r,o){this._declarationLView=n,this._declarationTContainer=r,this.elementRef=o}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(n,r){return this.createEmbeddedViewImpl(n,r)}createEmbeddedViewImpl(n,r,o){let i=_y(this._declarationLView,this._declarationTContainer,n,{embeddedViewInjector:r,dehydratedView:o});return new Tn(i)}}return e})();function DT(){return Zd(ht(),ce())}function Zd(e,t){return e.type&4?new Ci(t,e,ao(e,t)):null}function Jd(e,t,n,r,o){let i=e.data[t];if(i===null)i=MT(e,t,n,r,o),Gm()&&(i.flags|=32);else if(i.type&64){i.type=n,i.value=r,i.attrs=o;let s=Vm();i.injectorIndex=s===null?-1:s.injectorIndex}return wi(i,!0),i}function MT(e,t,n,r,o){let i=zl(),s=ql(),a=s?i:i&&i.parent,u=e.data[t]=NT(e,a,n,t,r,o);return AT(e,u,i,s),u}function AT(e,t,n,r){e.firstChild===null&&(e.firstChild=t),n!==null&&(r?n.child==null&&t.parent!==null&&(n.child=t):n.next===null&&(n.next=t,t.prev=n))}function NT(e,t,n,r,o,i){let s=t?t.injectorIndex:-1,a=0;return Hm()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,fieldIndex:-1,customControlIndex:-1,propertyBindings:null,flags:a,providerIndexes:0,value:o,attrs:i,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var RT=()=>null,OT=()=>null;function vg(e,t){return RT(e,t)}function kT(e,t,n){return OT(e,t,n)}var Ry=class{},ac=class{},Id=class{resolveComponentFactory(t){throw new P(917,!1)}},Oi=class{static NULL=new Id},ar=class{};var Oy=(()=>{class e{static \u0275prov=j({token:e,providedIn:"root",factory:()=>null})}return e})();var $a={},wd=class{injector;parentInjector;constructor(t,n){this.injector=t,this.parentInjector=n}get(t,n,r){let o=this.injector.get(t,$a,r);return o!==$a||n===$a?o:this.parentInjector.get(t,n,r)}};function Wa(e,t,n){let r=n?e.styles:null,o=n?e.classes:null,i=0;if(t!==null)for(let s=0;s<t.length;s++){let a=t[s];if(typeof a=="number")i=a;else if(i==1)o=gl(o,a);else if(i==2){let u=a,l=t[++s];r=gl(r,u+": "+l+";")}}n?e.styles=r:e.stylesWithoutHost=r,n?e.classes=o:e.classesWithoutHost=o}function ky(e,t=0){let n=ce();if(n===null)return G(e,t);let r=ht();return Vg(r,n,Ue(e),t)}function PT(e,t,n,r,o){let i=r===null?null:{"":-1},s=o(e,n);if(s!==null){let a=s,u=null,l=null;for(let d of s)if(d.resolveHostDirectives!==null){[a,u,l]=d.resolveHostDirectives(s);break}FT(e,t,n,a,i,u,l)}i!==null&&r!==null&&LT(n,r,i)}function LT(e,t,n){let r=e.localNames=[];for(let o=0;o<t.length;o+=2){let i=n[t[o+1]];if(i==null)throw new P(-301,!1);r.push(t[o],i)}}function jT(e,t,n){t.componentOffset=n,(e.components??=[]).push(t.index)}function FT(e,t,n,r,o,i,s){let a=r.length,u=null;for(let m=0;m<a;m++){let h=r[m];u===null&&rr(h)&&(u=h,jT(e,n,m)),sS(Fg(n,t),e,h.type)}zT(n,e.data.length,a),u?.viewProvidersResolver&&u.viewProvidersResolver(u);for(let m=0;m<a;m++){let h=r[m];h.providersResolver&&h.providersResolver(h)}let l=!1,d=!1,f=ay(e,t,a,null);a>0&&(n.directiveToIndex=new Map);for(let m=0;m<a;m++){let h=r[m];if(n.mergedAttrs=ec(n.mergedAttrs,h.hostAttrs),UT(e,n,t,f,h),BT(f,h,o),s!==null&&s.has(h)){let[v,_]=s.get(h);n.directiveToIndex.set(h.type,[f,v+n.directiveStart,_+n.directiveStart])}else(i===null||!i.has(h))&&n.directiveToIndex.set(h.type,f);h.contentQueries!==null&&(n.flags|=4),(h.hostBindings!==null||h.hostAttrs!==null||h.hostVars!==0)&&(n.flags|=64);let y=h.type.prototype;!l&&(y.ngOnChanges||y.ngOnInit||y.ngDoCheck)&&((e.preOrderHooks??=[]).push(n.index),l=!0),!d&&(y.ngOnChanges||y.ngDoCheck)&&((e.preOrderCheckHooks??=[]).push(n.index),d=!0),f++}$T(e,n,i)}function $T(e,t,n){for(let r=t.directiveStart;r<t.directiveEnd;r++){let o=e.data[r];if(n===null||!n.has(o))_g(0,t,o,r),_g(1,t,o,r),wg(t,r,!1);else{let i=n.get(o);Ig(0,t,i,r),Ig(1,t,i,r),wg(t,r,!0)}}}function _g(e,t,n,r){let o=e===0?n.inputs:n.outputs;for(let i in o)if(o.hasOwnProperty(i)){let s;e===0?s=t.inputs??={}:s=t.outputs??={},s[i]??=[],s[i].push(r),Py(t,i)}}function Ig(e,t,n,r){let o=e===0?n.inputs:n.outputs;for(let i in o)if(o.hasOwnProperty(i)){let s=o[i],a;e===0?a=t.hostDirectiveInputs??={}:a=t.hostDirectiveOutputs??={},a[s]??=[],a[s].push(r,i),Py(t,s)}}function Py(e,t){t==="class"?e.flags|=8:t==="style"&&(e.flags|=16)}function wg(e,t,n){let{attrs:r,inputs:o,hostDirectiveInputs:i}=e;if(r===null||!n&&o===null||n&&i===null||Pd(e)){e.initialInputs??=[],e.initialInputs.push(null);return}let s=null,a=0;for(;a<r.length;){let u=r[a];if(u===0){a+=4;continue}else if(u===5){a+=2;continue}else if(typeof u=="number")break;if(!n&&o.hasOwnProperty(u)){let l=o[u];for(let d of l)if(d===t){s??=[],s.push(u,r[a+1]);break}}else if(n&&i.hasOwnProperty(u)){let l=i[u];for(let d=0;d<l.length;d+=2)if(l[d]===t){s??=[],s.push(l[d+1],r[a+1]);break}}a+=2}e.initialInputs??=[],e.initialInputs.push(s)}function UT(e,t,n,r,o){e.data[r]=o;let i=o.factory||(o.factory=Gn(o.type,!0)),s=new Ti(i,rr(o),ky,null);e.blueprint[r]=s,n[r]=s,HT(e,t,r,ay(e,n,o.hostVars,Ni),o)}function HT(e,t,n,r,o){let i=o.hostBindings;if(i){let s=e.hostBindingOpCodes;s===null&&(s=e.hostBindingOpCodes=[]);let a=~t.index;VT(s)!=a&&s.push(a),s.push(n,r,i)}}function VT(e){let t=e.length;for(;t>0;){let n=e[--t];if(typeof n=="number"&&n<0)return n}return 0}function BT(e,t,n){if(n){if(t.exportAs)for(let r=0;r<t.exportAs.length;r++)n[t.exportAs[r]]=e;rr(t)&&(n[""]=e)}}function zT(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}function Ly(e,t,n,r,o,i,s,a){let u=t[F],l=u.consts,d=wn(l,s),f=Jd(u,e,n,r,d);return i&&PT(u,t,f,wn(l,a),o),f.mergedAttrs=ec(f.mergedAttrs,f.attrs),f.attrs!==null&&Wa(f,f.attrs,!1),f.mergedAttrs!==null&&Wa(f,f.mergedAttrs,!0),u.queries!==null&&u.queries.elementStart(u,f),f}function jy(e,t){JE(e,t),Pl(t)&&e.queries.elementEnd(t)}function qT(e,t,n,r,o,i){let s=t.consts,a=wn(s,o),u=Jd(t,e,n,r,a);if(u.mergedAttrs=ec(u.mergedAttrs,u.attrs),i!=null){let l=wn(s,i);u.localNames=[];for(let d=0;d<l.length;d+=2)u.localNames.push(l[d],-1)}return u.attrs!==null&&Wa(u,u.attrs,!1),u.mergedAttrs!==null&&Wa(u,u.mergedAttrs,!0),t.queries!==null&&t.queries.elementStart(t,u),u}function GT(e,t,n){if(n===Ni)return!1;let r=e[t];return Object.is(r,n)?!1:(e[t]=n,!0)}function WT(e,t,n){return function r(o){let i=nr(e)?Rt(e.index,t):t;Wd(i,5);let s=t[Se],a=bg(t,s,n,o),u=r.__ngNextListenerFn__;for(;u;)a=bg(t,s,u,o)&&a,u=u.__ngNextListenerFn__;return a}}function bg(e,t,n,r){let o=z(null);try{return oe(X.OutputStart,t,n),n(r)!==!1}catch(i){return uT(e,i),!1}finally{oe(X.OutputEnd,t,n),z(o)}}function ZT(e,t,n,r,o,i,s,a){let u=Da(e),l=!1,d=null;if(!r&&u&&(d=QT(t,n,i,e.index)),d!==null){let f=d.__ngLastListenerFn__||d;f.__ngNextListenerFn__=s,d.__ngLastListenerFn__=s,l=!0}else{let f=en(e,n),m=r?r(f):f;IS(n,m,i,a);let h=o.listen(m,i,a);if(!JT(i)){let y=r?v=>r(pt(v[e.index])):e.index;YT(y,t,n,i,a,h,!1)}}return l}function JT(e){return e.startsWith("animation")||e.startsWith("transition")}function QT(e,t,n,r){let o=e.cleanup;if(o!=null)for(let i=0;i<o.length-1;i+=2){let s=o[i];if(s===n&&o[i+1]===r){let a=t[Qr],u=o[i+2];return a&&a.length>u?a[u]:null}typeof s=="string"&&(i+=2)}return null}function YT(e,t,n,r,o,i,s){let a=t.firstCreatePass?Ul(t):null,u=$l(n),l=u.length;u.push(o,i),a&&a.push(r,e,l,(l+1)*(s?-1:1))}var bd=Symbol("BINDING");var Za=class extends Oi{ngModule;constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){let n=yn(t);return new io(n,this.ngModule)}};function KT(e){return Object.keys(e).map(t=>{let[n,r,o]=e[t],i={propName:n,templateName:t,isSignal:(r&ic.SignalBased)!==0};return o&&(i.transform=o),i})}function XT(e){return Object.keys(e).map(t=>({propName:e[t],templateName:t}))}function ex(e,t,n){let r=t instanceof Ee?t:t?.injector;return r&&e.getStandaloneInjector!==null&&(r=e.getStandaloneInjector(r)||r),r?new wd(n,r):n}function tx(e){let t=e.get(ar,null);if(t===null)throw new P(407,!1);let n=e.get(Oy,null),r=e.get(Jr,null);return{rendererFactory:t,sanitizer:n,changeDetectionScheduler:r,ngReflect:!1}}function nx(e,t){let n=Fy(e);return ty(t,n,n==="svg"?Nm:n==="math"?Rm:null)}function Fy(e){return(e.selectors[0][0]||"div").toLowerCase()}var io=class extends ac{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=KT(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=XT(this.componentDef.outputs),this.cachedOutputs}constructor(t,n){super(),this.componentDef=t,this.ngModule=n,this.componentType=t.type,this.selector=kS(t.selectors),this.ngContentSelectors=t.ngContentSelectors??[],this.isBoundToModule=!!n}create(t,n,r,o,i,s){oe(X.DynamicComponentStart);let a=z(null);try{let u=this.componentDef,l=rx(r,u,s,i),d=ex(u,o||this.ngModule,t),f=tx(d),m=f.rendererFactory.createRenderer(null,u),h=r?tT(m,r,u.encapsulation,d):nx(u,m),y=s?.some(Eg)||i?.some(I=>typeof I!="function"&&I.bindings.some(Eg)),v=jd(null,l,null,512|sy(u),null,null,f,m,d,null,Kg(h,d,!0));v[Oe]=h,ka(v);let _=null;try{let I=Ly(Oe,v,2,"#host",()=>l.directiveRegistry,!0,0);ry(m,h,I),ro(h,v),my(l,v,I),ey(l,I,v),jy(l,I),n!==void 0&&ix(I,this.ngContentSelectors,n),_=Rt(I.index,v),v[Se]=_[Se],Gd(l,v,null)}catch(I){throw _!==null&&hd(_),hd(v),I}finally{oe(X.DynamicComponentEnd),Pa()}return new Ja(this.componentType,v,!!y)}finally{z(a)}}};function rx(e,t,n,r){let o=e?["ng-version","21.0.3"]:PS(t.selectors[0]),i=null,s=null,a=0;if(n)for(let d of n)a+=d[bd].requiredVars,d.create&&(d.targetIdx=0,(i??=[]).push(d)),d.update&&(d.targetIdx=0,(s??=[]).push(d));if(r)for(let d=0;d<r.length;d++){let f=r[d];if(typeof f!="function")for(let m of f.bindings){a+=m[bd].requiredVars;let h=d+1;m.create&&(m.targetIdx=h,(i??=[]).push(m)),m.update&&(m.targetIdx=h,(s??=[]).push(m))}}let u=[t];if(r)for(let d of r){let f=typeof d=="function"?d:d.type,m=Al(f);u.push(m)}return Ld(0,null,ox(i,s),1,a,u,null,null,null,[o],null)}function ox(e,t){return!e&&!t?null:n=>{if(n&1&&e)for(let r of e)r.create();if(n&2&&t)for(let r of t)r.update()}}function Eg(e){let t=e[bd].kind;return t==="input"||t==="twoWay"}var Ja=class extends Ry{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(t,n,r){super(),this._rootLView=n,this._hasInputBindings=r,this._tNode=Ma(n[F],Oe),this.location=ao(this._tNode,n),this.instance=Rt(this._tNode.index,n)[Se],this.hostView=this.changeDetectorRef=new Tn(n,void 0),this.componentType=t}setInput(t,n){this._hasInputBindings;let r=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(t)&&Object.is(this.previousInputValues.get(t),n))return;let o=this._rootLView,i=vy(r,o[F],o,t,n);this.previousInputValues.set(t,n);let s=Rt(r.index,o);Wd(s,1)}get injector(){return new sr(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}};function ix(e,t,n){let r=e.projection=[];for(let o=0;o<t.length;o++){let i=n[o];r.push(i!=null&&i.length?Array.from(i):null)}}var uo=(()=>{class e{static __NG_ELEMENT_ID__=sx}return e})();function sx(){let e=ht();return Uy(e,ce())}var ax=uo,$y=class extends ax{_lContainer;_hostTNode;_hostLView;constructor(t,n,r){super(),this._lContainer=t,this._hostTNode=n,this._hostLView=r}get element(){return ao(this._hostTNode,this._hostLView)}get injector(){return new sr(this._hostTNode,this._hostLView)}get parentInjector(){let t=Nd(this._hostTNode,this._hostLView);if(Pg(t)){let n=Va(t,this._hostLView),r=Ha(t),o=n[F].data[r+8];return new sr(o,n)}else return new sr(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){let n=Sg(this._lContainer);return n!==null&&n[t]||null}get length(){return this._lContainer.length-Ce}createEmbeddedView(t,n,r){let o,i;typeof r=="number"?o=r:r!=null&&(o=r.index,i=r.injector);let s=vg(this._lContainer,t.ssrId),a=t.createEmbeddedViewImpl(n||{},i,s);return this.insertImpl(a,o,vd(this._hostTNode,s)),a}createComponent(t,n,r,o,i,s,a){let u=t&&!zE(t),l;if(u)l=n;else{let _=n||{};l=_.index,r=_.injector,o=_.projectableNodes,i=_.environmentInjector||_.ngModuleRef,s=_.directives,a=_.bindings}let d=u?t:new io(yn(t)),f=r||this.parentInjector;if(!i&&d.ngModule==null){let I=(u?f:this.parentInjector).get(Ee,null);I&&(i=I)}let m=yn(d.componentType??{}),h=vg(this._lContainer,m?.id??null),y=h?.firstChild??null,v=d.create(f,o,y,i,s,a);return this.insertImpl(v.hostView,l,vd(this._hostTNode,h)),v}insert(t,n){return this.insertImpl(t,n,!0)}insertImpl(t,n,r){let o=t._lView;if(km(o)){let a=this.indexOf(t);if(a!==-1)this.detach(a);else{let u=o[ye],l=new $y(u,u[et],u[ye]);l.detach(l.indexOf(t))}}let i=this._adjustIndex(n),s=this._lContainer;return Ay(s,o,i,r),t.attachToViewContainerRef(),xl(dd(s),i,t),t}move(t,n){return this.insert(t,n)}indexOf(t){let n=Sg(this._lContainer);return n!==null?n.indexOf(t):-1}remove(t){let n=this._adjustIndex(t,-1),r=Ga(this._lContainer,n);r&&(di(dd(this._lContainer),n),Bd(r[F],r))}detach(t){let n=this._adjustIndex(t,-1),r=Ga(this._lContainer,n);return r&&di(dd(this._lContainer),n)!=null?new Tn(r):null}_adjustIndex(t,n=0){return t??this.length+n}};function Sg(e){return e[vi]}function dd(e){return e[vi]||(e[vi]=[])}function Uy(e,t){let n,r=t[e.index];return ft(r)?n=r:(n=My(r,t,null,e),t[e.index]=n,Fd(t,n)),ux(n,t,e,r),new $y(n,e,t)}function cx(e,t){let n=e[He],r=n.createComment(""),o=en(t,e),i=n.parentNode(o);return qa(n,i,r,n.nextSibling(o),!1),r}var ux=fx,lx=()=>!1;function dx(e,t,n){return lx(e,t,n)}function fx(e,t,n,r){if(e[In])return;let o;n.type&8?o=pt(r):o=cx(t,n),e[In]=o}var Ed=class e{queryList;matches=null;constructor(t){this.queryList=t}clone(){return new e(this.queryList)}setDirty(){this.queryList.setDirty()}},Sd=class e{queries;constructor(t=[]){this.queries=t}createEmbeddedView(t){let n=t.queries;if(n!==null){let r=t.contentQueries!==null?t.contentQueries[0]:n.length,o=[];for(let i=0;i<r;i++){let s=n.getByIndex(i),a=this.queries[s.indexInDeclarationView];o.push(a.clone())}return new e(o)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}finishViewCreation(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let n=0;n<this.queries.length;n++)Qd(t,n).matches!==null&&this.queries[n].setDirty()}},Td=class{flags;read;predicate;constructor(t,n,r=null){this.flags=n,this.read=r,typeof t=="string"?this.predicate=Ix(t):this.predicate=t}},xd=class e{queries;constructor(t=[]){this.queries=t}elementStart(t,n){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(t,n)}elementEnd(t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementEnd(t)}embeddedTView(t){let n=null;for(let r=0;r<this.length;r++){let o=n!==null?n.length:0,i=this.getByIndex(r).embeddedTView(t,o);i&&(i.indexInDeclarationView=r,n!==null?n.push(i):n=[i])}return n!==null?new e(n):null}template(t,n){for(let r=0;r<this.queries.length;r++)this.queries[r].template(t,n)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}},Cd=class e{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(t,n=-1){this.metadata=t,this._declarationNodeIndex=n}elementStart(t,n){this.isApplyingToNode(n)&&this.matchTNode(t,n)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,n){this.elementStart(t,n)}embeddedTView(t,n){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,n),new e(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let n=this._declarationNodeIndex,r=t.parent;for(;r!==null&&r.type&8&&r.index!==n;)r=r.parent;return n===(r!==null?r.index:-1)}return this._appliesToNextNode}matchTNode(t,n){let r=this.metadata.predicate;if(Array.isArray(r))for(let o=0;o<r.length;o++){let i=r[o];this.matchTNodeWithReadOption(t,n,px(n,i)),this.matchTNodeWithReadOption(t,n,Fa(n,t,i,!1,!1))}else r===Ci?n.type&4&&this.matchTNodeWithReadOption(t,n,-1):this.matchTNodeWithReadOption(t,n,Fa(n,t,r,!1,!1))}matchTNodeWithReadOption(t,n,r){if(r!==null){let o=this.metadata.read;if(o!==null)if(o===Mi||o===uo||o===Ci&&n.type&4)this.addMatch(n.index,-2);else{let i=Fa(n,t,o,!1,!1);i!==null&&this.addMatch(n.index,i)}else this.addMatch(n.index,r)}}addMatch(t,n){this.matches===null?this.matches=[t,n]:this.matches.push(t,n)}};function px(e,t){let n=e.localNames;if(n!==null){for(let r=0;r<n.length;r+=2)if(n[r]===t)return n[r+1]}return null}function hx(e,t){return e.type&11?ao(e,t):e.type&4?Zd(e,t):null}function mx(e,t,n,r){return n===-1?hx(t,e):n===-2?gx(e,t,r):Ba(e,e[F],n,t)}function gx(e,t,n){if(n===Mi)return ao(t,e);if(n===Ci)return Zd(t,e);if(n===uo)return Uy(t,e)}function Hy(e,t,n,r){let o=t[Nt].queries[r];if(o.matches===null){let i=e.data,s=n.matches,a=[];for(let u=0;s!==null&&u<s.length;u+=2){let l=s[u];if(l<0)a.push(null);else{let d=i[l];a.push(mx(t,d,s[u+1],n.metadata.read))}}o.matches=a}return o.matches}function Dd(e,t,n,r){let o=e.queries.getByIndex(n),i=o.matches;if(i!==null){let s=Hy(e,t,o,n);for(let a=0;a<i.length;a+=2){let u=i[a];if(u>0)r.push(s[a/2]);else{let l=i[a+1],d=t[-u];for(let f=Ce;f<d.length;f++){let m=d[f];m[_n]===m[ye]&&Dd(m[F],m,l,r)}if(d[tr]!==null){let f=d[tr];for(let m=0;m<f.length;m++){let h=f[m];Dd(h[F],h,l,r)}}}}}return r}function yx(e,t){return e[Nt].queries[t].queryList}function vx(e,t,n){let r=new za((n&4)===4);return jm(e,t,r,r.destroy),(t[Nt]??=new Sd).queries.push(new Ed(r))-1}function _x(e,t,n){let r=bn();return r.firstCreatePass&&(wx(r,new Td(e,t,n),-1),(t&2)===2&&(r.staticViewQueries=!0)),vx(r,ce(),t)}function Ix(e){return e.split(",").map(t=>t.trim())}function wx(e,t,n){e.queries===null&&(e.queries=new xd),e.queries.track(new Cd(t,n))}function Qd(e,t){return e.queries.getByIndex(t)}function bx(e,t){let n=e[F],r=Qd(n,t);return r.crossesNgTemplate?Dd(n,e,t,[]):Hy(n,e,r,t)}var so=class{},cc=class{};var Qa=class extends so{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new Za(this);constructor(t,n,r,o=!0){super(),this.ngModuleType=t,this._parent=n;let i=Ml(t);this._bootstrapComponents=oy(i.bootstrap),this._r3Injector=ed(t,n,[{provide:so,useValue:this},{provide:Oi,useValue:this.componentFactoryResolver},...r],mn(t),new Set(["environment"])),o&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}},Ya=class extends cc{moduleType;constructor(t){super(),this.moduleType=t}create(t){return new Qa(this.moduleType,t,[])}};var Di=class extends so{injector;componentFactoryResolver=new Za(this);instance=null;constructor(t){super();let n=new Zn([...t.providers,{provide:so,useValue:this},{provide:Oi,useValue:this.componentFactoryResolver}],t.parent||pi(),t.debugName,new Set(["environment"]));this.injector=n,t.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}};function ki(e,t,n=null){return new Di({providers:e,parent:t,debugName:n,runEnvironmentInitializers:!0}).injector}var Ex=(()=>{class e{_injector;cachedInjectors=new Map;constructor(n){this._injector=n}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){let r=Nl(!1,n.type),o=r.length>0?ki([r],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n,o)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(let n of this.cachedInjectors.values())n!==null&&n.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=j({token:e,providedIn:"environment",factory:()=>new e(G(Ee))})}return e})();function Pi(e){return Xa(()=>{let t=Vy(e),n=g(p({},t),{decls:e.decls,vars:e.vars,template:e.template,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,onPush:e.changeDetection===Rd.OnPush,directiveDefs:null,pipeDefs:null,dependencies:t.standalone&&e.dependencies||null,getStandaloneInjector:t.standalone?o=>o.get(Ex).getOrCreateStandaloneInjector(n):null,getExternalStyles:null,signals:e.signals??!1,data:e.data||{},encapsulation:e.encapsulation||gt.Emulated,styles:e.styles||Wn,_:null,schemas:e.schemas||null,tView:null,id:""});t.standalone&&co("NgStandalone"),By(n);let r=e.dependencies;return n.directiveDefs=Tg(r,Sx),n.pipeDefs=Tg(r,Em),n.id=Cx(n),n})}function Sx(e){return yn(e)||Al(e)}function Tx(e,t){if(e==null)return Qn;let n={};for(let r in e)if(e.hasOwnProperty(r)){let o=e[r],i,s,a,u;Array.isArray(o)?(a=o[0],i=o[1],s=o[2]??i,u=o[3]||null):(i=o,s=o,a=ic.None,u=null),n[i]=[r,a,u],t[i]=s}return n}function xx(e){if(e==null)return Qn;let t={};for(let n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}function Yd(e){return Xa(()=>{let t=Vy(e);return By(t),t})}function Vy(e){let t={};return{type:e.type,providersResolver:null,viewProvidersResolver:null,factory:null,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputConfig:e.inputs||Qn,exportAs:e.exportAs||null,standalone:e.standalone??!0,signals:e.signals===!0,selectors:e.selectors||Wn,viewQuery:e.viewQuery||null,features:e.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:Tx(e.inputs,t),outputs:xx(e.outputs),debugInfo:null}}function By(e){e.features?.forEach(t=>t(e))}function Tg(e,t){return e?()=>{let n=typeof e=="function"?e():e,r=[];for(let o of n){let i=t(o);i!==null&&r.push(i)}return r}:null}function Cx(e){let t=0,n=typeof e.consts=="function"?"":e.consts,r=[e.selectors,e.ngContentSelectors,e.hostVars,e.hostAttrs,n,e.vars,e.decls,e.encapsulation,e.standalone,e.signals,e.exportAs,JSON.stringify(e.inputs),JSON.stringify(e.outputs),Object.getOwnPropertyNames(e.type.prototype),!!e.contentQueries,!!e.viewQuery];for(let i of r.join("|"))t=Math.imul(31,t)+i.charCodeAt(0)<<0;return t+=2147483648,"c"+t}function Dx(e,t,n,r,o,i,s,a){if(n.firstCreatePass){e.mergedAttrs=ec(e.mergedAttrs,e.attrs);let d=e.tView=Ld(2,e,o,i,s,n.directiveRegistry,n.pipeRegistry,null,n.schemas,n.consts,null);n.queries!==null&&(n.queries.template(n,e),d.queries=n.queries.embeddedTView(e))}a&&(e.flags|=a),wi(e,!1);let u=Mx(n,t,e,r);Kl()&&fy(n,t,u,e),ro(u,t);let l=My(u,t,u,e);t[r+Oe]=l,Fd(t,l),dx(l,e,t)}function zy(e,t,n,r,o,i,s,a,u,l,d){let f=n+Oe,m;if(t.firstCreatePass){if(m=Jd(t,f,4,s||null,a||null),l!=null){let h=wn(t.consts,l);m.localNames=[];for(let y=0;y<h.length;y+=2)m.localNames.push(h[y],-1)}}else m=t.data[f];return Dx(m,e,t,n,r,o,i,u),l!=null&&qd(e,m,d),m}var Mx=Ax;function Ax(e,t,n,r){return Xl(!0),t[He].createComment("")}var Kd=(()=>{class e{log(n){console.log(n)}warn(n){console.warn(n)}static \u0275fac=function(r){return new(r||e)};static \u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})();var Xd=new L("");function Li(e){return!!e&&typeof e.then=="function"}function qy(e){return!!e&&typeof e.subscribe=="function"}var Gy=new L("");var ef=(()=>{class e{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((n,r)=>{this.resolve=n,this.reject=r});appInits=x(Gy,{optional:!0})??[];injector=x(At);constructor(){}runInitializers(){if(this.initialized)return;let n=[];for(let o of this.appInits){let i=Re(this.injector,o);if(Li(i))n.push(i);else if(qy(i)){let s=new Promise((a,u)=>{i.subscribe({complete:a,error:u})});n.push(s)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{r()}).catch(o=>{this.reject(o)}),n.length===0&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||e)};static \u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),uc=new L("");function Wy(){$u(()=>{let e="";throw new P(600,e)})}function Zy(e){return e.isBoundToModule}var Nx=10;var lo=(()=>{class e{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=x(Ot);afterRenderManager=x(uy);zonelessEnabled=x(bi);rootEffectScheduler=x(ad);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new we;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=x(Sn);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(se(n=>!n))}constructor(){x(Ri,{optional:!0})}whenStable(){let n;return new Promise(r=>{n=this.isStable.subscribe({next:o=>{o&&r()}})}).finally(()=>{n.unsubscribe()})}_injector=x(Ee);_rendererFactory=null;get injector(){return this._injector}bootstrap(n,r){return this.bootstrapImpl(n,r)}bootstrapImpl(n,r,o=At.NULL){return this._injector.get(Ge).run(()=>{oe(X.BootstrapComponentStart);let s=n instanceof ac;if(!this._injector.get(ef).done){let y="";throw new P(405,y)}let u;s?u=n:u=this._injector.get(Oi).resolveComponentFactory(n),this.componentTypes.push(u.componentType);let l=Zy(u)?void 0:this._injector.get(so),d=r||u.selector,f=u.create(o,[],d,l),m=f.location.nativeElement,h=f.injector.get(Xd,null);return h?.registerApplication(m),f.onDestroy(()=>{this.detachView(f.hostView),Si(this.components,f),h?.unregisterApplication(m)}),this._loadComponent(f),oe(X.BootstrapComponentEnd,f),f})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){oe(X.ChangeDetectionStart),this.tracingSnapshot!==null?this.tracingSnapshot.run(Hd.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw oe(X.ChangeDetectionEnd),new P(101,!1);let n=z(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,z(n),this.afterTick.next(),oe(X.ChangeDetectionEnd)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(ar,null,{optional:!0}));let n=0;for(;this.dirtyFlags!==0&&n++<Nx;){oe(X.ChangeDetectionSyncStart);try{this.synchronizeOnce()}finally{oe(X.ChangeDetectionSyncEnd)}}}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let n=!1;if(this.dirtyFlags&7){let r=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:o}of this.allViews){if(!r&&!_i(o))continue;let i=r&&!this.zonelessEnabled?0:1;Ty(o,i),n=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}n||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:n})=>_i(n))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(n){let r=n;this._views.push(r),r.attachToAppRef(this)}detachView(n){let r=n;Si(this._views,r),r.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView);try{this.tick()}catch(o){this.internalErrorHandler(o)}this.components.push(n),this._injector.get(uc,[]).forEach(o=>o(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>Si(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new P(406,!1);let n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||e)};static \u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Si(e,t){let n=e.indexOf(t);n>-1&&e.splice(n,1)}var _$=typeof document<"u"&&typeof document?.documentElement?.getAnimations=="function";function tf(e,t,n,r,o,i,s,a){co("NgControlFlow");let u=ce(),l=bn(),d=wn(l.consts,i);return zy(u,l,e,t,n,r,o,d,256,s,a),nf}function nf(e,t,n,r,o,i,s,a){co("NgControlFlow");let u=ce(),l=bn(),d=wn(l.consts,i);return zy(u,l,e,t,n,r,o,d,512,s,a),nf}function rf(e,t){co("NgControlFlow");let n=ce(),r=qm(),o=n[r]!==Ni?n[r]:-1,i=o!==-1?xg(n,Oe+o):void 0,s=0;if(GT(n,r,e)){let a=z(null);try{if(i!==void 0&&xT(i,s),e!==-1){let u=Oe+e,l=xg(n,u),d=Rx(n[F],u),f=kT(l,d,n),m=_y(n,d,t,{dehydratedView:f});Ay(l,m,s,vd(d,f))}}finally{z(a)}}else if(i!==void 0){let a=TT(i,s);a!==void 0&&(a[Se]=t)}}function xg(e,t){return e[t]}function Rx(e,t){return Ma(e,t)}function Cg(e,t,n,r,o){vy(t,e,n,o?"class":"style",r)}function of(e,t,n,r){let o=ce(),i=o[F],s=e+Oe,a=i.firstCreatePass?Ly(s,o,2,t,aT,Um(),n,r):i.data[s];if(gy(a,o,e,t,Jy),Da(a)){let u=o[F];my(u,o,a),ey(u,a,o)}return r!=null&&qd(o,a),of}function sf(){let e=bn(),t=ht(),n=yy(t);return e.firstCreatePass&&jy(e,n),Vl(n)&&Bl(),Hl(),n.classesWithoutHost!=null&&YE(n)&&Cg(e,n,ce(),n.classesWithoutHost,!0),n.stylesWithoutHost!=null&&KE(n)&&Cg(e,n,ce(),n.stylesWithoutHost,!1),sf}function lc(e,t,n,r){return of(e,t,n,r),sf(),lc}function xn(e,t,n,r){let o=ce(),i=o[F],s=e+Oe,a=i.firstCreatePass?qT(s,i,2,t,n,r):i.data[s];return gy(a,o,e,t,Jy),r!=null&&qd(o,a),xn}function nn(){let e=ht(),t=yy(e);return Vl(t)&&Bl(),Hl(),nn}function Lt(e,t,n,r){return xn(e,t,n,r),nn(),Lt}var Jy=(e,t,n,r,o)=>(Xl(!0),ty(t[He],r,Xm()));function ji(){return ce()}var Fi="en-US";var Ox=Fi;function Qy(e){typeof e=="string"&&(Ox=e.toLowerCase().replace(/_/g,"-"))}function fo(e,t,n){let r=ce(),o=bn(),i=ht();return(i.type&3||n)&&ZT(i,o,r,n,r[He],e,t,WT(i,r,t)),fo}function $i(e=1){return Km(e)}function ur(e,t,n){_x(e,t,n)}function lr(e){let t=ce(),n=bn(),r=Zl();Oa(r+1);let o=Qd(n,r);if(e.dirty&&Om(t)===((o.metadata.flags&2)===2)){if(o.matches===null)e.reset([]);else{let i=bx(t,r);e.reset(i,fS),e.notifyOnChanges()}return!0}return!1}function dr(){return yx(ce(),Zl())}var Ka=class{ngModuleFactory;componentFactories;constructor(t,n){this.ngModuleFactory=t,this.componentFactories=n}},af=(()=>{class e{compileModuleSync(n){return new Ya(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){let r=this.compileModuleSync(n),o=Ml(n),i=oy(o.declarations).reduce((s,a)=>{let u=yn(a);return u&&s.push(new io(u)),s},[]);return new Ka(r,i)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}static \u0275fac=function(r){return new(r||e)};static \u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var Yy=(()=>{class e{applicationErrorHandler=x(Ot);appRef=x(lo);taskService=x(Sn);ngZone=x(Ge);zonelessEnabled=x(bi);tracing=x(Ri,{optional:!0});zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new Ie;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(ai):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(x(sd,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()}))}notify(n){if(!this.zonelessEnabled&&n===5)return;switch(n){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2;break}case 12:{this.appRef.dirtyFlags|=16;break}case 13:{this.appRef.dirtyFlags|=2;break}case 11:break;case 9:case 8:case 7:case 10:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick())return;let r=this.useMicrotaskScheduler?nd:td;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(){return!(this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(ai+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let n=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){this.taskService.remove(n),this.applicationErrorHandler(r)}finally{this.cleanup()}this.useMicrotaskScheduler=!0,nd(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(n)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let n=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(n)}}static \u0275fac=function(r){return new(r||e)};static \u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Ky(){return[{provide:Jr,useExisting:Yy},{provide:Ge,useClass:ci},{provide:bi,useValue:!0}]}function kx(){return typeof $localize<"u"&&$localize.locale||Fi}var cf=new L("",{factory:()=>x(cf,{optional:!0,skipSelf:!0})||kx()});var tv=Symbol("InputSignalNode#UNSET"),zx=g(p({},Js),{transformFn:void 0,applyValueToInputSignal(e,t){Ko(e,t)}});function nv(e,t){let n=Object.create(zx);n.value=e,n.transformFn=t?.transform;function r(){if(Gs(n),n.value===tv){let o=null;throw new P(-950,o)}return n.value}return r[Ke]=n,r}function Xy(e,t){return nv(e,t)}function qx(e){return nv(tv,e)}var rv=(Xy.required=qx,Xy);var uf=new L(""),Gx=new L("");function Ui(e){return!e.moduleRef}function Wx(e){let t=Ui(e)?e.r3Injector:e.moduleRef.injector,n=t.get(Ge);return n.run(()=>{Ui(e)?e.r3Injector.resolveInjectorInitializers():e.moduleRef.resolveInjectorInitializers();let r=t.get(Ot),o;if(n.runOutsideAngular(()=>{o=n.onError.subscribe({next:r})}),Ui(e)){let i=()=>t.destroy(),s=e.platformInjector.get(uf);s.add(i),t.onDestroy(()=>{o.unsubscribe(),s.delete(i)})}else{let i=()=>e.moduleRef.destroy(),s=e.platformInjector.get(uf);s.add(i),e.moduleRef.onDestroy(()=>{Si(e.allPlatformModules,e.moduleRef),o.unsubscribe(),s.delete(i)})}return Jx(r,n,()=>{let i=t.get(Sn),s=i.add(),a=t.get(ef);return a.runInitializers(),a.donePromise.then(()=>{let u=t.get(cf,Fi);if(Qy(u||Fi),!t.get(Gx,!0))return Ui(e)?t.get(lo):(e.allPlatformModules.push(e.moduleRef),e.moduleRef);if(Ui(e)){let d=t.get(lo);return e.rootComponent!==void 0&&d.bootstrap(e.rootComponent),d}else return Zx?.(e.moduleRef,e.allPlatformModules),e.moduleRef}).finally(()=>void i.remove(s))})})}var Zx;function Jx(e,t,n){try{let r=n();return Li(r)?r.catch(o=>{throw t.runOutsideAngular(()=>e(o)),o}):r}catch(r){throw t.runOutsideAngular(()=>e(r)),r}}var dc=null;function Qx(e=[],t){return At.create({name:t,providers:[{provide:fi,useValue:"platform"},{provide:uf,useValue:new Set([()=>dc=null])},...e]})}function Yx(e=[]){if(dc)return dc;let t=Qx(e);return dc=t,Wy(),Kx(t),t}function Kx(e){let t=e.get(rc,null);Re(e,()=>{t?.forEach(n=>n())})}var ov=(()=>{class e{static __NG_ELEMENT_ID__=Xx}return e})();function Xx(e){return eC(ht(),ce(),(e&16)===16)}function eC(e,t,n){if(nr(e)&&!n){let r=Rt(e.index,t);return new Tn(r,r)}else if(e.type&175){let r=t[tt];return new Tn(r,t)}return null}function iv(e){let{rootComponent:t,appProviders:n,platformProviders:r,platformRef:o}=e;oe(X.BootstrapApplicationStart);try{let i=o?.injector??Yx(r),s=[Ky(),rg,...n||[]],a=new Di({providers:s,parent:i,debugName:"",runEnvironmentInitializers:!1});return Wx({r3Injector:a.injector,platformInjector:i,rootComponent:t})}catch(i){return Promise.reject(i)}finally{oe(X.BootstrapApplicationEnd)}}var sv=null;function rn(){return sv}function lf(e){sv??=e}var Hi=class{},fc=(()=>{class e{historyGo(n){throw new Error("")}static \u0275fac=function(r){return new(r||e)};static \u0275prov=j({token:e,factory:()=>x(av),providedIn:"platform"})}return e})();var av=(()=>{class e extends fc{_location;_history;_doc=x(de);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return rn().getBaseHref(this._doc)}onPopState(n){let r=rn().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",n,!1),()=>r.removeEventListener("popstate",n)}onHashChange(n){let r=rn().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",n,!1),()=>r.removeEventListener("hashchange",n)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(n){this._location.pathname=n}pushState(n,r,o){this._history.pushState(n,r,o)}replaceState(n,r,o){this._history.replaceState(n,r,o)}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||e)};static \u0275prov=j({token:e,factory:()=>new e,providedIn:"platform"})}return e})();function lv(e,t){return e?t?e.endsWith("/")?t.startsWith("/")?e+t.slice(1):e+t:t.startsWith("/")?e+t:`${e}/${t}`:e:t}function cv(e){let t=e.search(/#|\?|$/);return e[t-1]==="/"?e.slice(0,t-1)+e.slice(t):e}function Cn(e){return e&&e[0]!=="?"?`?${e}`:e}var pc=(()=>{class e{historyGo(n){throw new Error("")}static \u0275fac=function(r){return new(r||e)};static \u0275prov=j({token:e,factory:()=>x(nC),providedIn:"root"})}return e})(),tC=new L(""),nC=(()=>{class e extends pc{_platformLocation;_baseHref;_removeListenerFns=[];constructor(n,r){super(),this._platformLocation=n,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??x(de).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return lv(this._baseHref,n)}path(n=!1){let r=this._platformLocation.pathname+Cn(this._platformLocation.search),o=this._platformLocation.hash;return o&&n?`${r}${o}`:r}pushState(n,r,o,i){let s=this.prepareExternalUrl(o+Cn(i));this._platformLocation.pushState(n,r,s)}replaceState(n,r,o,i){let s=this.prepareExternalUrl(o+Cn(i));this._platformLocation.replaceState(n,r,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static \u0275fac=function(r){return new(r||e)(G(fc),G(tC,8))};static \u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),po=(()=>{class e{_subject=new we;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(n){this._locationStrategy=n;let r=this._locationStrategy.getBaseHref();this._basePath=iC(cv(uv(r))),this._locationStrategy.onPopState(o=>{this._subject.next({url:this.path(!0),pop:!0,state:o.state,type:o.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,r=""){return this.path()==this.normalize(n+Cn(r))}normalize(n){return e.stripTrailingSlash(oC(this._basePath,uv(n)))}prepareExternalUrl(n){return n&&n[0]!=="/"&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,r="",o=null){this._locationStrategy.pushState(o,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+Cn(r)),o)}replaceState(n,r="",o=null){this._locationStrategy.replaceState(o,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+Cn(r)),o)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",r){this._urlChangeListeners.forEach(o=>o(n,r))}subscribe(n,r,o){return this._subject.subscribe({next:n,error:r??void 0,complete:o??void 0})}static normalizeQueryParams=Cn;static joinWithSlash=lv;static stripTrailingSlash=cv;static \u0275fac=function(r){return new(r||e)(G(pc))};static \u0275prov=j({token:e,factory:()=>rC(),providedIn:"root"})}return e})();function rC(){return new po(G(pc))}function oC(e,t){if(!e||!t.startsWith(e))return t;let n=t.substring(e.length);return n===""||["/",";","?","#"].includes(n[0])?n:t}function uv(e){return e.replace(/\/index.html$/,"")}function iC(e){if(new RegExp("^(https?:)?//").test(e)){let[,n]=e.split(/\/\/[^\/]+/);return n}return e}function df(e,t){t=encodeURIComponent(t);for(let n of e.split(";")){let r=n.indexOf("="),[o,i]=r==-1?[n,""]:[n.slice(0,r),n.slice(r+1)];if(o.trim()===t)return decodeURIComponent(i)}return null}var Vi=class{};var dv="browser";var Bi=class{_doc;constructor(t){this._doc=t}manager},hc=(()=>{class e extends Bi{constructor(n){super(n)}supports(n){return!0}addEventListener(n,r,o,i){return n.addEventListener(r,o,i),()=>this.removeEventListener(n,r,o,i)}removeEventListener(n,r,o,i){return n.removeEventListener(r,o,i)}static \u0275fac=function(r){return new(r||e)(G(de))};static \u0275prov=j({token:e,factory:e.\u0275fac})}return e})(),yc=new L(""),mf=(()=>{class e{_zone;_plugins;_eventNameToPlugin=new Map;constructor(n,r){this._zone=r,n.forEach(s=>{s.manager=this});let o=n.filter(s=>!(s instanceof hc));this._plugins=o.slice().reverse();let i=n.find(s=>s instanceof hc);i&&this._plugins.push(i)}addEventListener(n,r,o,i){return this._findPluginFor(r).addEventListener(n,r,o,i)}getZone(){return this._zone}_findPluginFor(n){let r=this._eventNameToPlugin.get(n);if(r)return r;if(r=this._plugins.find(i=>i.supports(n)),!r)throw new P(5101,!1);return this._eventNameToPlugin.set(n,r),r}static \u0275fac=function(r){return new(r||e)(G(yc),G(Ge))};static \u0275prov=j({token:e,factory:e.\u0275fac})}return e})(),ff="ng-app-id";function fv(e){for(let t of e)t.remove()}function pv(e,t){let n=t.createElement("style");return n.textContent=e,n}function sC(e,t,n,r){let o=e.head?.querySelectorAll(`style[${ff}="${t}"],link[${ff}="${t}"]`);if(o)for(let i of o)i.removeAttribute(ff),i instanceof HTMLLinkElement?r.set(i.href.slice(i.href.lastIndexOf("/")+1),{usage:0,elements:[i]}):i.textContent&&n.set(i.textContent,{usage:0,elements:[i]})}function hf(e,t){let n=t.createElement("link");return n.setAttribute("rel","stylesheet"),n.setAttribute("href",e),n}var gf=(()=>{class e{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(n,r,o,i={}){this.doc=n,this.appId=r,this.nonce=o,sC(n,r,this.inline,this.external),this.hosts.add(n.head)}addStyles(n,r){for(let o of n)this.addUsage(o,this.inline,pv);r?.forEach(o=>this.addUsage(o,this.external,hf))}removeStyles(n,r){for(let o of n)this.removeUsage(o,this.inline);r?.forEach(o=>this.removeUsage(o,this.external))}addUsage(n,r,o){let i=r.get(n);i?i.usage++:r.set(n,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,o(n,this.doc)))})}removeUsage(n,r){let o=r.get(n);o&&(o.usage--,o.usage<=0&&(fv(o.elements),r.delete(n)))}ngOnDestroy(){for(let[,{elements:n}]of[...this.inline,...this.external])fv(n);this.hosts.clear()}addHost(n){this.hosts.add(n);for(let[r,{elements:o}]of this.inline)o.push(this.addElement(n,pv(r,this.doc)));for(let[r,{elements:o}]of this.external)o.push(this.addElement(n,hf(r,this.doc)))}removeHost(n){this.hosts.delete(n)}addElement(n,r){return this.nonce&&r.setAttribute("nonce",this.nonce),n.appendChild(r)}static \u0275fac=function(r){return new(r||e)(G(de),G(nc),G(oc,8),G(Ai))};static \u0275prov=j({token:e,factory:e.\u0275fac})}return e})(),pf={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},yf=/%COMP%/g;var mv="%COMP%",aC=`_nghost-${mv}`,cC=`_ngcontent-${mv}`,uC=!0,lC=new L("",{factory:()=>uC});function dC(e){return cC.replace(yf,e)}function fC(e){return aC.replace(yf,e)}function gv(e,t){return t.map(n=>n.replace(yf,e))}var vf=(()=>{class e{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(n,r,o,i,s,a,u=null,l=null){this.eventManager=n,this.sharedStylesHost=r,this.appId=o,this.removeStylesOnCompDestroy=i,this.doc=s,this.ngZone=a,this.nonce=u,this.tracingService=l,this.platformIsServer=!1,this.defaultRenderer=new zi(n,s,a,this.platformIsServer,this.tracingService)}createRenderer(n,r){if(!n||!r)return this.defaultRenderer;let o=this.getOrCreateRenderer(n,r);return o instanceof gc?o.applyToHost(n):o instanceof qi&&o.applyStyles(),o}getOrCreateRenderer(n,r){let o=this.rendererByCompId,i=o.get(r.id);if(!i){let s=this.doc,a=this.ngZone,u=this.eventManager,l=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,f=this.platformIsServer,m=this.tracingService;switch(r.encapsulation){case gt.Emulated:i=new gc(u,l,r,this.appId,d,s,a,f,m);break;case gt.ShadowDom:return new mc(u,n,r,s,a,this.nonce,f,m,l);case gt.ExperimentalIsolatedShadowDom:return new mc(u,n,r,s,a,this.nonce,f,m);default:i=new qi(u,l,r,d,s,a,f,m);break}o.set(r.id,i)}return i}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(n){this.rendererByCompId.delete(n)}static \u0275fac=function(r){return new(r||e)(G(mf),G(gf),G(nc),G(lC),G(de),G(Ge),G(oc),G(Ri,8))};static \u0275prov=j({token:e,factory:e.\u0275fac})}return e})(),zi=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(t,n,r,o,i){this.eventManager=t,this.doc=n,this.ngZone=r,this.platformIsServer=o,this.tracingService=i}destroy(){}destroyNode=null;createElement(t,n){return n?this.doc.createElementNS(pf[n]||n,t):this.doc.createElement(t)}createComment(t){return this.doc.createComment(t)}createText(t){return this.doc.createTextNode(t)}appendChild(t,n){(hv(t)?t.content:t).appendChild(n)}insertBefore(t,n,r){t&&(hv(t)?t.content:t).insertBefore(n,r)}removeChild(t,n){n.remove()}selectRootElement(t,n){let r=typeof t=="string"?this.doc.querySelector(t):t;if(!r)throw new P(-5104,!1);return n||(r.textContent=""),r}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,n,r,o){if(o){n=o+":"+n;let i=pf[o];i?t.setAttributeNS(i,n,r):t.setAttribute(n,r)}else t.setAttribute(n,r)}removeAttribute(t,n,r){if(r){let o=pf[r];o?t.removeAttributeNS(o,n):t.removeAttribute(`${r}:${n}`)}else t.removeAttribute(n)}addClass(t,n){t.classList.add(n)}removeClass(t,n){t.classList.remove(n)}setStyle(t,n,r,o){o&(cr.DashCase|cr.Important)?t.style.setProperty(n,r,o&cr.Important?"important":""):t.style[n]=r}removeStyle(t,n,r){r&cr.DashCase?t.style.removeProperty(n):t.style[n]=""}setProperty(t,n,r){t!=null&&(t[n]=r)}setValue(t,n){t.nodeValue=n}listen(t,n,r,o){if(typeof t=="string"&&(t=rn().getGlobalEventTarget(this.doc,t),!t))throw new P(5102,!1);let i=this.decoratePreventDefault(r);return this.tracingService?.wrapEventListener&&(i=this.tracingService.wrapEventListener(t,n,i)),this.eventManager.addEventListener(t,n,i,o)}decoratePreventDefault(t){return n=>{if(n==="__ngUnwrap__")return t;t(n)===!1&&n.preventDefault()}}};function hv(e){return e.tagName==="TEMPLATE"&&e.content!==void 0}var mc=class extends zi{hostEl;sharedStylesHost;shadowRoot;constructor(t,n,r,o,i,s,a,u,l){super(t,o,i,a,u),this.hostEl=n,this.sharedStylesHost=l,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost&&this.sharedStylesHost.addHost(this.shadowRoot);let d=r.styles;d=gv(r.id,d);for(let m of d){let h=document.createElement("style");s&&h.setAttribute("nonce",s),h.textContent=m,this.shadowRoot.appendChild(h)}let f=r.getExternalStyles?.();if(f)for(let m of f){let h=hf(m,o);s&&h.setAttribute("nonce",s),this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,n){return super.appendChild(this.nodeOrShadowRoot(t),n)}insertBefore(t,n,r){return super.insertBefore(this.nodeOrShadowRoot(t),n,r)}removeChild(t,n){return super.removeChild(null,n)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost&&this.sharedStylesHost.removeHost(this.shadowRoot)}},qi=class extends zi{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(t,n,r,o,i,s,a,u,l){super(t,i,s,a,u),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=o;let d=r.styles;this.styles=l?gv(l,d):d,this.styleUrls=r.getExternalStyles?.(l)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&oo.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},gc=class extends qi{contentAttr;hostAttr;constructor(t,n,r,o,i,s,a,u,l){let d=o+"-"+r.id;super(t,n,r,i,s,a,u,l,d),this.contentAttr=dC(d),this.hostAttr=fC(d)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,n){let r=super.createElement(t,n);return super.setAttribute(r,this.contentAttr,""),r}};var vc=class e extends Hi{supportsDOMEvents=!0;static makeCurrent(){lf(new e)}onAndCancel(t,n,r,o){return t.addEventListener(n,r,o),()=>{t.removeEventListener(n,r,o)}}dispatchEvent(t,n){t.dispatchEvent(n)}remove(t){t.remove()}createElement(t,n){return n=n||this.getDefaultDocument(),n.createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,n){return n==="window"?window:n==="document"?t:n==="body"?t.body:null}getBaseHref(t){let n=pC();return n==null?null:hC(n)}resetBaseElement(){Gi=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return df(document.cookie,t)}},Gi=null;function pC(){return Gi=Gi||document.head.querySelector("base"),Gi?Gi.getAttribute("href"):null}function hC(e){return new URL(e,document.baseURI).pathname}var mC=(()=>{class e{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||e)};static \u0275prov=j({token:e,factory:e.\u0275fac})}return e})(),yv=["alt","control","meta","shift"],gC={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},yC={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey},vv=(()=>{class e extends Bi{constructor(n){super(n)}supports(n){return e.parseEventName(n)!=null}addEventListener(n,r,o,i){let s=e.parseEventName(r),a=e.eventCallback(s.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>rn().onAndCancel(n,s.domEventName,a,i))}static parseEventName(n){let r=n.toLowerCase().split("."),o=r.shift();if(r.length===0||!(o==="keydown"||o==="keyup"))return null;let i=e._normalizeKey(r.pop()),s="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),s="code."),yv.forEach(l=>{let d=r.indexOf(l);d>-1&&(r.splice(d,1),s+=l+".")}),s+=i,r.length!=0||i.length===0)return null;let u={};return u.domEventName=o,u.fullKey=s,u}static matchEventFullKeyCode(n,r){let o=gC[n.key]||n.key,i="";return r.indexOf("code.")>-1&&(o=n.code,i="code."),o==null||!o?!1:(o=o.toLowerCase(),o===" "?o="space":o==="."&&(o="dot"),yv.forEach(s=>{if(s!==o){let a=yC[s];a(n)&&(i+=s+".")}}),i+=o,i===r)}static eventCallback(n,r,o){return i=>{e.matchEventFullKeyCode(i,n)&&o.runGuarded(()=>r(i))}}static _normalizeKey(n){return n==="esc"?"escape":n}static \u0275fac=function(r){return new(r||e)(G(de))};static \u0275prov=j({token:e,factory:e.\u0275fac})}return e})();function _f(e,t,n){let r=p({rootComponent:e,platformRef:n?.platformRef},vC(t));return iv(r)}function vC(e){return{appProviders:[...EC,...e?.providers??[]],platformProviders:bC}}function _C(){vc.makeCurrent()}function IC(){return new Yt}function wC(){return Od(document),document}var bC=[{provide:Ai,useValue:dv},{provide:rc,useValue:_C,multi:!0},{provide:de,useFactory:wC}];var EC=[{provide:fi,useValue:"root"},{provide:Yt,useFactory:IC},{provide:yc,useClass:hc,multi:!0},{provide:yc,useClass:vv,multi:!0},vf,gf,mf,{provide:ar,useExisting:vf},{provide:Vi,useClass:mC},[]];var _v=(()=>{class e{_doc;constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}static \u0275fac=function(r){return new(r||e)(G(de))};static \u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var $="primary",is=Symbol("RouteTitle"),Sf=class{params;constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){let n=this.params[t];return Array.isArray(n)?n[0]:n}return null}getAll(t){if(this.has(t)){let n=this.params[t];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function gr(e){return new Sf(e)}function Dv(e,t,n){let r=n.path.split("/");if(r.length>e.length||n.pathMatch==="full"&&(t.hasChildren()||r.length<e.length))return null;let o={};for(let i=0;i<r.length;i++){let s=r[i],a=e[i];if(s[0]===":")o[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:e.slice(0,r.length),posParams:o}}function Sc(e){return new Promise((t,n)=>{e.pipe(Jt()).subscribe({next:r=>t(r),error:r=>n(r)})})}function TC(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!jt(e[n],t[n]))return!1;return!0}function jt(e,t){let n=e?Tf(e):void 0,r=t?Tf(t):void 0;if(!n||!r||n.length!=r.length)return!1;let o;for(let i=0;i<n.length;i++)if(o=n[i],!Mv(e[o],t[o]))return!1;return!0}function Tf(e){return[...Object.keys(e),...Object.getOwnPropertySymbols(e)]}function Mv(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;let n=[...e].sort(),r=[...t].sort();return n.every((o,i)=>r[i]===o)}else return e===t}function Av(e){return e.length>0?e[e.length-1]:null}function vr(e){return pa(e)?e:Li(e)?ge(Promise.resolve(e)):Z(e)}function Nv(e){return pa(e)?Sc(e):Promise.resolve(e)}var xC={exact:Ov,subset:kv},Rv={exact:CC,subset:DC,ignored:()=>!0};function Iv(e,t,n){return xC[n.paths](e.root,t.root,n.matrixParams)&&Rv[n.queryParams](e.queryParams,t.queryParams)&&!(n.fragment==="exact"&&e.fragment!==t.fragment)}function CC(e,t){return jt(e,t)}function Ov(e,t,n){if(!hr(e.segments,t.segments)||!wc(e.segments,t.segments,n)||e.numberOfChildren!==t.numberOfChildren)return!1;for(let r in t.children)if(!e.children[r]||!Ov(e.children[r],t.children[r],n))return!1;return!0}function DC(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(n=>Mv(e[n],t[n]))}function kv(e,t,n){return Pv(e,t,t.segments,n)}function Pv(e,t,n,r){if(e.segments.length>n.length){let o=e.segments.slice(0,n.length);return!(!hr(o,n)||t.hasChildren()||!wc(o,n,r))}else if(e.segments.length===n.length){if(!hr(e.segments,n)||!wc(e.segments,n,r))return!1;for(let o in t.children)if(!e.children[o]||!kv(e.children[o],t.children[o],r))return!1;return!0}else{let o=n.slice(0,e.segments.length),i=n.slice(e.segments.length);return!hr(e.segments,o)||!wc(e.segments,o,r)||!e.children[$]?!1:Pv(e.children[$],t,i,r)}}function wc(e,t,n){return t.every((r,o)=>Rv[n](e[o].parameters,r.parameters))}var vt=class{root;queryParams;fragment;_queryParamMap;constructor(t=new ee([],{}),n={},r=null){this.root=t,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap??=gr(this.queryParams),this._queryParamMap}toString(){return NC.serialize(this)}},ee=class{segments;children;parent=null;constructor(t,n){this.segments=t,this.children=n,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return bc(this)}},Dn=class{path;parameters;_parameterMap;constructor(t,n){this.path=t,this.parameters=n}get parameterMap(){return this._parameterMap??=gr(this.parameters),this._parameterMap}toString(){return jv(this)}};function MC(e,t){return hr(e,t)&&e.every((n,r)=>jt(n.parameters,t[r].parameters))}function hr(e,t){return e.length!==t.length?!1:e.every((n,r)=>n.path===t[r].path)}function AC(e,t){let n=[];return Object.entries(e.children).forEach(([r,o])=>{r===$&&(n=n.concat(t(o,r)))}),Object.entries(e.children).forEach(([r,o])=>{r!==$&&(n=n.concat(t(o,r)))}),n}var ss=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275prov=j({token:e,factory:()=>new Mn,providedIn:"root"})}return e})(),Mn=class{parse(t){let n=new Cf(t);return new vt(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(t){let n=`/${Wi(t.root,!0)}`,r=kC(t.queryParams),o=typeof t.fragment=="string"?`#${RC(t.fragment)}`:"";return`${n}${r}${o}`}},NC=new Mn;function bc(e){return e.segments.map(t=>jv(t)).join("/")}function Wi(e,t){if(!e.hasChildren())return bc(e);if(t){let n=e.children[$]?Wi(e.children[$],!1):"",r=[];return Object.entries(e.children).forEach(([o,i])=>{o!==$&&r.push(`${o}:${Wi(i,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}else{let n=AC(e,(r,o)=>o===$?[Wi(e.children[$],!1)]:[`${o}:${Wi(r,!1)}`]);return Object.keys(e.children).length===1&&e.children[$]!=null?`${bc(e)}/${n[0]}`:`${bc(e)}/(${n.join("//")})`}}function Lv(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function _c(e){return Lv(e).replace(/%3B/gi,";")}function RC(e){return encodeURI(e)}function xf(e){return Lv(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Ec(e){return decodeURIComponent(e)}function wv(e){return Ec(e.replace(/\+/g,"%20"))}function jv(e){return`${xf(e.path)}${OC(e.parameters)}`}function OC(e){return Object.entries(e).map(([t,n])=>`;${xf(t)}=${xf(n)}`).join("")}function kC(e){let t=Object.entries(e).map(([n,r])=>Array.isArray(r)?r.map(o=>`${_c(n)}=${_c(o)}`).join("&"):`${_c(n)}=${_c(r)}`).filter(n=>n);return t.length?`?${t.join("&")}`:""}var PC=/^[^\/()?;#]+/;function If(e){let t=e.match(PC);return t?t[0]:""}var LC=/^[^\/()?;=#]+/;function jC(e){let t=e.match(LC);return t?t[0]:""}var FC=/^[^=?&#]+/;function $C(e){let t=e.match(FC);return t?t[0]:""}var UC=/^[^&#]+/;function HC(e){let t=e.match(UC);return t?t[0]:""}var Cf=class{url;remaining;constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new ee([],{}):new ee([],this.parseChildren())}parseQueryParams(){let t={};if(this.consumeOptional("?"))do this.parseQueryParam(t);while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(t.length>0||Object.keys(n).length>0)&&(r[$]=new ee(t,n)),r}parseSegment(){let t=If(this.remaining);if(t===""&&this.peekStartsWith(";"))throw new P(4009,!1);return this.capture(t),new Dn(Ec(t),this.parseMatrixParams())}parseMatrixParams(){let t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){let n=jC(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let o=If(this.remaining);o&&(r=o,this.capture(r))}t[Ec(n)]=Ec(r)}parseQueryParam(t){let n=$C(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let s=HC(this.remaining);s&&(r=s,this.capture(r))}let o=wv(n),i=wv(r);if(t.hasOwnProperty(o)){let s=t[o];Array.isArray(s)||(s=[s],t[o]=s),s.push(i)}else t[o]=i}parseParens(t){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=If(this.remaining),o=this.remaining[r.length];if(o!=="/"&&o!==")"&&o!==";")throw new P(4010,!1);let i;r.indexOf(":")>-1?(i=r.slice(0,r.indexOf(":")),this.capture(i),this.capture(":")):t&&(i=$);let s=this.parseChildren();n[i??$]=Object.keys(s).length===1&&s[$]?s[$]:new ee([],s),this.consumeOptional("//")}return n}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return this.peekStartsWith(t)?(this.remaining=this.remaining.substring(t.length),!0):!1}capture(t){if(!this.consumeOptional(t))throw new P(4011,!1)}};function Fv(e){return e.segments.length>0?new ee([],{[$]:e}):e}function $v(e){let t={};for(let[r,o]of Object.entries(e.children)){let i=$v(o);if(r===$&&i.segments.length===0&&i.hasChildren())for(let[s,a]of Object.entries(i.children))t[s]=a;else(i.segments.length>0||i.hasChildren())&&(t[r]=i)}let n=new ee(e.segments,t);return VC(n)}function VC(e){if(e.numberOfChildren===1&&e.children[$]){let t=e.children[$];return new ee(e.segments.concat(t.segments),t.children)}return e}function yo(e){return e instanceof vt}function Uv(e,t,n=null,r=null,o=new Mn){let i=Hv(e);return Vv(i,t,n,r,o)}function Hv(e){let t;function n(i){let s={};for(let u of i.children){let l=n(u);s[u.outlet]=l}let a=new ee(i.url,s);return i===e&&(t=a),a}let r=n(e.root),o=Fv(r);return t??o}function Vv(e,t,n,r,o){let i=e;for(;i.parent;)i=i.parent;if(t.length===0)return wf(i,i,i,n,r,o);let s=BC(t);if(s.toRoot())return wf(i,i,new ee([],{}),n,r,o);let a=zC(s,i,e),u=a.processChildren?Ji(a.segmentGroup,a.index,s.commands):zv(a.segmentGroup,a.index,s.commands);return wf(i,a.segmentGroup,u,n,r,o)}function Tc(e){return typeof e=="object"&&e!=null&&!e.outlets&&!e.segmentPath}function Ki(e){return typeof e=="object"&&e!=null&&e.outlets}function bv(e,t,n){e||="\u0275";let r=new vt;return r.queryParams={[e]:t},n.parse(n.serialize(r)).queryParams[e]}function wf(e,t,n,r,o,i){let s={};for(let[l,d]of Object.entries(r??{}))s[l]=Array.isArray(d)?d.map(f=>bv(l,f,i)):bv(l,d,i);let a;e===t?a=n:a=Bv(e,t,n);let u=Fv($v(a));return new vt(u,s,o)}function Bv(e,t,n){let r={};return Object.entries(e.children).forEach(([o,i])=>{i===t?r[o]=n:r[o]=Bv(i,t,n)}),new ee(e.segments,r)}var xc=class{isAbsolute;numberOfDoubleDots;commands;constructor(t,n,r){if(this.isAbsolute=t,this.numberOfDoubleDots=n,this.commands=r,t&&r.length>0&&Tc(r[0]))throw new P(4003,!1);let o=r.find(Ki);if(o&&o!==Av(r))throw new P(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function BC(e){if(typeof e[0]=="string"&&e.length===1&&e[0]==="/")return new xc(!0,0,e);let t=0,n=!1,r=e.reduce((o,i,s)=>{if(typeof i=="object"&&i!=null){if(i.outlets){let a={};return Object.entries(i.outlets).forEach(([u,l])=>{a[u]=typeof l=="string"?l.split("/"):l}),[...o,{outlets:a}]}if(i.segmentPath)return[...o,i.segmentPath]}return typeof i!="string"?[...o,i]:s===0?(i.split("/").forEach((a,u)=>{u==0&&a==="."||(u==0&&a===""?n=!0:a===".."?t++:a!=""&&o.push(a))}),o):[...o,i]},[]);return new xc(n,t,r)}var mo=class{segmentGroup;processChildren;index;constructor(t,n,r){this.segmentGroup=t,this.processChildren=n,this.index=r}};function zC(e,t,n){if(e.isAbsolute)return new mo(t,!0,0);if(!n)return new mo(t,!1,NaN);if(n.parent===null)return new mo(n,!0,0);let r=Tc(e.commands[0])?0:1,o=n.segments.length-1+r;return qC(n,o,e.numberOfDoubleDots)}function qC(e,t,n){let r=e,o=t,i=n;for(;i>o;){if(i-=o,r=r.parent,!r)throw new P(4005,!1);o=r.segments.length}return new mo(r,!1,o-i)}function GC(e){return Ki(e[0])?e[0].outlets:{[$]:e}}function zv(e,t,n){if(e??=new ee([],{}),e.segments.length===0&&e.hasChildren())return Ji(e,t,n);let r=WC(e,t,n),o=n.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){let i=new ee(e.segments.slice(0,r.pathIndex),{});return i.children[$]=new ee(e.segments.slice(r.pathIndex),e.children),Ji(i,0,o)}else return r.match&&o.length===0?new ee(e.segments,{}):r.match&&!e.hasChildren()?Df(e,t,n):r.match?Ji(e,0,o):Df(e,t,n)}function Ji(e,t,n){if(n.length===0)return new ee(e.segments,{});{let r=GC(n),o={};if(Object.keys(r).some(i=>i!==$)&&e.children[$]&&e.numberOfChildren===1&&e.children[$].segments.length===0){let i=Ji(e.children[$],t,n);return new ee(e.segments,i.children)}return Object.entries(r).forEach(([i,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(o[i]=zv(e.children[i],t,s))}),Object.entries(e.children).forEach(([i,s])=>{r[i]===void 0&&(o[i]=s)}),new ee(e.segments,o)}}function WC(e,t,n){let r=0,o=t,i={match:!1,pathIndex:0,commandIndex:0};for(;o<e.segments.length;){if(r>=n.length)return i;let s=e.segments[o],a=n[r];if(Ki(a))break;let u=`${a}`,l=r<n.length-1?n[r+1]:null;if(o>0&&u===void 0)break;if(u&&l&&typeof l=="object"&&l.outlets===void 0){if(!Sv(u,l,s))return i;r+=2}else{if(!Sv(u,{},s))return i;r++}o++}return{match:!0,pathIndex:o,commandIndex:r}}function Df(e,t,n){let r=e.segments.slice(0,t),o=0;for(;o<n.length;){let i=n[o];if(Ki(i)){let u=ZC(i.outlets);return new ee(r,u)}if(o===0&&Tc(n[0])){let u=e.segments[t];r.push(new Dn(u.path,Ev(n[0]))),o++;continue}let s=Ki(i)?i.outlets[$]:`${i}`,a=o<n.length-1?n[o+1]:null;s&&a&&Tc(a)?(r.push(new Dn(s,Ev(a))),o+=2):(r.push(new Dn(s,{})),o++)}return new ee(r,{})}function ZC(e){let t={};return Object.entries(e).forEach(([n,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(t[n]=Df(new ee([],{}),0,r))}),t}function Ev(e){let t={};return Object.entries(e).forEach(([n,r])=>t[n]=`${r}`),t}function Sv(e,t,n){return e==n.path&&jt(t,n.parameters)}var Qi="imperative",ve=(function(e){return e[e.NavigationStart=0]="NavigationStart",e[e.NavigationEnd=1]="NavigationEnd",e[e.NavigationCancel=2]="NavigationCancel",e[e.NavigationError=3]="NavigationError",e[e.RoutesRecognized=4]="RoutesRecognized",e[e.ResolveStart=5]="ResolveStart",e[e.ResolveEnd=6]="ResolveEnd",e[e.GuardsCheckStart=7]="GuardsCheckStart",e[e.GuardsCheckEnd=8]="GuardsCheckEnd",e[e.RouteConfigLoadStart=9]="RouteConfigLoadStart",e[e.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",e[e.ChildActivationStart=11]="ChildActivationStart",e[e.ChildActivationEnd=12]="ChildActivationEnd",e[e.ActivationStart=13]="ActivationStart",e[e.ActivationEnd=14]="ActivationEnd",e[e.Scroll=15]="Scroll",e[e.NavigationSkipped=16]="NavigationSkipped",e})(ve||{}),Je=class{id;url;constructor(t,n){this.id=t,this.url=n}},yr=class extends Je{type=ve.NavigationStart;navigationTrigger;restoredState;constructor(t,n,r="imperative",o=null){super(t,n),this.navigationTrigger=r,this.restoredState=o}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},on=class extends Je{urlAfterRedirects;type=ve.NavigationEnd;constructor(t,n,r){super(t,n),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},ke=(function(e){return e[e.Redirect=0]="Redirect",e[e.SupersededByNewNavigation=1]="SupersededByNewNavigation",e[e.NoDataFromResolver=2]="NoDataFromResolver",e[e.GuardRejected=3]="GuardRejected",e[e.Aborted=4]="Aborted",e})(ke||{}),Xi=(function(e){return e[e.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",e[e.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",e})(Xi||{}),Ft=class extends Je{reason;code;type=ve.NavigationCancel;constructor(t,n,r,o){super(t,n),this.reason=r,this.code=o}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},sn=class extends Je{reason;code;type=ve.NavigationSkipped;constructor(t,n,r,o){super(t,n),this.reason=r,this.code=o}},vo=class extends Je{error;target;type=ve.NavigationError;constructor(t,n,r,o){super(t,n),this.error=r,this.target=o}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},es=class extends Je{urlAfterRedirects;state;type=ve.RoutesRecognized;constructor(t,n,r,o){super(t,n),this.urlAfterRedirects=r,this.state=o}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Cc=class extends Je{urlAfterRedirects;state;type=ve.GuardsCheckStart;constructor(t,n,r,o){super(t,n),this.urlAfterRedirects=r,this.state=o}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Dc=class extends Je{urlAfterRedirects;state;shouldActivate;type=ve.GuardsCheckEnd;constructor(t,n,r,o,i){super(t,n),this.urlAfterRedirects=r,this.state=o,this.shouldActivate=i}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Mc=class extends Je{urlAfterRedirects;state;type=ve.ResolveStart;constructor(t,n,r,o){super(t,n),this.urlAfterRedirects=r,this.state=o}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ac=class extends Je{urlAfterRedirects;state;type=ve.ResolveEnd;constructor(t,n,r,o){super(t,n),this.urlAfterRedirects=r,this.state=o}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Nc=class{route;type=ve.RouteConfigLoadStart;constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Rc=class{route;type=ve.RouteConfigLoadEnd;constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Oc=class{snapshot;type=ve.ChildActivationStart;constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},kc=class{snapshot;type=ve.ChildActivationEnd;constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Pc=class{snapshot;type=ve.ActivationStart;constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Lc=class{snapshot;type=ve.ActivationEnd;constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var ts=class{},_o=class{url;navigationBehaviorOptions;constructor(t,n){this.url=t,this.navigationBehaviorOptions=n}};function JC(e){return!(e instanceof ts)&&!(e instanceof _o)}function QC(e,t){return e.providers&&!e._injector&&(e._injector=ki(e.providers,t,`Route: ${e.path}`)),e._injector??t}function yt(e){return e.outlet||$}function YC(e,t){let n=e.filter(r=>yt(r)===t);return n.push(...e.filter(r=>yt(r)!==t)),n}function bo(e){if(!e)return null;if(e.routeConfig?._injector)return e.routeConfig._injector;for(let t=e.parent;t;t=t.parent){let n=t.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var jc=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return bo(this.route?.snapshot)??this.rootInjector}constructor(t){this.rootInjector=t,this.children=new Eo(this.rootInjector)}},Eo=(()=>{class e{rootInjector;contexts=new Map;constructor(n){this.rootInjector=n}onChildOutletCreated(n,r){let o=this.getOrCreateContext(n);o.outlet=r,this.contexts.set(n,o)}onChildOutletDestroyed(n){let r=this.getContext(n);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let r=this.getContext(n);return r||(r=new jc(this.rootInjector),this.contexts.set(n,r)),r}getContext(n){return this.contexts.get(n)||null}static \u0275fac=function(r){return new(r||e)(G(Ee))};static \u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Fc=class{_root;constructor(t){this._root=t}get root(){return this._root.value}parent(t){let n=this.pathFromRoot(t);return n.length>1?n[n.length-2]:null}children(t){let n=Mf(t,this._root);return n?n.children.map(r=>r.value):[]}firstChild(t){let n=Mf(t,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(t){let n=Af(t,this._root);return n.length<2?[]:n[n.length-2].children.map(o=>o.value).filter(o=>o!==t)}pathFromRoot(t){return Af(t,this._root).map(n=>n.value)}};function Mf(e,t){if(e===t.value)return t;for(let n of t.children){let r=Mf(e,n);if(r)return r}return null}function Af(e,t){if(e===t.value)return[t];for(let n of t.children){let r=Af(e,n);if(r.length)return r.unshift(t),r}return[]}var Ze=class{value;children;constructor(t,n){this.value=t,this.children=n}toString(){return`TreeNode(${this.value})`}};function ho(e){let t={};return e&&e.children.forEach(n=>t[n.value.outlet]=n),t}var ns=class extends Fc{snapshot;constructor(t,n){super(t),this.snapshot=n,Lf(this,t)}toString(){return this.snapshot.toString()}};function qv(e){let t=KC(e),n=new be([new Dn("",{})]),r=new be({}),o=new be({}),i=new be({}),s=new be(""),a=new $t(n,r,i,s,o,$,e,t.root);return a.snapshot=t.root,new ns(new Ze(a,[]),t)}function KC(e){let t={},n={},r={},i=new mr([],t,r,"",n,$,e,null,{});return new rs("",new Ze(i,[]))}var $t=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(t,n,r,o,i,s,a,u){this.urlSubject=t,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=o,this.dataSubject=i,this.outlet=s,this.component=a,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(se(l=>l[is]))??Z(void 0),this.url=t,this.params=n,this.queryParams=r,this.fragment=o,this.data=i}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(se(t=>gr(t))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(se(t=>gr(t))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function $c(e,t,n="emptyOnly"){let r,{routeConfig:o}=e;return t!==null&&(n==="always"||o?.path===""||!t.component&&!t.routeConfig?.loadComponent)?r={params:p(p({},t.params),e.params),data:p(p({},t.data),e.data),resolve:p(p(p(p({},e.data),t.data),o?.data),e._resolvedData)}:r={params:p({},e.params),data:p({},e.data),resolve:p(p({},e.data),e._resolvedData??{})},o&&Wv(o)&&(r.resolve[is]=o.title),r}var mr=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[is]}constructor(t,n,r,o,i,s,a,u,l){this.url=t,this.params=n,this.queryParams=r,this.fragment=o,this.data=i,this.outlet=s,this.component=a,this.routeConfig=u,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=gr(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=gr(this.queryParams),this._queryParamMap}toString(){let t=this.url.map(r=>r.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${t}', path:'${n}')`}},rs=class extends Fc{url;constructor(t,n){super(n),this.url=t,Lf(this,n)}toString(){return Gv(this._root)}};function Lf(e,t){t.value._routerState=e,t.children.forEach(n=>Lf(e,n))}function Gv(e){let t=e.children.length>0?` { ${e.children.map(Gv).join(", ")} } `:"";return`${e.value}${t}`}function bf(e){if(e.snapshot){let t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,jt(t.queryParams,n.queryParams)||e.queryParamsSubject.next(n.queryParams),t.fragment!==n.fragment&&e.fragmentSubject.next(n.fragment),jt(t.params,n.params)||e.paramsSubject.next(n.params),TC(t.url,n.url)||e.urlSubject.next(n.url),jt(t.data,n.data)||e.dataSubject.next(n.data)}else e.snapshot=e._futureSnapshot,e.dataSubject.next(e._futureSnapshot.data)}function Nf(e,t){let n=jt(e.params,t.params)&&MC(e.url,t.url),r=!e.parent!=!t.parent;return n&&!r&&(!e.parent||Nf(e.parent,t.parent))}function Wv(e){return typeof e.title=="string"||e.title===null}var Zv=new L(""),jf=(()=>{class e{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=$;activateEvents=new Ne;deactivateEvents=new Ne;attachEvents=new Ne;detachEvents=new Ne;routerOutletData=rv();parentContexts=x(Eo);location=x(uo);changeDetector=x(ov);inputBinder=x(Bc,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(n){if(n.name){let{firstChange:r,previousValue:o}=n.name;if(r)return;this.isTrackedInParentContexts(o)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(o)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new P(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new P(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new P(4012,!1);this.location.detach();let n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,r){this.activated=n,this._activatedRoute=r,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){let n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,r){if(this.isActivated)throw new P(4013,!1);this._activatedRoute=n;let o=this.location,s=n.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,u=new Rf(n,a,o.injector,this.routerOutletData);this.activated=o.createComponent(s,{index:o.length,injector:u,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||e)};static \u0275dir=Yd({type:e,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Ad]})}return e})(),Rf=class{route;childContexts;parent;outletData;constructor(t,n,r,o){this.route=t,this.childContexts=n,this.parent=r,this.outletData=o}get(t,n){return t===$t?this.route:t===Eo?this.childContexts:t===Zv?this.outletData:this.parent.get(t,n)}},Bc=new L("");var Ff=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Pi({type:e,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(r,o){r&1&&lc(0,"router-outlet")},dependencies:[jf],encapsulation:2})}return e})();function $f(e){let t=e.children&&e.children.map($f),n=t?g(p({},e),{children:t}):p({},e);return!n.component&&!n.loadComponent&&(t||n.loadChildren)&&n.outlet&&n.outlet!==$&&(n.component=Ff),n}function XC(e,t,n){let r=os(e,t._root,n?n._root:void 0);return new ns(r,t)}function os(e,t,n){if(n&&e.shouldReuseRoute(t.value,n.value.snapshot)){let r=n.value;r._futureSnapshot=t.value;let o=eD(e,t,n);return new Ze(r,o)}else{if(e.shouldAttach(t.value)){let i=e.retrieve(t.value);if(i!==null){let s=i.route;return s.value._futureSnapshot=t.value,s.children=t.children.map(a=>os(e,a)),s}}let r=tD(t.value),o=t.children.map(i=>os(e,i));return new Ze(r,o)}}function eD(e,t,n){return t.children.map(r=>{for(let o of n.children)if(e.shouldReuseRoute(r.value,o.value.snapshot))return os(e,r,o);return os(e,r)})}function tD(e){return new $t(new be(e.url),new be(e.params),new be(e.queryParams),new be(e.fragment),new be(e.data),e.outlet,e.component,e)}var Io=class{redirectTo;navigationBehaviorOptions;constructor(t,n){this.redirectTo=t,this.navigationBehaviorOptions=n}},Jv="ngNavigationCancelingError";function Uc(e,t){let{redirectTo:n,navigationBehaviorOptions:r}=yo(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,o=Qv(!1,ke.Redirect);return o.url=n,o.navigationBehaviorOptions=r,o}function Qv(e,t){let n=new Error(`NavigationCancelingError: ${e||""}`);return n[Jv]=!0,n.cancellationCode=t,n}function nD(e){return Yv(e)&&yo(e.url)}function Yv(e){return!!e&&e[Jv]}var rD=(e,t,n,r)=>se(o=>(new Of(t,o.targetRouterState,o.currentRouterState,n,r).activate(e),o)),Of=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(t,n,r,o,i){this.routeReuseStrategy=t,this.futureState=n,this.currState=r,this.forwardEvent=o,this.inputBindingEnabled=i}activate(t){let n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,t),bf(this.futureState.root),this.activateChildRoutes(n,r,t)}deactivateChildRoutes(t,n,r){let o=ho(n);t.children.forEach(i=>{let s=i.value.outlet;this.deactivateRoutes(i,o[s],r),delete o[s]}),Object.values(o).forEach(i=>{this.deactivateRouteAndItsChildren(i,r)})}deactivateRoutes(t,n,r){let o=t.value,i=n?n.value:null;if(o===i)if(o.component){let s=r.getContext(o.outlet);s&&this.deactivateChildRoutes(t,n,s.children)}else this.deactivateChildRoutes(t,n,r);else i&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(t,n){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,n):this.deactivateRouteAndOutlet(t,n)}detachAndStoreRouteSubtree(t,n){let r=n.getContext(t.value.outlet),o=r&&t.value.component?r.children:n,i=ho(t);for(let s of Object.values(i))this.deactivateRouteAndItsChildren(s,o);if(r&&r.outlet){let s=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:s,route:t,contexts:a})}}deactivateRouteAndOutlet(t,n){let r=n.getContext(t.value.outlet),o=r&&t.value.component?r.children:n,i=ho(t);for(let s of Object.values(i))this.deactivateRouteAndItsChildren(s,o);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(t,n,r){let o=ho(n);t.children.forEach(i=>{this.activateRoutes(i,o[i.value.outlet],r),this.forwardEvent(new Lc(i.value.snapshot))}),t.children.length&&this.forwardEvent(new kc(t.value.snapshot))}activateRoutes(t,n,r){let o=t.value,i=n?n.value:null;if(bf(o),o===i)if(o.component){let s=r.getOrCreateContext(o.outlet);this.activateChildRoutes(t,n,s.children)}else this.activateChildRoutes(t,n,r);else if(o.component){let s=r.getOrCreateContext(o.outlet);if(this.routeReuseStrategy.shouldAttach(o.snapshot)){let a=this.routeReuseStrategy.retrieve(o.snapshot);this.routeReuseStrategy.store(o.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),bf(a.route.value),this.activateChildRoutes(t,null,s.children)}else s.attachRef=null,s.route=o,s.outlet&&s.outlet.activateWith(o,s.injector),this.activateChildRoutes(t,null,s.children)}else this.activateChildRoutes(t,null,r)}},Hc=class{path;route;constructor(t){this.path=t,this.route=this.path[this.path.length-1]}},go=class{component;route;constructor(t,n){this.component=t,this.route=n}};function oD(e,t,n){let r=e._root,o=t?t._root:null;return Zi(r,o,n,[r.value])}function iD(e){let t=e.routeConfig?e.routeConfig.canActivateChild:null;return!t||t.length===0?null:{node:e,guards:t}}function So(e,t){let n=Symbol(),r=t.get(e,n);return r===n?typeof e=="function"&&!vl(e)?e:t.get(e):r}function Zi(e,t,n,r,o={canDeactivateChecks:[],canActivateChecks:[]}){let i=ho(t);return e.children.forEach(s=>{sD(s,i[s.value.outlet],n,r.concat([s.value]),o),delete i[s.value.outlet]}),Object.entries(i).forEach(([s,a])=>Yi(a,n.getContext(s),o)),o}function sD(e,t,n,r,o={canDeactivateChecks:[],canActivateChecks:[]}){let i=e.value,s=t?t.value:null,a=n?n.getContext(e.value.outlet):null;if(s&&i.routeConfig===s.routeConfig){let u=aD(s,i,i.routeConfig.runGuardsAndResolvers);u?o.canActivateChecks.push(new Hc(r)):(i.data=s.data,i._resolvedData=s._resolvedData),i.component?Zi(e,t,a?a.children:null,r,o):Zi(e,t,n,r,o),u&&a&&a.outlet&&a.outlet.isActivated&&o.canDeactivateChecks.push(new go(a.outlet.component,s))}else s&&Yi(t,a,o),o.canActivateChecks.push(new Hc(r)),i.component?Zi(e,null,a?a.children:null,r,o):Zi(e,null,n,r,o);return o}function aD(e,t,n){if(typeof n=="function")return n(e,t);switch(n){case"pathParamsChange":return!hr(e.url,t.url);case"pathParamsOrQueryParamsChange":return!hr(e.url,t.url)||!jt(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Nf(e,t)||!jt(e.queryParams,t.queryParams);case"paramsChange":default:return!Nf(e,t)}}function Yi(e,t,n){let r=ho(e),o=e.value;Object.entries(r).forEach(([i,s])=>{o.component?t?Yi(s,t.children.getContext(i),n):Yi(s,null,n):Yi(s,t,n)}),o.component?t&&t.outlet&&t.outlet.isActivated?n.canDeactivateChecks.push(new go(t.outlet.component,o)):n.canDeactivateChecks.push(new go(null,o)):n.canDeactivateChecks.push(new go(null,o))}function as(e){return typeof e=="function"}function cD(e){return typeof e=="boolean"}function uD(e){return e&&as(e.canLoad)}function lD(e){return e&&as(e.canActivate)}function dD(e){return e&&as(e.canActivateChild)}function fD(e){return e&&as(e.canDeactivate)}function pD(e){return e&&as(e.canMatch)}function Kv(e){return e instanceof Bn||e?.name==="EmptyError"}var Ic=Symbol("INITIAL_VALUE");function wo(){return Dt(e=>Yu(e.map(t=>t.pipe(Zt(1),el(Ic)))).pipe(se(t=>{for(let n of t)if(n!==!0){if(n===Ic)return Ic;if(n===!1||hD(n))return n}return!0}),Ct(t=>t!==Ic),Zt(1)))}function hD(e){return yo(e)||e instanceof Io}function Xv(e){return e.aborted?Z(void 0).pipe(Zt(1)):new K(t=>{let n=()=>{t.next(),t.complete()};return e.addEventListener("abort",n),()=>e.removeEventListener("abort",n)})}function e_(e){return ri(Xv(e))}function mD(e,t){return Me(n=>{let{targetSnapshot:r,currentSnapshot:o,guards:{canActivateChecks:i,canDeactivateChecks:s}}=n;return s.length===0&&i.length===0?Z(g(p({},n),{guardsResult:!0})):gD(s,r,o,e).pipe(Me(a=>a&&cD(a)?yD(r,i,e,t):Z(a)),se(a=>g(p({},n),{guardsResult:a})))})}function gD(e,t,n,r){return ge(e).pipe(Me(o=>bD(o.component,o.route,n,t,r)),Jt(o=>o!==!0,!0))}function yD(e,t,n,r){return ge(t).pipe(ha(o=>Gr(_D(o.route.parent,r),vD(o.route,r),wD(e,o.path,n),ID(e,o.route,n))),Jt(o=>o!==!0,!0))}function vD(e,t){return e!==null&&t&&t(new Pc(e)),Z(!0)}function _D(e,t){return e!==null&&t&&t(new Oc(e)),Z(!0)}function ID(e,t,n){let r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||r.length===0)return Z(!0);let o=r.map(i=>ti(()=>{let s=bo(t)??n,a=So(i,s),u=lD(a)?a.canActivate(t,e):Re(s,()=>a(t,e));return vr(u).pipe(Jt())}));return Z(o).pipe(wo())}function wD(e,t,n){let r=t[t.length-1],i=t.slice(0,t.length-1).reverse().map(s=>iD(s)).filter(s=>s!==null).map(s=>ti(()=>{let a=s.guards.map(u=>{let l=bo(s.node)??n,d=So(u,l),f=dD(d)?d.canActivateChild(r,e):Re(l,()=>d(r,e));return vr(f).pipe(Jt())});return Z(a).pipe(wo())}));return Z(i).pipe(wo())}function bD(e,t,n,r,o){let i=t&&t.routeConfig?t.routeConfig.canDeactivate:null;if(!i||i.length===0)return Z(!0);let s=i.map(a=>{let u=bo(t)??o,l=So(a,u),d=fD(l)?l.canDeactivate(e,t,n,r):Re(u,()=>l(e,t,n,r));return vr(d).pipe(Jt())});return Z(s).pipe(wo())}function ED(e,t,n,r,o){let i=t.canLoad;if(i===void 0||i.length===0)return Z(!0);let s=i.map(a=>{let u=So(a,e),l=uD(u)?u.canLoad(t,n):Re(e,()=>u(t,n)),d=vr(l);return o?d.pipe(e_(o)):d});return Z(s).pipe(wo(),t_(r))}function t_(e){return Wu(Ae(t=>{if(typeof t!="boolean")throw Uc(e,t)}),se(t=>t===!0))}function SD(e,t,n,r,o){let i=t.canMatch;if(!i||i.length===0)return Z(!0);let s=i.map(a=>{let u=So(a,e),l=pD(u)?u.canMatch(t,n):Re(e,()=>u(t,n)),d=vr(l);return o?d.pipe(e_(o)):d});return Z(s).pipe(wo(),t_(r))}var pr=class n_ extends Error{segmentGroup;constructor(t){super(),this.segmentGroup=t||null,Object.setPrototypeOf(this,n_.prototype)}},kf=class r_ extends Error{urlTree;constructor(t){super(),this.urlTree=t,Object.setPrototypeOf(this,r_.prototype)}};function TD(e){throw new P(4e3,!1)}function xD(e){throw Qv(!1,ke.GuardRejected)}var CD=class{urlSerializer;urlTree;constructor(t,n){this.urlSerializer=t,this.urlTree=n}async lineralizeSegments(t,n){let r=[],o=n.root;for(;;){if(r=r.concat(o.segments),o.numberOfChildren===0)return r;if(o.numberOfChildren>1||!o.children[$])throw TD(`${t.redirectTo}`);o=o.children[$]}}async applyRedirectCommands(t,n,r,o,i){let s=await DD(n,o,i);if(s instanceof vt)throw new kf(s);let a=this.applyRedirectCreateUrlTree(s,this.urlSerializer.parse(s),t,r);if(s[0]==="/")throw new kf(a);return a}applyRedirectCreateUrlTree(t,n,r,o){let i=this.createSegmentGroup(t,n.root,r,o);return new vt(i,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(t,n){let r={};return Object.entries(t).forEach(([o,i])=>{if(typeof i=="string"&&i[0]===":"){let a=i.substring(1);r[o]=n[a]}else r[o]=i}),r}createSegmentGroup(t,n,r,o){let i=this.createSegments(t,n.segments,r,o),s={};return Object.entries(n.children).forEach(([a,u])=>{s[a]=this.createSegmentGroup(t,u,r,o)}),new ee(i,s)}createSegments(t,n,r,o){return n.map(i=>i.path[0]===":"?this.findPosParam(t,i,o):this.findOrReturn(i,r))}findPosParam(t,n,r){let o=r[n.path.substring(1)];if(!o)throw new P(4001,!1);return o}findOrReturn(t,n){let r=0;for(let o of n){if(o.path===t.path)return n.splice(r),o;r++}return t}};function DD(e,t,n){if(typeof e=="string")return Promise.resolve(e);let r=e,{queryParams:o,fragment:i,routeConfig:s,url:a,outlet:u,params:l,data:d,title:f}=t;return Sc(vr(Re(n,()=>r({params:l,data:d,queryParams:o,fragment:i,routeConfig:s,url:a,outlet:u,title:f}))))}var Pf={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function MD(e,t,n,r,o,i){let s=o_(e,t,n);return s.matched?(r=QC(t,r),SD(r,t,n,o,i).pipe(se(a=>a===!0?s:p({},Pf)))):Z(s)}function o_(e,t,n){if(t.path==="**")return AD(n);if(t.path==="")return t.pathMatch==="full"&&(e.hasChildren()||n.length>0)?p({},Pf):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let o=(t.matcher||Dv)(n,e,t);if(!o)return p({},Pf);let i={};Object.entries(o.posParams??{}).forEach(([a,u])=>{i[a]=u.path});let s=o.consumed.length>0?p(p({},i),o.consumed[o.consumed.length-1].parameters):i;return{matched:!0,consumedSegments:o.consumed,remainingSegments:n.slice(o.consumed.length),parameters:s,positionalParamSegments:o.posParams??{}}}function AD(e){return{matched:!0,parameters:e.length>0?Av(e).parameters:{},consumedSegments:e,remainingSegments:[],positionalParamSegments:{}}}function Tv(e,t,n,r){return n.length>0&&OD(e,n,r)?{segmentGroup:new ee(t,RD(r,new ee(n,e.children))),slicedSegments:[]}:n.length===0&&kD(e,n,r)?{segmentGroup:new ee(e.segments,ND(e,n,r,e.children)),slicedSegments:n}:{segmentGroup:new ee(e.segments,e.children),slicedSegments:n}}function ND(e,t,n,r){let o={};for(let i of n)if(zc(e,t,i)&&!r[yt(i)]){let s=new ee([],{});o[yt(i)]=s}return p(p({},r),o)}function RD(e,t){let n={};n[$]=t;for(let r of e)if(r.path===""&&yt(r)!==$){let o=new ee([],{});n[yt(r)]=o}return n}function OD(e,t,n){return n.some(r=>zc(e,t,r)&&yt(r)!==$)}function kD(e,t,n){return n.some(r=>zc(e,t,r))}function zc(e,t,n){return(e.hasChildren()||t.length>0)&&n.pathMatch==="full"?!1:n.path===""}function PD(e,t,n){return t.length===0&&!e.children[n]}var LD=class{};async function jD(e,t,n,r,o,i,s="emptyOnly",a){return new $D(e,t,n,r,o,s,i,a).recognize()}var FD=31,$D=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;abortSignal;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(t,n,r,o,i,s,a,u){this.injector=t,this.configLoader=n,this.rootComponentType=r,this.config=o,this.urlTree=i,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.abortSignal=u,this.applyRedirects=new CD(this.urlSerializer,this.urlTree)}noMatchError(t){return new P(4002,`'${t.segmentGroup}'`)}async recognize(){let t=Tv(this.urlTree.root,[],[],this.config).segmentGroup,{children:n,rootSnapshot:r}=await this.match(t),o=new Ze(r,n),i=new rs("",o),s=Uv(r,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,i.url=this.urlSerializer.serialize(s),{state:i,tree:s}}async match(t){let n=new mr([],Object.freeze({}),Object.freeze(p({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),$,this.rootComponentType,null,{});try{return{children:await this.processSegmentGroup(this.injector,this.config,t,$,n),rootSnapshot:n}}catch(r){if(r instanceof kf)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof pr?this.noMatchError(r):r}}async processSegmentGroup(t,n,r,o,i){if(r.segments.length===0&&r.hasChildren())return this.processChildren(t,n,r,i);let s=await this.processSegment(t,n,r,r.segments,o,!0,i);return s instanceof Ze?[s]:[]}async processChildren(t,n,r,o){let i=[];for(let u of Object.keys(r.children))u==="primary"?i.unshift(u):i.push(u);let s=[];for(let u of i){let l=r.children[u],d=YC(n,u),f=await this.processSegmentGroup(t,d,l,u,o);s.push(...f)}let a=i_(s);return UD(a),a}async processSegment(t,n,r,o,i,s,a){for(let u of n)try{return await this.processSegmentAgainstRoute(u._injector??t,n,u,r,o,i,s,a)}catch(l){if(l instanceof pr||Kv(l))continue;throw l}if(PD(r,o,i))return new LD;throw new pr(r)}async processSegmentAgainstRoute(t,n,r,o,i,s,a,u){if(yt(r)!==s&&(s===$||!zc(o,i,r)))throw new pr(o);if(r.redirectTo===void 0)return this.matchSegmentAgainstRoute(t,o,r,i,s,u);if(this.allowRedirects&&a)return this.expandSegmentAgainstRouteUsingRedirect(t,o,n,r,i,s,u);throw new pr(o)}async expandSegmentAgainstRouteUsingRedirect(t,n,r,o,i,s,a){let{matched:u,parameters:l,consumedSegments:d,positionalParamSegments:f,remainingSegments:m}=o_(n,o,i);if(!u)throw new pr(n);typeof o.redirectTo=="string"&&o.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>FD&&(this.allowRedirects=!1));let h=new mr(i,l,Object.freeze(p({},this.urlTree.queryParams)),this.urlTree.fragment,xv(o),yt(o),o.component??o._loadedComponent??null,o,Cv(o)),y=$c(h,a,this.paramsInheritanceStrategy);if(h.params=Object.freeze(y.params),h.data=Object.freeze(y.data),this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let v=await this.applyRedirects.applyRedirectCommands(d,o.redirectTo,f,h,t),_=await this.applyRedirects.lineralizeSegments(o,v);return this.processSegment(t,r,n,_.concat(m),s,!1,a)}async matchSegmentAgainstRoute(t,n,r,o,i,s){if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let a=await Sc(MD(n,r,o,t,this.urlSerializer,this.abortSignal));if(r.path==="**"&&(n.children={}),!a?.matched)throw new pr(n);t=r._injector??t;let{routes:u}=await this.getChildConfig(t,r,o),l=r._loadedInjector??t,{parameters:d,consumedSegments:f,remainingSegments:m}=a,h=new mr(f,d,Object.freeze(p({},this.urlTree.queryParams)),this.urlTree.fragment,xv(r),yt(r),r.component??r._loadedComponent??null,r,Cv(r)),y=$c(h,s,this.paramsInheritanceStrategy);h.params=Object.freeze(y.params),h.data=Object.freeze(y.data);let{segmentGroup:v,slicedSegments:_}=Tv(n,f,m,u);if(_.length===0&&v.hasChildren()){let N=await this.processChildren(l,u,v,h);return new Ze(h,N)}if(u.length===0&&_.length===0)return new Ze(h,[]);let I=yt(r)===i,w=await this.processSegment(l,u,v,_,I?$:i,!0,h);return new Ze(h,w instanceof Ze?[w]:[])}async getChildConfig(t,n,r){if(n.children)return{routes:n.children,injector:t};if(n.loadChildren){if(n._loadedRoutes!==void 0)return{routes:n._loadedRoutes,injector:n._loadedInjector};if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);if(await Sc(ED(t,n,r,this.urlSerializer,this.abortSignal))){let i=await this.configLoader.loadChildren(t,n);return n._loadedRoutes=i.routes,n._loadedInjector=i.injector,i}throw xD(n)}return{routes:[],injector:t}}};function UD(e){e.sort((t,n)=>t.value.outlet===$?-1:n.value.outlet===$?1:t.value.outlet.localeCompare(n.value.outlet))}function HD(e){let t=e.value.routeConfig;return t&&t.path===""}function i_(e){let t=[],n=new Set;for(let r of e){if(!HD(r)){t.push(r);continue}let o=t.find(i=>r.value.routeConfig===i.value.routeConfig);o!==void 0?(o.children.push(...r.children),n.add(o)):t.push(r)}for(let r of n){let o=i_(r.children);t.push(new Ze(r.value,o))}return t.filter(r=>!n.has(r))}function xv(e){return e.data||{}}function Cv(e){return e.resolve||{}}var VD=new L("",{factory:()=>jD});function BD(e,t,n,r,o,i,s){let a=e.get(VD);return Me(u=>Z(u).pipe(Dt(l=>a(e,t,n,r,l.extractedUrl,o,i,s)),se(({state:l,tree:d})=>g(p({},u),{targetSnapshot:l,urlAfterRedirects:d}))))}function zD(e,t){return Me(n=>{let{targetSnapshot:r,guards:{canActivateChecks:o}}=n;if(!o.length)return Z(n);let i=new Set(o.map(u=>u.route)),s=new Set;for(let u of i)if(!s.has(u))for(let l of s_(u))s.add(l);let a=0;return ge(s).pipe(ha(u=>i.has(u)?qD(u,r,e,t):(u.data=$c(u,u.parent,e).resolve,Z(void 0))),Ae(()=>a++),ma(1),Me(u=>a===s.size?Z(n):Fe))})}function s_(e){let t=e.children.map(n=>s_(n)).flat();return[e,...t]}function qD(e,t,n,r){let o=e.routeConfig,i=e._resolve;return o?.title!==void 0&&!Wv(o)&&(i[is]=o.title),ti(()=>(e.data=$c(e,e.parent,n).resolve,GD(i,e,t,r).pipe(se(s=>(e._resolvedData=s,e.data=p(p({},e.data),s),null)))))}function GD(e,t,n,r){let o=Tf(e);if(o.length===0)return Z({});let i={};return ge(o).pipe(Me(s=>WD(e[s],t,n,r).pipe(Jt(),Ae(a=>{if(a instanceof Io)throw Uc(new Mn,a);i[s]=a}))),ma(1),se(()=>i),ni(s=>Kv(s)?Fe:Qu(s)))}function WD(e,t,n,r){let o=bo(t)??r,i=So(e,o),s=i.resolve?i.resolve(t,n):Re(o,()=>i(t,n));return vr(s)}function Ef(e){return Dt(t=>{let n=e(t);return n?ge(n).pipe(se(()=>t)):Z(t)})}var Uf=(()=>{class e{buildTitle(n){let r,o=n.root;for(;o!==void 0;)r=this.getResolvedTitleForRoute(o)??r,o=o.children.find(i=>i.outlet===$);return r}getResolvedTitleForRoute(n){return n.data[is]}static \u0275fac=function(r){return new(r||e)};static \u0275prov=j({token:e,factory:()=>x(a_),providedIn:"root"})}return e})(),a_=(()=>{class e extends Uf{title;constructor(n){super(),this.title=n}updateTitle(n){let r=this.buildTitle(n);r!==void 0&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||e)(G(_v))};static \u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),cs=new L("",{factory:()=>({})}),us=new L(""),c_=(()=>{class e{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=x(af);async loadComponent(n,r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return Promise.resolve(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let o=(async()=>{try{let i=await Nv(Re(n,()=>r.loadComponent())),s=await d_(l_(i));return this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=s,s}finally{this.componentLoaders.delete(r)}})();return this.componentLoaders.set(r,o),o}loadChildren(n,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Promise.resolve({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let o=(async()=>{try{let i=await u_(r,this.compiler,n,this.onLoadEndListener);return r._loadedRoutes=i.routes,r._loadedInjector=i.injector,i}finally{this.childrenLoaders.delete(r)}})();return this.childrenLoaders.set(r,o),o}static \u0275fac=function(r){return new(r||e)};static \u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();async function u_(e,t,n,r){let o=await Nv(Re(n,()=>e.loadChildren())),i=await d_(l_(o)),s;i instanceof cc||Array.isArray(i)?s=i:s=await t.compileModuleAsync(i),r&&r(e);let a,u,l=!1;return Array.isArray(s)?(u=s,l=!0):(a=s.create(n).injector,u=a.get(us,[],{optional:!0,self:!0}).flat()),{routes:u.map($f),injector:a}}function ZD(e){return e&&typeof e=="object"&&"default"in e}function l_(e){return ZD(e)?e.default:e}async function d_(e){return e}var qc=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275prov=j({token:e,factory:()=>x(JD),providedIn:"root"})}return e})(),JD=(()=>{class e{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,r){return n}static \u0275fac=function(r){return new(r||e)};static \u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),f_=new L("");var QD=()=>{},p_=new L(""),h_=(()=>{class e{currentNavigation=kt(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=kt(null);events=new we;transitionAbortWithErrorSubject=new we;configLoader=x(c_);environmentInjector=x(Ee);destroyRef=x(ir);urlSerializer=x(ss);rootContexts=x(Eo);location=x(po);inputBindingEnabled=x(Bc,{optional:!0})!==null;titleStrategy=x(Uf);options=x(cs,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=x(qc);createViewTransition=x(f_,{optional:!0});navigationErrorHandler=x(p_,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>Z(void 0);rootComponentType=null;destroyed=!1;constructor(){let n=o=>this.events.next(new Nc(o)),r=o=>this.events.next(new Rc(o));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=n,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(n){let r=++this.navigationId;tn(()=>{this.transitions?.next(g(p({},n),{extractedUrl:this.urlHandlingStrategy.extract(n.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:r}))})}setupNavigations(n){return this.transitions=new be(null),this.transitions.pipe(Ct(r=>r!==null),Dt(r=>{let o=!1,i=new AbortController;return Z(r).pipe(Dt(s=>{if(this.navigationId>r.id)return this.cancelNavigationTransition(r,"",ke.SupersededByNewNavigation),Fe;this.currentTransition=r;let a=this.lastSuccessfulNavigation();this.currentNavigation.set({id:s.id,initialUrl:s.rawUrl,extractedUrl:s.extractedUrl,targetBrowserUrl:typeof s.extras.browserUrl=="string"?this.urlSerializer.parse(s.extras.browserUrl):s.extras.browserUrl,trigger:s.source,extras:s.extras,previousNavigation:a?g(p({},a),{previousNavigation:null}):null,abort:()=>i.abort()});let u=!n.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),l=s.extras.onSameUrlNavigation??n.onSameUrlNavigation;if(!u&&l!=="reload")return this.events.next(new sn(s.id,this.urlSerializer.serialize(s.rawUrl),"",Xi.IgnoredSameUrlNavigation)),s.resolve(!1),Fe;if(this.urlHandlingStrategy.shouldProcessUrl(s.rawUrl))return Z(s).pipe(Dt(d=>(this.events.next(new yr(d.id,this.urlSerializer.serialize(d.extractedUrl),d.source,d.restoredState)),d.id!==this.navigationId?Fe:Promise.resolve(d))),BD(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,this.paramsInheritanceStrategy,i.signal),Ae(d=>{r.targetSnapshot=d.targetSnapshot,r.urlAfterRedirects=d.urlAfterRedirects,this.currentNavigation.update(m=>(m.finalUrl=d.urlAfterRedirects,m));let f=new es(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(f)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(s.currentRawUrl)){let{id:d,extractedUrl:f,source:m,restoredState:h,extras:y}=s,v=new yr(d,this.urlSerializer.serialize(f),m,h);this.events.next(v);let _=qv(this.rootComponentType).snapshot;return this.currentTransition=r=g(p({},s),{targetSnapshot:_,urlAfterRedirects:f,extras:g(p({},y),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.update(I=>(I.finalUrl=f,I)),Z(r)}else return this.events.next(new sn(s.id,this.urlSerializer.serialize(s.extractedUrl),"",Xi.IgnoredByUrlHandlingStrategy)),s.resolve(!1),Fe}),Ae(s=>{let a=new Cc(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot);this.events.next(a)}),se(s=>(this.currentTransition=r=g(p({},s),{guards:oD(s.targetSnapshot,s.currentSnapshot,this.rootContexts)}),r)),mD(this.environmentInjector,s=>this.events.next(s)),Ae(s=>{if(r.guardsResult=s.guardsResult,s.guardsResult&&typeof s.guardsResult!="boolean")throw Uc(this.urlSerializer,s.guardsResult);let a=new Dc(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot,!!s.guardsResult);this.events.next(a)}),Ct(s=>s.guardsResult?!0:(this.cancelNavigationTransition(s,"",ke.GuardRejected),!1)),Ef(s=>{if(s.guards.canActivateChecks.length!==0)return Z(s).pipe(Ae(a=>{let u=new Mc(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(u)}),Dt(a=>{let u=!1;return Z(a).pipe(zD(this.paramsInheritanceStrategy,this.environmentInjector),Ae({next:()=>u=!0,complete:()=>{u||this.cancelNavigationTransition(a,"",ke.NoDataFromResolver)}}))}),Ae(a=>{let u=new Ac(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(u)}))}),Ef(s=>{let a=l=>{let d=[];if(l.routeConfig?._loadedComponent)l.component=l.routeConfig?._loadedComponent;else if(l.routeConfig?.loadComponent){let f=bo(l)??this.environmentInjector;d.push(this.configLoader.loadComponent(f,l.routeConfig).then(m=>{l.component=m}))}for(let f of l.children)d.push(...a(f));return d},u=a(s.targetSnapshot.root);return u.length===0?Z(s):ge(Promise.all(u).then(()=>s))}),Ef(()=>this.afterPreactivation()),Dt(()=>{let{currentSnapshot:s,targetSnapshot:a}=r,u=this.createViewTransition?.(this.environmentInjector,s.root,a.root);return u?ge(u).pipe(se(()=>r)):Z(r)}),se(s=>{let a=XC(n.routeReuseStrategy,s.targetSnapshot,s.currentRouterState);return this.currentTransition=r=g(p({},s),{targetRouterState:a}),this.currentNavigation.update(u=>(u.targetRouterState=a,u)),r}),Ae(()=>{this.events.next(new ts)}),rD(this.rootContexts,n.routeReuseStrategy,s=>this.events.next(s),this.inputBindingEnabled),Zt(1),ri(Xv(i.signal).pipe(Ct(()=>!o&&!r.targetRouterState),Ae(()=>{this.cancelNavigationTransition(r,i.signal.reason+"",ke.Aborted)}))),Ae({next:s=>{o=!0,this.currentNavigation.update(a=>(a.abort=QD,a)),this.lastSuccessfulNavigation.set(tn(this.currentNavigation)),this.events.next(new on(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects))),this.titleStrategy?.updateTitle(s.targetRouterState.snapshot),s.resolve(!0)},complete:()=>{o=!0}}),ri(this.transitionAbortWithErrorSubject.pipe(Ae(s=>{throw s}))),Xu(()=>{i.abort(),o||this.cancelNavigationTransition(r,"",ke.SupersededByNewNavigation),this.currentTransition?.id===r.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),ni(s=>{if(this.destroyed)return r.resolve(!1),Fe;if(o=!0,Yv(s))this.events.next(new Ft(r.id,this.urlSerializer.serialize(r.extractedUrl),s.message,s.cancellationCode)),nD(s)?this.events.next(new _o(s.url,s.navigationBehaviorOptions)):r.resolve(!1);else{let a=new vo(r.id,this.urlSerializer.serialize(r.extractedUrl),s,r.targetSnapshot??void 0);try{let u=Re(this.environmentInjector,()=>this.navigationErrorHandler?.(a));if(u instanceof Io){let{message:l,cancellationCode:d}=Uc(this.urlSerializer,u);this.events.next(new Ft(r.id,this.urlSerializer.serialize(r.extractedUrl),l,d)),this.events.next(new _o(u.redirectTo,u.navigationBehaviorOptions))}else throw this.events.next(a),s}catch(u){this.options.resolveNavigationPromiseOnError?r.resolve(!1):r.reject(u)}}return Fe}))}))}cancelNavigationTransition(n,r,o){let i=new Ft(n.id,this.urlSerializer.serialize(n.extractedUrl),r,o);this.events.next(i),n.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let n=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=tn(this.currentNavigation),o=r?.targetBrowserUrl??r?.extractedUrl;return n.toString()!==o?.toString()&&!r?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||e)};static \u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function YD(e){return e!==Qi}var m_=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275prov=j({token:e,factory:()=>x(KD),providedIn:"root"})}return e})(),Vc=class{shouldDetach(t){return!1}store(t,n){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,n){return t.routeConfig===n.routeConfig}},KD=(()=>{class e extends Vc{static \u0275fac=(()=>{let n;return function(o){return(n||(n=tc(e)))(o||e)}})();static \u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Hf=(()=>{class e{urlSerializer=x(ss);options=x(cs,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=x(po);urlHandlingStrategy=x(qc);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new vt;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:n,initialUrl:r,targetBrowserUrl:o}){let i=n!==void 0?this.urlHandlingStrategy.merge(n,r):r,s=o??i;return s instanceof vt?this.urlSerializer.serialize(s):s}commitTransition({targetRouterState:n,finalUrl:r,initialUrl:o}){r&&n?(this.currentUrlTree=r,this.rawUrlTree=this.urlHandlingStrategy.merge(r,o),this.routerState=n):this.rawUrlTree=o}routerState=qv(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:n}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n??this.rawUrlTree)}static \u0275fac=function(r){return new(r||e)};static \u0275prov=j({token:e,factory:()=>x(g_),providedIn:"root"})}return e})(),g_=(()=>{class e extends Hf{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(n){return this.location.subscribe(r=>{r.type==="popstate"&&setTimeout(()=>{n(r.url,r.state,"popstate")})})}handleRouterEvent(n,r){n instanceof yr?this.updateStateMemento():n instanceof sn?this.commitTransition(r):n instanceof es?this.urlUpdateStrategy==="eager"&&(r.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(r),r)):n instanceof ts?(this.commitTransition(r),this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(r),r)):n instanceof Ft&&n.code!==ke.SupersededByNewNavigation&&n.code!==ke.Redirect?this.restoreHistory(r):n instanceof vo?this.restoreHistory(r,!0):n instanceof on&&(this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId)}setBrowserUrl(n,{extras:r,id:o}){let{replaceUrl:i,state:s}=r;if(this.location.isCurrentPathEqualTo(n)||i){let a=this.browserPageId,u=p(p({},s),this.generateNgRouterState(o,a));this.location.replaceState(n,"",u)}else{let a=p(p({},s),this.generateNgRouterState(o,this.browserPageId+1));this.location.go(n,"",a)}}restoreHistory(n,r=!1){if(this.canceledNavigationResolution==="computed"){let o=this.browserPageId,i=this.currentPageId-o;i!==0?this.location.historyGo(i):this.getCurrentUrlTree()===n.finalUrl&&i===0&&(this.resetInternalState(n),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetInternalState(n),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,r){return this.canceledNavigationResolution==="computed"?{navigationId:n,\u0275routerPageId:r}:{navigationId:n}}static \u0275fac=(()=>{let n;return function(o){return(n||(n=tc(e)))(o||e)}})();static \u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Vf(e,t){e.events.pipe(Ct(n=>n instanceof on||n instanceof Ft||n instanceof vo||n instanceof sn),se(n=>n instanceof on||n instanceof sn?0:(n instanceof Ft?n.code===ke.Redirect||n.code===ke.SupersededByNewNavigation:!1)?2:1),Ct(n=>n!==2),Zt(1)).subscribe(()=>{t()})}var XD={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},eM={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Gc=(()=>{class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=x(Kd);stateManager=x(Hf);options=x(cs,{optional:!0})||{};pendingTasks=x(Sn);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=x(h_);urlSerializer=x(ss);location=x(po);urlHandlingStrategy=x(qc);injector=x(Ee);_events=new we;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=x(m_);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=x(us,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!x(Bc,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:n=>{this.console.warn(n)}}),this.subscribeToNavigationEvents()}eventsSubscription=new Ie;subscribeToNavigationEvents(){let n=this.navigationTransitions.events.subscribe(r=>{try{let o=this.navigationTransitions.currentTransition,i=tn(this.navigationTransitions.currentNavigation);if(o!==null&&i!==null){if(this.stateManager.handleRouterEvent(r,i),r instanceof Ft&&r.code!==ke.Redirect&&r.code!==ke.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof on)this.navigated=!0;else if(r instanceof _o){let s=r.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(r.url,o.currentRawUrl),u=p({browserUrl:o.extras.browserUrl,info:o.extras.info,skipLocationChange:o.extras.skipLocationChange,replaceUrl:o.extras.replaceUrl||this.urlUpdateStrategy==="eager"||YD(o.source)},s);this.scheduleNavigation(a,Qi,null,u,{resolve:o.resolve,reject:o.reject,promise:o.promise})}}JC(r)&&this._events.next(r)}catch(o){this.navigationTransitions.transitionAbortWithErrorSubject.next(o)}});this.eventsSubscription.add(n)}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Qi,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((n,r,o)=>{this.navigateToSyncWithBrowser(n,o,r)})}navigateToSyncWithBrowser(n,r,o){let i={replaceUrl:!0},s=o?.navigationId?o:null;if(o){let u=p({},o);delete u.navigationId,delete u.\u0275routerPageId,Object.keys(u).length!==0&&(i.state=u)}let a=this.parseUrl(n);this.scheduleNavigation(a,r,s,i).catch(u=>{this.disposed||this.injector.get(Ot)(u)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return tn(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map($f),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(n,r={}){let{relativeTo:o,queryParams:i,fragment:s,queryParamsHandling:a,preserveFragment:u}=r,l=u?this.currentUrlTree.fragment:s,d=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":d=p(p({},this.currentUrlTree.queryParams),i);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=i||null}d!==null&&(d=this.removeEmptyProps(d));let f;try{let m=o?o.snapshot:this.routerState.snapshot.root;f=Hv(m)}catch{(typeof n[0]!="string"||n[0][0]!=="/")&&(n=[]),f=this.currentUrlTree.root}return Vv(f,n,d,l??null,this.urlSerializer)}navigateByUrl(n,r={skipLocationChange:!1}){let o=yo(n)?n:this.parseUrl(n),i=this.urlHandlingStrategy.merge(o,this.rawUrlTree);return this.scheduleNavigation(i,Qi,null,r)}navigate(n,r={skipLocationChange:!1}){return tM(n),this.navigateByUrl(this.createUrlTree(n,r),r)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){try{return this.urlSerializer.parse(n)}catch{return this.console.warn(ui(4018,!1)),this.urlSerializer.parse("/")}}isActive(n,r){let o;if(r===!0?o=p({},XD):r===!1?o=p({},eM):o=r,yo(n))return Iv(this.currentUrlTree,n,o);let i=this.parseUrl(n);return Iv(this.currentUrlTree,i,o)}removeEmptyProps(n){return Object.entries(n).reduce((r,[o,i])=>(i!=null&&(r[o]=i),r),{})}scheduleNavigation(n,r,o,i,s){if(this.disposed)return Promise.resolve(!1);let a,u,l;s?(a=s.resolve,u=s.reject,l=s.promise):l=new Promise((f,m)=>{a=f,u=m});let d=this.pendingTasks.add();return Vf(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:o,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:n,extras:i,resolve:a,reject:u,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(f=>Promise.reject(f))}static \u0275fac=function(r){return new(r||e)};static \u0275prov=j({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function tM(e){for(let t=0;t<e.length;t++)if(e[t]==null)throw new P(4008,!1)}var rM=new L("");function Bf(e,...t){return Kn([{provide:us,multi:!0,useValue:e},[],{provide:$t,useFactory:oM},{provide:uc,multi:!0,useFactory:iM},t.map(n=>n.\u0275providers)])}function oM(){return x(Gc).routerState.root}function iM(){let e=x(At);return t=>{let n=e.get(lo);if(t!==n.components[0])return;let r=e.get(Gc),o=e.get(sM);e.get(aM)===1&&r.initialNavigation(),e.get(cM,null,{optional:!0})?.setUpPreloading(),e.get(rM,null,{optional:!0})?.init(),r.resetRootComponentType(n.componentTypes[0]),o.closed||(o.next(),o.complete(),o.unsubscribe())}}var sM=new L("",{factory:()=>new we}),aM=new L("",{factory:()=>1});var cM=new L("");var y_=[];var v_={providers:[id(),Bf(y_)]};var lM={name:"@openai/agents-realtime",version:"0.3.4",versions:{"@openai/agents-realtime":"0.3.4","@openai/agents-core":"workspace:*"}},Wc=lM;async function To(e){try{return[null,await e()]}catch(t){return[t,null]}}var dM=Object.freeze({status:"aborted"});var fM=Symbol("zod_brand");var __={};function zf(e){return e&&Object.assign(__,e),__}function I_(e){let t=Object.values(e).filter(r=>typeof r=="number");return Object.entries(e).filter(([r,o])=>t.indexOf(+r)===-1).map(([r,o])=>o)}function qf(e,t="|"){return e.map(n=>Gf(n)).join(t)}function pM(e){return{get value(){{let n=e();return Object.defineProperty(this,"value",{value:n}),n}throw new Error("cached value already set")}}}var MW=Error.captureStackTrace?Error.captureStackTrace:(...e)=>{};var AW=pM(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{let e=Function;return new e(""),!0}catch{return!1}});function Gf(e){return typeof e=="bigint"?e.toString()+"n":typeof e=="string"?`"${e}"`:`${e}`}var NW={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};var mM=e=>{let t=typeof e;switch(t){case"number":return Number.isNaN(e)?"NaN":"number";case"object":{if(Array.isArray(e))return"array";if(e===null)return"null";if(Object.getPrototypeOf(e)!==Object.prototype&&e.constructor)return e.constructor.name}}return t},gM=()=>{let e={string:{unit:"characters",verb:"to have"},file:{unit:"bytes",verb:"to have"},array:{unit:"items",verb:"to have"},set:{unit:"items",verb:"to have"}};function t(r){return e[r]??null}let n={regex:"input",email:"email address",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datetime",date:"ISO date",time:"ISO time",duration:"ISO duration",ipv4:"IPv4 address",ipv6:"IPv6 address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded string",base64url:"base64url-encoded string",json_string:"JSON string",e164:"E.164 number",jwt:"JWT",template_literal:"input"};return r=>{switch(r.code){case"invalid_type":return`Invalid input: expected ${r.expected}, received ${mM(r.input)}`;case"invalid_value":return r.values.length===1?`Invalid input: expected ${Gf(r.values[0])}`:`Invalid option: expected one of ${qf(r.values,"|")}`;case"too_big":{let o=r.inclusive?"<=":"<",i=t(r.origin);return i?`Too big: expected ${r.origin??"value"} to have ${o}${r.maximum.toString()} ${i.unit??"elements"}`:`Too big: expected ${r.origin??"value"} to be ${o}${r.maximum.toString()}`}case"too_small":{let o=r.inclusive?">=":">",i=t(r.origin);return i?`Too small: expected ${r.origin} to have ${o}${r.minimum.toString()} ${i.unit}`:`Too small: expected ${r.origin} to be ${o}${r.minimum.toString()}`}case"invalid_format":{let o=r;return o.format==="starts_with"?`Invalid string: must start with "${o.prefix}"`:o.format==="ends_with"?`Invalid string: must end with "${o.suffix}"`:o.format==="includes"?`Invalid string: must include "${o.includes}"`:o.format==="regex"?`Invalid string: must match pattern ${o.pattern}`:`Invalid ${n[o.format]??r.format}`}case"not_multiple_of":return`Invalid number: must be a multiple of ${r.divisor}`;case"unrecognized_keys":return`Unrecognized key${r.keys.length>1?"s":""}: ${qf(r.keys,", ")}`;case"invalid_key":return`Invalid key in ${r.origin}`;case"invalid_union":return"Invalid input";case"invalid_element":return`Invalid value in ${r.origin}`;default:return"Invalid input"}}};function w_(){return{localeError:gM()}}var yM=Symbol("ZodOutput"),vM=Symbol("ZodInput"),ls=class{constructor(){this._map=new Map,this._idmap=new Map}add(t,...n){let r=n[0];if(this._map.set(t,r),r&&typeof r=="object"&&"id"in r){if(this._idmap.has(r.id))throw new Error(`ID ${r.id} already exists in the registry`);this._idmap.set(r.id,t)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(t){let n=this._map.get(t);return n&&typeof n=="object"&&"id"in n&&this._idmap.delete(n.id),this._map.delete(t),this}get(t){let n=t._zod.parent;if(n){let r=p({},this.get(n)??{});return delete r.id,p(p({},r),this._map.get(t))}return this._map.get(t)}has(t){return this._map.has(t)}};function b_(){return new ls}var Wf=b_();var Zc=class{constructor(t){this.counter=0,this.metadataRegistry=t?.metadata??Wf,this.target=t?.target??"draft-2020-12",this.unrepresentable=t?.unrepresentable??"throw",this.override=t?.override??(()=>{}),this.io=t?.io??"output",this.seen=new Map}process(t,n={path:[],schemaPath:[]}){var r;let o=t._zod.def,i={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},s=this.seen.get(t);if(s)return s.count++,n.schemaPath.includes(t)&&(s.cycle=n.path),s.schema;let a={schema:{},count:1,cycle:void 0,path:n.path};this.seen.set(t,a);let u=t._zod.toJSONSchema?.();if(u)a.schema=u;else{let f=g(p({},n),{schemaPath:[...n.schemaPath,t],path:n.path}),m=t._zod.parent;if(m)a.ref=m,this.process(m,f),this.seen.get(m).isParent=!0;else{let h=a.schema;switch(o.type){case"string":{let y=h;y.type="string";let{minimum:v,maximum:_,format:I,patterns:w,contentEncoding:N}=t._zod.bag;if(typeof v=="number"&&(y.minLength=v),typeof _=="number"&&(y.maxLength=_),I&&(y.format=i[I]??I,y.format===""&&delete y.format),N&&(y.contentEncoding=N),w&&w.size>0){let S=[...w];S.length===1?y.pattern=S[0].source:S.length>1&&(a.schema.allOf=[...S.map(T=>g(p({},this.target==="draft-7"?{type:"string"}:{}),{pattern:T.source}))])}break}case"number":{let y=h,{minimum:v,maximum:_,format:I,multipleOf:w,exclusiveMaximum:N,exclusiveMinimum:S}=t._zod.bag;typeof I=="string"&&I.includes("int")?y.type="integer":y.type="number",typeof S=="number"&&(y.exclusiveMinimum=S),typeof v=="number"&&(y.minimum=v,typeof S=="number"&&(S>=v?delete y.minimum:delete y.exclusiveMinimum)),typeof N=="number"&&(y.exclusiveMaximum=N),typeof _=="number"&&(y.maximum=_,typeof N=="number"&&(N<=_?delete y.maximum:delete y.exclusiveMaximum)),typeof w=="number"&&(y.multipleOf=w);break}case"boolean":{let y=h;y.type="boolean";break}case"bigint":{if(this.unrepresentable==="throw")throw new Error("BigInt cannot be represented in JSON Schema");break}case"symbol":{if(this.unrepresentable==="throw")throw new Error("Symbols cannot be represented in JSON Schema");break}case"null":{h.type="null";break}case"any":break;case"unknown":break;case"undefined":{if(this.unrepresentable==="throw")throw new Error("Undefined cannot be represented in JSON Schema");break}case"void":{if(this.unrepresentable==="throw")throw new Error("Void cannot be represented in JSON Schema");break}case"never":{h.not={};break}case"date":{if(this.unrepresentable==="throw")throw new Error("Date cannot be represented in JSON Schema");break}case"array":{let y=h,{minimum:v,maximum:_}=t._zod.bag;typeof v=="number"&&(y.minItems=v),typeof _=="number"&&(y.maxItems=_),y.type="array",y.items=this.process(o.element,g(p({},f),{path:[...f.path,"items"]}));break}case"object":{let y=h;y.type="object",y.properties={};let v=o.shape;for(let w in v)y.properties[w]=this.process(v[w],g(p({},f),{path:[...f.path,"properties",w]}));let _=new Set(Object.keys(v)),I=new Set([..._].filter(w=>{let N=o.shape[w]._zod;return this.io==="input"?N.optin===void 0:N.optout===void 0}));I.size>0&&(y.required=Array.from(I)),o.catchall?._zod.def.type==="never"?y.additionalProperties=!1:o.catchall?o.catchall&&(y.additionalProperties=this.process(o.catchall,g(p({},f),{path:[...f.path,"additionalProperties"]}))):this.io==="output"&&(y.additionalProperties=!1);break}case"union":{let y=h;y.anyOf=o.options.map((v,_)=>this.process(v,g(p({},f),{path:[...f.path,"anyOf",_]})));break}case"intersection":{let y=h,v=this.process(o.left,g(p({},f),{path:[...f.path,"allOf",0]})),_=this.process(o.right,g(p({},f),{path:[...f.path,"allOf",1]})),I=N=>"allOf"in N&&Object.keys(N).length===1,w=[...I(v)?v.allOf:[v],...I(_)?_.allOf:[_]];y.allOf=w;break}case"tuple":{let y=h;y.type="array";let v=o.items.map((w,N)=>this.process(w,g(p({},f),{path:[...f.path,"prefixItems",N]})));if(this.target==="draft-2020-12"?y.prefixItems=v:y.items=v,o.rest){let w=this.process(o.rest,g(p({},f),{path:[...f.path,"items"]}));this.target==="draft-2020-12"?y.items=w:y.additionalItems=w}o.rest&&(y.items=this.process(o.rest,g(p({},f),{path:[...f.path,"items"]})));let{minimum:_,maximum:I}=t._zod.bag;typeof _=="number"&&(y.minItems=_),typeof I=="number"&&(y.maxItems=I);break}case"record":{let y=h;y.type="object",y.propertyNames=this.process(o.keyType,g(p({},f),{path:[...f.path,"propertyNames"]})),y.additionalProperties=this.process(o.valueType,g(p({},f),{path:[...f.path,"additionalProperties"]}));break}case"map":{if(this.unrepresentable==="throw")throw new Error("Map cannot be represented in JSON Schema");break}case"set":{if(this.unrepresentable==="throw")throw new Error("Set cannot be represented in JSON Schema");break}case"enum":{let y=h,v=I_(o.entries);v.every(_=>typeof _=="number")&&(y.type="number"),v.every(_=>typeof _=="string")&&(y.type="string"),y.enum=v;break}case"literal":{let y=h,v=[];for(let _ of o.values)if(_===void 0){if(this.unrepresentable==="throw")throw new Error("Literal `undefined` cannot be represented in JSON Schema")}else if(typeof _=="bigint"){if(this.unrepresentable==="throw")throw new Error("BigInt literals cannot be represented in JSON Schema");v.push(Number(_))}else v.push(_);if(v.length!==0)if(v.length===1){let _=v[0];y.type=_===null?"null":typeof _,y.const=_}else v.every(_=>typeof _=="number")&&(y.type="number"),v.every(_=>typeof _=="string")&&(y.type="string"),v.every(_=>typeof _=="boolean")&&(y.type="string"),v.every(_=>_===null)&&(y.type="null"),y.enum=v;break}case"file":{let y=h,v={type:"string",format:"binary",contentEncoding:"binary"},{minimum:_,maximum:I,mime:w}=t._zod.bag;_!==void 0&&(v.minLength=_),I!==void 0&&(v.maxLength=I),w?w.length===1?(v.contentMediaType=w[0],Object.assign(y,v)):y.anyOf=w.map(N=>g(p({},v),{contentMediaType:N})):Object.assign(y,v);break}case"transform":{if(this.unrepresentable==="throw")throw new Error("Transforms cannot be represented in JSON Schema");break}case"nullable":{let y=this.process(o.innerType,f);h.anyOf=[y,{type:"null"}];break}case"nonoptional":{this.process(o.innerType,f),a.ref=o.innerType;break}case"success":{let y=h;y.type="boolean";break}case"default":{this.process(o.innerType,f),a.ref=o.innerType,h.default=JSON.parse(JSON.stringify(o.defaultValue));break}case"prefault":{this.process(o.innerType,f),a.ref=o.innerType,this.io==="input"&&(h._prefault=JSON.parse(JSON.stringify(o.defaultValue)));break}case"catch":{this.process(o.innerType,f),a.ref=o.innerType;let y;try{y=o.catchValue(void 0)}catch{throw new Error("Dynamic catch values are not supported in JSON Schema")}h.default=y;break}case"nan":{if(this.unrepresentable==="throw")throw new Error("NaN cannot be represented in JSON Schema");break}case"template_literal":{let y=h,v=t._zod.pattern;if(!v)throw new Error("Pattern not found in template literal");y.type="string",y.pattern=v.source;break}case"pipe":{let y=this.io==="input"?o.in._zod.def.type==="transform"?o.out:o.in:o.out;this.process(y,f),a.ref=y;break}case"readonly":{this.process(o.innerType,f),a.ref=o.innerType,h.readOnly=!0;break}case"promise":{this.process(o.innerType,f),a.ref=o.innerType;break}case"optional":{this.process(o.innerType,f),a.ref=o.innerType;break}case"lazy":{let y=t._zod.innerType;this.process(y,f),a.ref=y;break}case"custom":{if(this.unrepresentable==="throw")throw new Error("Custom types cannot be represented in JSON Schema");break}default:}}}let l=this.metadataRegistry.get(t);return l&&Object.assign(a.schema,l),this.io==="input"&&fe(t)&&(delete a.schema.examples,delete a.schema.default),this.io==="input"&&a.schema._prefault&&((r=a.schema).default??(r.default=a.schema._prefault)),delete a.schema._prefault,this.seen.get(t).schema}emit(t,n){let r={cycles:n?.cycles??"ref",reused:n?.reused??"inline",external:n?.external??void 0},o=this.seen.get(t);if(!o)throw new Error("Unprocessed schema. This is a bug in Zod.");let i=d=>{let f=this.target==="draft-2020-12"?"$defs":"definitions";if(r.external){let v=r.external.registry.get(d[0])?.id,_=r.external.uri??(w=>w);if(v)return{ref:_(v)};let I=d[1].defId??d[1].schema.id??`schema${this.counter++}`;return d[1].defId=I,{defId:I,ref:`${_("__shared")}#/${f}/${I}`}}if(d[1]===o)return{ref:"#"};let h=`#/${f}/`,y=d[1].schema.id??`__schema${this.counter++}`;return{defId:y,ref:h+y}},s=d=>{if(d[1].schema.$ref)return;let f=d[1],{ref:m,defId:h}=i(d);f.def=p({},f.schema),h&&(f.defId=h);let y=f.schema;for(let v in y)delete y[v];y.$ref=m};if(r.cycles==="throw")for(let d of this.seen.entries()){let f=d[1];if(f.cycle)throw new Error(`Cycle detected: #/${f.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(let d of this.seen.entries()){let f=d[1];if(t===d[0]){s(d);continue}if(r.external){let h=r.external.registry.get(d[0])?.id;if(t!==d[0]&&h){s(d);continue}}if(this.metadataRegistry.get(d[0])?.id){s(d);continue}if(f.cycle){s(d);continue}if(f.count>1&&r.reused==="ref"){s(d);continue}}let a=(d,f)=>{let m=this.seen.get(d),h=m.def??m.schema,y=p({},h);if(m.ref===null)return;let v=m.ref;if(m.ref=null,v){a(v,f);let _=this.seen.get(v).schema;_.$ref&&f.target==="draft-7"?(h.allOf=h.allOf??[],h.allOf.push(_)):(Object.assign(h,_),Object.assign(h,y))}m.isParent||this.override({zodSchema:d,jsonSchema:h,path:m.path??[]})};for(let d of[...this.seen.entries()].reverse())a(d[0],{target:this.target});let u={};if(this.target==="draft-2020-12"?u.$schema="https://json-schema.org/draft/2020-12/schema":this.target==="draft-7"?u.$schema="http://json-schema.org/draft-07/schema#":console.warn(`Invalid target: ${this.target}`),r.external?.uri){let d=r.external.registry.get(t)?.id;if(!d)throw new Error("Schema is missing an `id` property");u.$id=r.external.uri(d)}Object.assign(u,o.def);let l=r.external?.defs??{};for(let d of this.seen.entries()){let f=d[1];f.def&&f.defId&&(l[f.defId]=f.def)}r.external||Object.keys(l).length>0&&(this.target==="draft-2020-12"?u.$defs=l:u.definitions=l);try{return JSON.parse(JSON.stringify(u))}catch{throw new Error("Error converting schema to JSON.")}}};function Zf(e,t){if(e instanceof ls){let r=new Zc(t),o={};for(let a of e._idmap.entries()){let[u,l]=a;r.process(l)}let i={},s={registry:e,uri:t?.uri,defs:o};for(let a of e._idmap.entries()){let[u,l]=a;i[u]=r.emit(l,g(p({},t),{external:s}))}if(Object.keys(o).length>0){let a=r.target==="draft-2020-12"?"$defs":"definitions";i.__shared={[a]:o}}return{schemas:i}}let n=new Zc(t);return n.process(e),n.emit(e,t)}function fe(e,t){let n=t??{seen:new Set};if(n.seen.has(e))return!1;n.seen.add(e);let o=e._zod.def;switch(o.type){case"string":case"number":case"bigint":case"boolean":case"date":case"symbol":case"undefined":case"null":case"any":case"unknown":case"never":case"void":case"literal":case"enum":case"nan":case"file":case"template_literal":return!1;case"array":return fe(o.element,n);case"object":{for(let i in o.shape)if(fe(o.shape[i],n))return!0;return!1}case"union":{for(let i of o.options)if(fe(i,n))return!0;return!1}case"intersection":return fe(o.left,n)||fe(o.right,n);case"tuple":{for(let i of o.items)if(fe(i,n))return!0;return!!(o.rest&&fe(o.rest,n))}case"record":return fe(o.keyType,n)||fe(o.valueType,n);case"map":return fe(o.keyType,n)||fe(o.valueType,n);case"set":return fe(o.valueType,n);case"promise":case"optional":case"nonoptional":case"nullable":case"readonly":return fe(o.innerType,n);case"lazy":return fe(o.getter(),n);case"default":return fe(o.innerType,n);case"prefault":return fe(o.innerType,n);case"custom":return!1;case"transform":return!0;case"pipe":return fe(o.in,n)||fe(o.out,n);case"success":return!1;case"catch":return!1;default:}throw new Error(`Unknown schema type: ${o.type}`)}zf(w_());function E_(e,t){let n=p({},e);return Object.defineProperties(n,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:t,enumerable:!1}}),n}var T_=Symbol("Let zodToJsonSchema decide on which parser to use"),S_={name:void 0,$refStrategy:"root",effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",nullableStrategy:"from-target",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},x_=e=>typeof e=="string"?g(p({},S_),{basePath:["#"],definitions:{},name:e}):p(g(p({},S_),{basePath:["#"],definitions:{}}),e);var ds=e=>"_def"in e?e._def:e;function C_(e){if(!e)return!0;for(let t in e)return!1;return!0}var D_=e=>{let t=x_(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return g(p({},t),{currentPath:n,propertyPath:void 0,seenRefs:new Set,seen:new Map(Object.entries(t.definitions).map(([r,o])=>[ds(o),{def:ds(o),path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))})};function Jf(e,t,n,r){r?.errorMessages&&n&&(e.errorMessage=g(p({},e.errorMessage),{[t]:n}))}function J(e,t,n,r,o){e[t]=n,Jf(e,t,r,o)}var c={};Tb(c,{BRAND:()=>qM,DIRTY:()=>_r,EMPTY_PATH:()=>EM,INVALID:()=>O,NEVER:()=>MA,OK:()=>De,ParseStatus:()=>Te,Schema:()=>q,ZodAny:()=>Yc,ZodArray:()=>hs,ZodBigInt:()=>Xf,ZodBoolean:()=>ep,ZodBranded:()=>ms,ZodCatch:()=>lp,ZodDate:()=>tp,ZodDefault:()=>up,ZodDiscriminatedUnion:()=>Kc,ZodEffects:()=>No,ZodEnum:()=>nu,ZodError:()=>Ht,ZodFirstPartyTypeKind:()=>E,ZodFunction:()=>eu,ZodIntersection:()=>ip,ZodIssueCode:()=>b,ZodLazy:()=>sp,ZodLiteral:()=>ap,ZodMap:()=>F_,ZodNaN:()=>H_,ZodNativeEnum:()=>cp,ZodNever:()=>Ir,ZodNull:()=>rp,ZodNullable:()=>Ro,ZodNumber:()=>Kf,ZodObject:()=>Mo,ZodOptional:()=>Nn,ZodParsedType:()=>D,ZodPipeline:()=>gs,ZodPromise:()=>ru,ZodReadonly:()=>dp,ZodRecord:()=>Xc,ZodSchema:()=>q,ZodSet:()=>$_,ZodString:()=>tu,ZodSymbol:()=>L_,ZodTransformer:()=>No,ZodTuple:()=>Ao,ZodType:()=>q,ZodUndefined:()=>np,ZodUnion:()=>op,ZodUnknown:()=>ps,ZodVoid:()=>j_,addIssueToContext:()=>C,any:()=>eA,array:()=>oA,bigint:()=>JM,boolean:()=>q_,coerce:()=>DA,custom:()=>V_,date:()=>QM,datetimeRegex:()=>P_,defaultErrorMap:()=>an,discriminatedUnion:()=>cA,effect:()=>IA,enum:()=>yA,function:()=>hA,getErrorMap:()=>xo,getParsedType:()=>Ut,instanceof:()=>WM,intersection:()=>uA,isAborted:()=>Jc,isAsync:()=>Co,isDirty:()=>Qc,isValid:()=>An,late:()=>GM,lazy:()=>mA,literal:()=>gA,makeIssue:()=>fs,map:()=>fA,nan:()=>ZM,nativeEnum:()=>vA,never:()=>nA,null:()=>XM,nullable:()=>bA,number:()=>z_,object:()=>iA,objectUtil:()=>M_,oboolean:()=>CA,onumber:()=>xA,optional:()=>wA,ostring:()=>TA,pipeline:()=>SA,preprocess:()=>EA,promise:()=>_A,quotelessJson:()=>IM,record:()=>dA,set:()=>pA,setErrorMap:()=>bM,strictObject:()=>sA,string:()=>B_,symbol:()=>YM,transformer:()=>IA,tuple:()=>lA,undefined:()=>KM,union:()=>aA,unknown:()=>tA,util:()=>W,void:()=>rA});var W;(function(e){e.assertEqual=o=>{};function t(o){}e.assertIs=t;function n(o){throw new Error}e.assertNever=n,e.arrayToEnum=o=>{let i={};for(let s of o)i[s]=s;return i},e.getValidEnumValues=o=>{let i=e.objectKeys(o).filter(a=>typeof o[o[a]]!="number"),s={};for(let a of i)s[a]=o[a];return e.objectValues(s)},e.objectValues=o=>e.objectKeys(o).map(function(i){return o[i]}),e.objectKeys=typeof Object.keys=="function"?o=>Object.keys(o):o=>{let i=[];for(let s in o)Object.prototype.hasOwnProperty.call(o,s)&&i.push(s);return i},e.find=(o,i)=>{for(let s of o)if(i(s))return s},e.isInteger=typeof Number.isInteger=="function"?o=>Number.isInteger(o):o=>typeof o=="number"&&Number.isFinite(o)&&Math.floor(o)===o;function r(o,i=" | "){return o.map(s=>typeof s=="string"?`'${s}'`:s).join(i)}e.joinValues=r,e.jsonStringifyReplacer=(o,i)=>typeof i=="bigint"?i.toString():i})(W||(W={}));var M_=(function(e){return e.mergeShapes=(t,n)=>p(p({},t),n),e})(M_||{}),D=W.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ut=e=>{switch(typeof e){case"undefined":return D.undefined;case"string":return D.string;case"number":return Number.isNaN(e)?D.nan:D.number;case"boolean":return D.boolean;case"function":return D.function;case"bigint":return D.bigint;case"symbol":return D.symbol;case"object":return Array.isArray(e)?D.array:e===null?D.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?D.promise:typeof Map<"u"&&e instanceof Map?D.map:typeof Set<"u"&&e instanceof Set?D.set:typeof Date<"u"&&e instanceof Date?D.date:D.object;default:return D.unknown}};var b=W.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),IM=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),Ht=(()=>{class e extends Error{get errors(){return this.issues}constructor(n){super(),this.issues=[],this.addIssue=o=>{this.issues=[...this.issues,o]},this.addIssues=(o=[])=>{this.issues=[...this.issues,...o]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=n}format(n){let r=n||function(s){return s.message},o={_errors:[]},i=s=>{for(let a of s.issues)if(a.code==="invalid_union")a.unionErrors.map(i);else if(a.code==="invalid_return_type")i(a.returnTypeError);else if(a.code==="invalid_arguments")i(a.argumentsError);else if(a.path.length===0)o._errors.push(r(a));else{let u=o,l=0;for(;l<a.path.length;){let d=a.path[l];l===a.path.length-1?(u[d]=u[d]||{_errors:[]},u[d]._errors.push(r(a))):u[d]=u[d]||{_errors:[]},u=u[d],l++}}};return i(this),o}static assert(n){if(!(n instanceof e))throw new Error(`Not a ZodError: ${n}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,W.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(n=r=>r.message){let r={},o=[];for(let i of this.issues)if(i.path.length>0){let s=i.path[0];r[s]=r[s]||[],r[s].push(n(i))}else o.push(n(i));return{formErrors:o,fieldErrors:r}}get formErrors(){return this.flatten()}}return e.create=t=>new e(t),e})();var wM=(e,t)=>{let n;switch(e.code){case b.invalid_type:e.received===D.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case b.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,W.jsonStringifyReplacer)}`;break;case b.unrecognized_keys:n=`Unrecognized key(s) in object: ${W.joinValues(e.keys,", ")}`;break;case b.invalid_union:n="Invalid input";break;case b.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${W.joinValues(e.options)}`;break;case b.invalid_enum_value:n=`Invalid enum value. Expected ${W.joinValues(e.options)}, received '${e.received}'`;break;case b.invalid_arguments:n="Invalid function arguments";break;case b.invalid_return_type:n="Invalid function return type";break;case b.invalid_date:n="Invalid date";break;case b.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:W.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case b.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="bigint"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case b.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case b.custom:n="Invalid input";break;case b.invalid_intersection_types:n="Intersection results could not be merged";break;case b.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case b.not_finite:n="Number must be finite";break;default:n=t.defaultError,W.assertNever(e)}return{message:n}},an=wM;var A_=an;function bM(e){A_=e}function xo(){return A_}var fs=e=>{let{data:t,path:n,errorMaps:r,issueData:o}=e,i=[...n,...o.path||[]],s=g(p({},o),{path:i});if(o.message!==void 0)return g(p({},o),{path:i,message:o.message});let a="",u=r.filter(l=>!!l).slice().reverse();for(let l of u)a=l(s,{data:t,defaultError:a}).message;return g(p({},o),{path:i,message:a})},EM=[];function C(e,t){let n=xo(),r=fs({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===an?void 0:an].filter(o=>!!o)});e.common.issues.push(r)}var Te=class e{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){let r=[];for(let o of n){if(o.status==="aborted")return O;o.status==="dirty"&&t.dirty(),r.push(o.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,n){let r=[];for(let o of n){let i=await o.key,s=await o.value;r.push({key:i,value:s})}return e.mergeObjectSync(t,r)}static mergeObjectSync(t,n){let r={};for(let o of n){let{key:i,value:s}=o;if(i.status==="aborted"||s.status==="aborted")return O;i.status==="dirty"&&t.dirty(),s.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof s.value<"u"||o.alwaysSet)&&(r[i.value]=s.value)}return{status:t.value,value:r}}},O=Object.freeze({status:"aborted"}),_r=e=>({status:"dirty",value:e}),De=e=>({status:"valid",value:e}),Jc=e=>e.status==="aborted",Qc=e=>e.status==="dirty",An=e=>e.status==="valid",Co=e=>typeof Promise<"u"&&e instanceof Promise;var A=(function(e){return e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t?.message,e})(A||{});var nt=class{constructor(t,n,r,o){this._cachedPath=[],this.parent=t,this.data=n,this._path=r,this._key=o}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},N_=(e,t)=>{if(An(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let n=new Ht(e.common.issues);return this._error=n,this._error}}};function V(e){if(!e)return{};let{errorMap:t,invalid_type_error:n,required_error:r,description:o}=e;if(t&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:o}:{errorMap:(s,a)=>{let{message:u}=e;return s.code==="invalid_enum_value"?{message:u??a.defaultError}:typeof a.data>"u"?{message:u??r??a.defaultError}:s.code!=="invalid_type"?{message:a.defaultError}:{message:u??n??a.defaultError}},description:o}}var q=class{get description(){return this._def.description}_getType(t){return Ut(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:Ut(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new Te,ctx:{common:t.parent.common,data:t.data,parsedType:Ut(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){let n=this._parse(t);if(Co(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){let n=this._parse(t);return Promise.resolve(n)}parse(t,n){let r=this.safeParse(t,n);if(r.success)return r.data;throw r.error}safeParse(t,n){let r={common:{issues:[],async:n?.async??!1,contextualErrorMap:n?.errorMap},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Ut(t)},o=this._parseSync({data:t,path:r.path,parent:r});return N_(r,o)}"~validate"(t){let n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Ut(t)};if(!this["~standard"].async)try{let r=this._parseSync({data:t,path:[],parent:n});return An(r)?{value:r.value}:{issues:n.common.issues}}catch(r){r?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:n}).then(r=>An(r)?{value:r.value}:{issues:n.common.issues})}async parseAsync(t,n){let r=await this.safeParseAsync(t,n);if(r.success)return r.data;throw r.error}async safeParseAsync(t,n){let r={common:{issues:[],contextualErrorMap:n?.errorMap,async:!0},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Ut(t)},o=this._parse({data:t,path:r.path,parent:r}),i=await(Co(o)?o:Promise.resolve(o));return N_(r,i)}refine(t,n){let r=o=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(o):n;return this._refinement((o,i)=>{let s=t(o),a=()=>i.addIssue(p({code:b.custom},r(o)));return typeof Promise<"u"&&s instanceof Promise?s.then(u=>u?!0:(a(),!1)):s?!0:(a(),!1)})}refinement(t,n){return this._refinement((r,o)=>t(r)?!0:(o.addIssue(typeof n=="function"?n(r,o):n),!1))}_refinement(t){return new No({schema:this,typeName:E.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Nn.create(this,this._def)}nullable(){return Ro.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return hs.create(this)}promise(){return ru.create(this,this._def)}or(t){return op.create([this,t],this._def)}and(t){return ip.create(this,t,this._def)}transform(t){return new No(g(p({},V(this._def)),{schema:this,typeName:E.ZodEffects,effect:{type:"transform",transform:t}}))}default(t){let n=typeof t=="function"?t:()=>t;return new up(g(p({},V(this._def)),{innerType:this,defaultValue:n,typeName:E.ZodDefault}))}brand(){return new ms(p({typeName:E.ZodBranded,type:this},V(this._def)))}catch(t){let n=typeof t=="function"?t:()=>t;return new lp(g(p({},V(this._def)),{innerType:this,catchValue:n,typeName:E.ZodCatch}))}describe(t){let n=this.constructor;return new n(g(p({},this._def),{description:t}))}pipe(t){return gs.create(this,t)}readonly(){return dp.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},SM=/^c[^\s-]{8,}$/i,TM=/^[0-9a-z]+$/,xM=/^[0-9A-HJKMNP-TV-Z]{26}$/i,CM=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,DM=/^[a-z0-9_-]{21}$/i,MM=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,AM=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,NM=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,RM="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",Qf,OM=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,kM=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,PM=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,LM=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,jM=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,FM=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,O_="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",$M=new RegExp(`^${O_}$`);function k_(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);let n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function UM(e){return new RegExp(`^${k_(e)}$`)}function P_(e){let t=`${O_}T${k_(e)}`,n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function HM(e,t){return!!((t==="v4"||!t)&&OM.test(e)||(t==="v6"||!t)&&PM.test(e))}function VM(e,t){if(!MM.test(e))return!1;try{let[n]=e.split(".");if(!n)return!1;let r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),o=JSON.parse(atob(r));return!(typeof o!="object"||o===null||"typ"in o&&o?.typ!=="JWT"||!o.alg||t&&o.alg!==t)}catch{return!1}}function BM(e,t){return!!((t==="v4"||!t)&&kM.test(e)||(t==="v6"||!t)&&LM.test(e))}var tu=(()=>{class e extends q{_parse(n){if(this._def.coerce&&(n.data=String(n.data)),this._getType(n)!==D.string){let s=this._getOrReturnCtx(n);return C(s,{code:b.invalid_type,expected:D.string,received:s.parsedType}),O}let o=new Te,i;for(let s of this._def.checks)if(s.kind==="min")n.data.length<s.value&&(i=this._getOrReturnCtx(n,i),C(i,{code:b.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),o.dirty());else if(s.kind==="max")n.data.length>s.value&&(i=this._getOrReturnCtx(n,i),C(i,{code:b.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),o.dirty());else if(s.kind==="length"){let a=n.data.length>s.value,u=n.data.length<s.value;(a||u)&&(i=this._getOrReturnCtx(n,i),a?C(i,{code:b.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):u&&C(i,{code:b.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),o.dirty())}else if(s.kind==="email")NM.test(n.data)||(i=this._getOrReturnCtx(n,i),C(i,{validation:"email",code:b.invalid_string,message:s.message}),o.dirty());else if(s.kind==="emoji")Qf||(Qf=new RegExp(RM,"u")),Qf.test(n.data)||(i=this._getOrReturnCtx(n,i),C(i,{validation:"emoji",code:b.invalid_string,message:s.message}),o.dirty());else if(s.kind==="uuid")CM.test(n.data)||(i=this._getOrReturnCtx(n,i),C(i,{validation:"uuid",code:b.invalid_string,message:s.message}),o.dirty());else if(s.kind==="nanoid")DM.test(n.data)||(i=this._getOrReturnCtx(n,i),C(i,{validation:"nanoid",code:b.invalid_string,message:s.message}),o.dirty());else if(s.kind==="cuid")SM.test(n.data)||(i=this._getOrReturnCtx(n,i),C(i,{validation:"cuid",code:b.invalid_string,message:s.message}),o.dirty());else if(s.kind==="cuid2")TM.test(n.data)||(i=this._getOrReturnCtx(n,i),C(i,{validation:"cuid2",code:b.invalid_string,message:s.message}),o.dirty());else if(s.kind==="ulid")xM.test(n.data)||(i=this._getOrReturnCtx(n,i),C(i,{validation:"ulid",code:b.invalid_string,message:s.message}),o.dirty());else if(s.kind==="url")try{new URL(n.data)}catch{i=this._getOrReturnCtx(n,i),C(i,{validation:"url",code:b.invalid_string,message:s.message}),o.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(n.data)||(i=this._getOrReturnCtx(n,i),C(i,{validation:"regex",code:b.invalid_string,message:s.message}),o.dirty())):s.kind==="trim"?n.data=n.data.trim():s.kind==="includes"?n.data.includes(s.value,s.position)||(i=this._getOrReturnCtx(n,i),C(i,{code:b.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),o.dirty()):s.kind==="toLowerCase"?n.data=n.data.toLowerCase():s.kind==="toUpperCase"?n.data=n.data.toUpperCase():s.kind==="startsWith"?n.data.startsWith(s.value)||(i=this._getOrReturnCtx(n,i),C(i,{code:b.invalid_string,validation:{startsWith:s.value},message:s.message}),o.dirty()):s.kind==="endsWith"?n.data.endsWith(s.value)||(i=this._getOrReturnCtx(n,i),C(i,{code:b.invalid_string,validation:{endsWith:s.value},message:s.message}),o.dirty()):s.kind==="datetime"?P_(s).test(n.data)||(i=this._getOrReturnCtx(n,i),C(i,{code:b.invalid_string,validation:"datetime",message:s.message}),o.dirty()):s.kind==="date"?$M.test(n.data)||(i=this._getOrReturnCtx(n,i),C(i,{code:b.invalid_string,validation:"date",message:s.message}),o.dirty()):s.kind==="time"?UM(s).test(n.data)||(i=this._getOrReturnCtx(n,i),C(i,{code:b.invalid_string,validation:"time",message:s.message}),o.dirty()):s.kind==="duration"?AM.test(n.data)||(i=this._getOrReturnCtx(n,i),C(i,{validation:"duration",code:b.invalid_string,message:s.message}),o.dirty()):s.kind==="ip"?HM(n.data,s.version)||(i=this._getOrReturnCtx(n,i),C(i,{validation:"ip",code:b.invalid_string,message:s.message}),o.dirty()):s.kind==="jwt"?VM(n.data,s.alg)||(i=this._getOrReturnCtx(n,i),C(i,{validation:"jwt",code:b.invalid_string,message:s.message}),o.dirty()):s.kind==="cidr"?BM(n.data,s.version)||(i=this._getOrReturnCtx(n,i),C(i,{validation:"cidr",code:b.invalid_string,message:s.message}),o.dirty()):s.kind==="base64"?jM.test(n.data)||(i=this._getOrReturnCtx(n,i),C(i,{validation:"base64",code:b.invalid_string,message:s.message}),o.dirty()):s.kind==="base64url"?FM.test(n.data)||(i=this._getOrReturnCtx(n,i),C(i,{validation:"base64url",code:b.invalid_string,message:s.message}),o.dirty()):W.assertNever(s);return{status:o.value,value:n.data}}_regex(n,r,o){return this.refinement(i=>n.test(i),p({validation:r,code:b.invalid_string},A.errToObj(o)))}_addCheck(n){return new e(g(p({},this._def),{checks:[...this._def.checks,n]}))}email(n){return this._addCheck(p({kind:"email"},A.errToObj(n)))}url(n){return this._addCheck(p({kind:"url"},A.errToObj(n)))}emoji(n){return this._addCheck(p({kind:"emoji"},A.errToObj(n)))}uuid(n){return this._addCheck(p({kind:"uuid"},A.errToObj(n)))}nanoid(n){return this._addCheck(p({kind:"nanoid"},A.errToObj(n)))}cuid(n){return this._addCheck(p({kind:"cuid"},A.errToObj(n)))}cuid2(n){return this._addCheck(p({kind:"cuid2"},A.errToObj(n)))}ulid(n){return this._addCheck(p({kind:"ulid"},A.errToObj(n)))}base64(n){return this._addCheck(p({kind:"base64"},A.errToObj(n)))}base64url(n){return this._addCheck(p({kind:"base64url"},A.errToObj(n)))}jwt(n){return this._addCheck(p({kind:"jwt"},A.errToObj(n)))}ip(n){return this._addCheck(p({kind:"ip"},A.errToObj(n)))}cidr(n){return this._addCheck(p({kind:"cidr"},A.errToObj(n)))}datetime(n){return typeof n=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:n}):this._addCheck(p({kind:"datetime",precision:typeof n?.precision>"u"?null:n?.precision,offset:n?.offset??!1,local:n?.local??!1},A.errToObj(n?.message)))}date(n){return this._addCheck({kind:"date",message:n})}time(n){return typeof n=="string"?this._addCheck({kind:"time",precision:null,message:n}):this._addCheck(p({kind:"time",precision:typeof n?.precision>"u"?null:n?.precision},A.errToObj(n?.message)))}duration(n){return this._addCheck(p({kind:"duration"},A.errToObj(n)))}regex(n,r){return this._addCheck(p({kind:"regex",regex:n},A.errToObj(r)))}includes(n,r){return this._addCheck(p({kind:"includes",value:n,position:r?.position},A.errToObj(r?.message)))}startsWith(n,r){return this._addCheck(p({kind:"startsWith",value:n},A.errToObj(r)))}endsWith(n,r){return this._addCheck(p({kind:"endsWith",value:n},A.errToObj(r)))}min(n,r){return this._addCheck(p({kind:"min",value:n},A.errToObj(r)))}max(n,r){return this._addCheck(p({kind:"max",value:n},A.errToObj(r)))}length(n,r){return this._addCheck(p({kind:"length",value:n},A.errToObj(r)))}nonempty(n){return this.min(1,A.errToObj(n))}trim(){return new e(g(p({},this._def),{checks:[...this._def.checks,{kind:"trim"}]}))}toLowerCase(){return new e(g(p({},this._def),{checks:[...this._def.checks,{kind:"toLowerCase"}]}))}toUpperCase(){return new e(g(p({},this._def),{checks:[...this._def.checks,{kind:"toUpperCase"}]}))}get isDatetime(){return!!this._def.checks.find(n=>n.kind==="datetime")}get isDate(){return!!this._def.checks.find(n=>n.kind==="date")}get isTime(){return!!this._def.checks.find(n=>n.kind==="time")}get isDuration(){return!!this._def.checks.find(n=>n.kind==="duration")}get isEmail(){return!!this._def.checks.find(n=>n.kind==="email")}get isURL(){return!!this._def.checks.find(n=>n.kind==="url")}get isEmoji(){return!!this._def.checks.find(n=>n.kind==="emoji")}get isUUID(){return!!this._def.checks.find(n=>n.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(n=>n.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(n=>n.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(n=>n.kind==="cuid2")}get isULID(){return!!this._def.checks.find(n=>n.kind==="ulid")}get isIP(){return!!this._def.checks.find(n=>n.kind==="ip")}get isCIDR(){return!!this._def.checks.find(n=>n.kind==="cidr")}get isBase64(){return!!this._def.checks.find(n=>n.kind==="base64")}get isBase64url(){return!!this._def.checks.find(n=>n.kind==="base64url")}get minLength(){let n=null;for(let r of this._def.checks)r.kind==="min"&&(n===null||r.value>n)&&(n=r.value);return n}get maxLength(){let n=null;for(let r of this._def.checks)r.kind==="max"&&(n===null||r.value<n)&&(n=r.value);return n}}return e.create=t=>new e(p({checks:[],typeName:E.ZodString,coerce:t?.coerce??!1},V(t))),e})();function zM(e,t){let n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,o=n>r?n:r,i=Number.parseInt(e.toFixed(o).replace(".","")),s=Number.parseInt(t.toFixed(o).replace(".",""));return i%s/10**o}var Kf=(()=>{class e extends q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(n){if(this._def.coerce&&(n.data=Number(n.data)),this._getType(n)!==D.number){let s=this._getOrReturnCtx(n);return C(s,{code:b.invalid_type,expected:D.number,received:s.parsedType}),O}let o,i=new Te;for(let s of this._def.checks)s.kind==="int"?W.isInteger(n.data)||(o=this._getOrReturnCtx(n,o),C(o,{code:b.invalid_type,expected:"integer",received:"float",message:s.message}),i.dirty()):s.kind==="min"?(s.inclusive?n.data<s.value:n.data<=s.value)&&(o=this._getOrReturnCtx(n,o),C(o,{code:b.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?n.data>s.value:n.data>=s.value)&&(o=this._getOrReturnCtx(n,o),C(o,{code:b.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="multipleOf"?zM(n.data,s.value)!==0&&(o=this._getOrReturnCtx(n,o),C(o,{code:b.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):s.kind==="finite"?Number.isFinite(n.data)||(o=this._getOrReturnCtx(n,o),C(o,{code:b.not_finite,message:s.message}),i.dirty()):W.assertNever(s);return{status:i.value,value:n.data}}gte(n,r){return this.setLimit("min",n,!0,A.toString(r))}gt(n,r){return this.setLimit("min",n,!1,A.toString(r))}lte(n,r){return this.setLimit("max",n,!0,A.toString(r))}lt(n,r){return this.setLimit("max",n,!1,A.toString(r))}setLimit(n,r,o,i){return new e(g(p({},this._def),{checks:[...this._def.checks,{kind:n,value:r,inclusive:o,message:A.toString(i)}]}))}_addCheck(n){return new e(g(p({},this._def),{checks:[...this._def.checks,n]}))}int(n){return this._addCheck({kind:"int",message:A.toString(n)})}positive(n){return this._addCheck({kind:"min",value:0,inclusive:!1,message:A.toString(n)})}negative(n){return this._addCheck({kind:"max",value:0,inclusive:!1,message:A.toString(n)})}nonpositive(n){return this._addCheck({kind:"max",value:0,inclusive:!0,message:A.toString(n)})}nonnegative(n){return this._addCheck({kind:"min",value:0,inclusive:!0,message:A.toString(n)})}multipleOf(n,r){return this._addCheck({kind:"multipleOf",value:n,message:A.toString(r)})}finite(n){return this._addCheck({kind:"finite",message:A.toString(n)})}safe(n){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:A.toString(n)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:A.toString(n)})}get minValue(){let n=null;for(let r of this._def.checks)r.kind==="min"&&(n===null||r.value>n)&&(n=r.value);return n}get maxValue(){let n=null;for(let r of this._def.checks)r.kind==="max"&&(n===null||r.value<n)&&(n=r.value);return n}get isInt(){return!!this._def.checks.find(n=>n.kind==="int"||n.kind==="multipleOf"&&W.isInteger(n.value))}get isFinite(){let n=null,r=null;for(let o of this._def.checks){if(o.kind==="finite"||o.kind==="int"||o.kind==="multipleOf")return!0;o.kind==="min"?(r===null||o.value>r)&&(r=o.value):o.kind==="max"&&(n===null||o.value<n)&&(n=o.value)}return Number.isFinite(r)&&Number.isFinite(n)}}return e.create=t=>new e(p({checks:[],typeName:E.ZodNumber,coerce:t?.coerce||!1},V(t))),e})(),Xf=(()=>{class e extends q{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(n){if(this._def.coerce)try{n.data=BigInt(n.data)}catch{return this._getInvalidInput(n)}if(this._getType(n)!==D.bigint)return this._getInvalidInput(n);let o,i=new Te;for(let s of this._def.checks)s.kind==="min"?(s.inclusive?n.data<s.value:n.data<=s.value)&&(o=this._getOrReturnCtx(n,o),C(o,{code:b.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?n.data>s.value:n.data>=s.value)&&(o=this._getOrReturnCtx(n,o),C(o,{code:b.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="multipleOf"?n.data%s.value!==BigInt(0)&&(o=this._getOrReturnCtx(n,o),C(o,{code:b.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):W.assertNever(s);return{status:i.value,value:n.data}}_getInvalidInput(n){let r=this._getOrReturnCtx(n);return C(r,{code:b.invalid_type,expected:D.bigint,received:r.parsedType}),O}gte(n,r){return this.setLimit("min",n,!0,A.toString(r))}gt(n,r){return this.setLimit("min",n,!1,A.toString(r))}lte(n,r){return this.setLimit("max",n,!0,A.toString(r))}lt(n,r){return this.setLimit("max",n,!1,A.toString(r))}setLimit(n,r,o,i){return new e(g(p({},this._def),{checks:[...this._def.checks,{kind:n,value:r,inclusive:o,message:A.toString(i)}]}))}_addCheck(n){return new e(g(p({},this._def),{checks:[...this._def.checks,n]}))}positive(n){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:A.toString(n)})}negative(n){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:A.toString(n)})}nonpositive(n){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:A.toString(n)})}nonnegative(n){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:A.toString(n)})}multipleOf(n,r){return this._addCheck({kind:"multipleOf",value:n,message:A.toString(r)})}get minValue(){let n=null;for(let r of this._def.checks)r.kind==="min"&&(n===null||r.value>n)&&(n=r.value);return n}get maxValue(){let n=null;for(let r of this._def.checks)r.kind==="max"&&(n===null||r.value<n)&&(n=r.value);return n}}return e.create=t=>new e(p({checks:[],typeName:E.ZodBigInt,coerce:t?.coerce??!1},V(t))),e})(),ep=(()=>{class e extends q{_parse(n){if(this._def.coerce&&(n.data=!!n.data),this._getType(n)!==D.boolean){let o=this._getOrReturnCtx(n);return C(o,{code:b.invalid_type,expected:D.boolean,received:o.parsedType}),O}return De(n.data)}}return e.create=t=>new e(p({typeName:E.ZodBoolean,coerce:t?.coerce||!1},V(t))),e})(),tp=(()=>{class e extends q{_parse(n){if(this._def.coerce&&(n.data=new Date(n.data)),this._getType(n)!==D.date){let s=this._getOrReturnCtx(n);return C(s,{code:b.invalid_type,expected:D.date,received:s.parsedType}),O}if(Number.isNaN(n.data.getTime())){let s=this._getOrReturnCtx(n);return C(s,{code:b.invalid_date}),O}let o=new Te,i;for(let s of this._def.checks)s.kind==="min"?n.data.getTime()<s.value&&(i=this._getOrReturnCtx(n,i),C(i,{code:b.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),o.dirty()):s.kind==="max"?n.data.getTime()>s.value&&(i=this._getOrReturnCtx(n,i),C(i,{code:b.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),o.dirty()):W.assertNever(s);return{status:o.value,value:new Date(n.data.getTime())}}_addCheck(n){return new e(g(p({},this._def),{checks:[...this._def.checks,n]}))}min(n,r){return this._addCheck({kind:"min",value:n.getTime(),message:A.toString(r)})}max(n,r){return this._addCheck({kind:"max",value:n.getTime(),message:A.toString(r)})}get minDate(){let n=null;for(let r of this._def.checks)r.kind==="min"&&(n===null||r.value>n)&&(n=r.value);return n!=null?new Date(n):null}get maxDate(){let n=null;for(let r of this._def.checks)r.kind==="max"&&(n===null||r.value<n)&&(n=r.value);return n!=null?new Date(n):null}}return e.create=t=>new e(p({checks:[],coerce:t?.coerce||!1,typeName:E.ZodDate},V(t))),e})(),L_=(()=>{class e extends q{_parse(n){if(this._getType(n)!==D.symbol){let o=this._getOrReturnCtx(n);return C(o,{code:b.invalid_type,expected:D.symbol,received:o.parsedType}),O}return De(n.data)}}return e.create=t=>new e(p({typeName:E.ZodSymbol},V(t))),e})(),np=(()=>{class e extends q{_parse(n){if(this._getType(n)!==D.undefined){let o=this._getOrReturnCtx(n);return C(o,{code:b.invalid_type,expected:D.undefined,received:o.parsedType}),O}return De(n.data)}}return e.create=t=>new e(p({typeName:E.ZodUndefined},V(t))),e})(),rp=(()=>{class e extends q{_parse(n){if(this._getType(n)!==D.null){let o=this._getOrReturnCtx(n);return C(o,{code:b.invalid_type,expected:D.null,received:o.parsedType}),O}return De(n.data)}}return e.create=t=>new e(p({typeName:E.ZodNull},V(t))),e})(),Yc=(()=>{class e extends q{constructor(){super(...arguments),this._any=!0}_parse(n){return De(n.data)}}return e.create=t=>new e(p({typeName:E.ZodAny},V(t))),e})(),ps=(()=>{class e extends q{constructor(){super(...arguments),this._unknown=!0}_parse(n){return De(n.data)}}return e.create=t=>new e(p({typeName:E.ZodUnknown},V(t))),e})(),Ir=(()=>{class e extends q{_parse(n){let r=this._getOrReturnCtx(n);return C(r,{code:b.invalid_type,expected:D.never,received:r.parsedType}),O}}return e.create=t=>new e(p({typeName:E.ZodNever},V(t))),e})(),j_=(()=>{class e extends q{_parse(n){if(this._getType(n)!==D.undefined){let o=this._getOrReturnCtx(n);return C(o,{code:b.invalid_type,expected:D.void,received:o.parsedType}),O}return De(n.data)}}return e.create=t=>new e(p({typeName:E.ZodVoid},V(t))),e})(),hs=(()=>{class e extends q{_parse(n){let{ctx:r,status:o}=this._processInputParams(n),i=this._def;if(r.parsedType!==D.array)return C(r,{code:b.invalid_type,expected:D.array,received:r.parsedType}),O;if(i.exactLength!==null){let a=r.data.length>i.exactLength.value,u=r.data.length<i.exactLength.value;(a||u)&&(C(r,{code:a?b.too_big:b.too_small,minimum:u?i.exactLength.value:void 0,maximum:a?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),o.dirty())}if(i.minLength!==null&&r.data.length<i.minLength.value&&(C(r,{code:b.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),o.dirty()),i.maxLength!==null&&r.data.length>i.maxLength.value&&(C(r,{code:b.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),o.dirty()),r.common.async)return Promise.all([...r.data].map((a,u)=>i.type._parseAsync(new nt(r,a,r.path,u)))).then(a=>Te.mergeArray(o,a));let s=[...r.data].map((a,u)=>i.type._parseSync(new nt(r,a,r.path,u)));return Te.mergeArray(o,s)}get element(){return this._def.type}min(n,r){return new e(g(p({},this._def),{minLength:{value:n,message:A.toString(r)}}))}max(n,r){return new e(g(p({},this._def),{maxLength:{value:n,message:A.toString(r)}}))}length(n,r){return new e(g(p({},this._def),{exactLength:{value:n,message:A.toString(r)}}))}nonempty(n){return this.min(1,n)}}return e.create=(t,n)=>new e(p({type:t,minLength:null,maxLength:null,exactLength:null,typeName:E.ZodArray},V(n))),e})();function Do(e){if(e instanceof Mo){let t={};for(let n in e.shape){let r=e.shape[n];t[n]=Nn.create(Do(r))}return new Mo(g(p({},e._def),{shape:()=>t}))}else return e instanceof hs?new hs(g(p({},e._def),{type:Do(e.element)})):e instanceof Nn?Nn.create(Do(e.unwrap())):e instanceof Ro?Ro.create(Do(e.unwrap())):e instanceof Ao?Ao.create(e.items.map(t=>Do(t))):e}var Mo=(()=>{class e extends q{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let n=this._def.shape(),r=W.objectKeys(n);return this._cached={shape:n,keys:r},this._cached}_parse(n){if(this._getType(n)!==D.object){let d=this._getOrReturnCtx(n);return C(d,{code:b.invalid_type,expected:D.object,received:d.parsedType}),O}let{status:o,ctx:i}=this._processInputParams(n),{shape:s,keys:a}=this._getCached(),u=[];if(!(this._def.catchall instanceof Ir&&this._def.unknownKeys==="strip"))for(let d in i.data)a.includes(d)||u.push(d);let l=[];for(let d of a){let f=s[d],m=i.data[d];l.push({key:{status:"valid",value:d},value:f._parse(new nt(i,m,i.path,d)),alwaysSet:d in i.data})}if(this._def.catchall instanceof Ir){let d=this._def.unknownKeys;if(d==="passthrough")for(let f of u)l.push({key:{status:"valid",value:f},value:{status:"valid",value:i.data[f]}});else if(d==="strict")u.length>0&&(C(i,{code:b.unrecognized_keys,keys:u}),o.dirty());else if(d!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let d=this._def.catchall;for(let f of u){let m=i.data[f];l.push({key:{status:"valid",value:f},value:d._parse(new nt(i,m,i.path,f)),alwaysSet:f in i.data})}}return i.common.async?Promise.resolve().then(async()=>{let d=[];for(let f of l){let m=await f.key,h=await f.value;d.push({key:m,value:h,alwaysSet:f.alwaysSet})}return d}).then(d=>Te.mergeObjectSync(o,d)):Te.mergeObjectSync(o,l)}get shape(){return this._def.shape()}strict(n){return A.errToObj,new e(p(g(p({},this._def),{unknownKeys:"strict"}),n!==void 0?{errorMap:(r,o)=>{let i=this._def.errorMap?.(r,o).message??o.defaultError;return r.code==="unrecognized_keys"?{message:A.errToObj(n).message??i}:{message:i}}}:{}))}strip(){return new e(g(p({},this._def),{unknownKeys:"strip"}))}passthrough(){return new e(g(p({},this._def),{unknownKeys:"passthrough"}))}extend(n){return new e(g(p({},this._def),{shape:()=>p(p({},this._def.shape()),n)}))}merge(n){return new e({unknownKeys:n._def.unknownKeys,catchall:n._def.catchall,shape:()=>p(p({},this._def.shape()),n._def.shape()),typeName:E.ZodObject})}setKey(n,r){return this.augment({[n]:r})}catchall(n){return new e(g(p({},this._def),{catchall:n}))}pick(n){let r={};for(let o of W.objectKeys(n))n[o]&&this.shape[o]&&(r[o]=this.shape[o]);return new e(g(p({},this._def),{shape:()=>r}))}omit(n){let r={};for(let o of W.objectKeys(this.shape))n[o]||(r[o]=this.shape[o]);return new e(g(p({},this._def),{shape:()=>r}))}deepPartial(){return Do(this)}partial(n){let r={};for(let o of W.objectKeys(this.shape)){let i=this.shape[o];n&&!n[o]?r[o]=i:r[o]=i.optional()}return new e(g(p({},this._def),{shape:()=>r}))}required(n){let r={};for(let o of W.objectKeys(this.shape))if(n&&!n[o])r[o]=this.shape[o];else{let s=this.shape[o];for(;s instanceof Nn;)s=s._def.innerType;r[o]=s}return new e(g(p({},this._def),{shape:()=>r}))}keyof(){return U_(W.objectKeys(this.shape))}}return e.create=(t,n)=>new e(p({shape:()=>t,unknownKeys:"strip",catchall:Ir.create(),typeName:E.ZodObject},V(n))),e.strictCreate=(t,n)=>new e(p({shape:()=>t,unknownKeys:"strict",catchall:Ir.create(),typeName:E.ZodObject},V(n))),e.lazycreate=(t,n)=>new e(p({shape:t,unknownKeys:"strip",catchall:Ir.create(),typeName:E.ZodObject},V(n))),e})(),op=(()=>{class e extends q{_parse(n){let{ctx:r}=this._processInputParams(n),o=this._def.options;function i(s){for(let u of s)if(u.result.status==="valid")return u.result;for(let u of s)if(u.result.status==="dirty")return r.common.issues.push(...u.ctx.common.issues),u.result;let a=s.map(u=>new Ht(u.ctx.common.issues));return C(r,{code:b.invalid_union,unionErrors:a}),O}if(r.common.async)return Promise.all(o.map(async s=>{let a=g(p({},r),{common:g(p({},r.common),{issues:[]}),parent:null});return{result:await s._parseAsync({data:r.data,path:r.path,parent:a}),ctx:a}})).then(i);{let s,a=[];for(let l of o){let d=g(p({},r),{common:g(p({},r.common),{issues:[]}),parent:null}),f=l._parseSync({data:r.data,path:r.path,parent:d});if(f.status==="valid")return f;f.status==="dirty"&&!s&&(s={result:f,ctx:d}),d.common.issues.length&&a.push(d.common.issues)}if(s)return r.common.issues.push(...s.ctx.common.issues),s.result;let u=a.map(l=>new Ht(l));return C(r,{code:b.invalid_union,unionErrors:u}),O}}get options(){return this._def.options}}return e.create=(t,n)=>new e(p({options:t,typeName:E.ZodUnion},V(n))),e})(),cn=e=>e instanceof sp?cn(e.schema):e instanceof No?cn(e.innerType()):e instanceof ap?[e.value]:e instanceof nu?e.options:e instanceof cp?W.objectValues(e.enum):e instanceof up?cn(e._def.innerType):e instanceof np?[void 0]:e instanceof rp?[null]:e instanceof Nn?[void 0,...cn(e.unwrap())]:e instanceof Ro?[null,...cn(e.unwrap())]:e instanceof ms||e instanceof dp?cn(e.unwrap()):e instanceof lp?cn(e._def.innerType):[],Kc=class e extends q{_parse(t){let{ctx:n}=this._processInputParams(t);if(n.parsedType!==D.object)return C(n,{code:b.invalid_type,expected:D.object,received:n.parsedType}),O;let r=this.discriminator,o=n.data[r],i=this.optionsMap.get(o);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(C(n,{code:b.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),O)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,n,r){let o=new Map;for(let i of n){let s=cn(i.shape[t]);if(!s.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(let a of s){if(o.has(a))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(a)}`);o.set(a,i)}}return new e(p({typeName:E.ZodDiscriminatedUnion,discriminator:t,options:n,optionsMap:o},V(r)))}};function Yf(e,t){let n=Ut(e),r=Ut(t);if(e===t)return{valid:!0,data:e};if(n===D.object&&r===D.object){let o=W.objectKeys(t),i=W.objectKeys(e).filter(a=>o.indexOf(a)!==-1),s=p(p({},e),t);for(let a of i){let u=Yf(e[a],t[a]);if(!u.valid)return{valid:!1};s[a]=u.data}return{valid:!0,data:s}}else if(n===D.array&&r===D.array){if(e.length!==t.length)return{valid:!1};let o=[];for(let i=0;i<e.length;i++){let s=e[i],a=t[i],u=Yf(s,a);if(!u.valid)return{valid:!1};o.push(u.data)}return{valid:!0,data:o}}else return n===D.date&&r===D.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}var ip=(()=>{class e extends q{_parse(n){let{status:r,ctx:o}=this._processInputParams(n),i=(s,a)=>{if(Jc(s)||Jc(a))return O;let u=Yf(s.value,a.value);return u.valid?((Qc(s)||Qc(a))&&r.dirty(),{status:r.value,value:u.data}):(C(o,{code:b.invalid_intersection_types}),O)};return o.common.async?Promise.all([this._def.left._parseAsync({data:o.data,path:o.path,parent:o}),this._def.right._parseAsync({data:o.data,path:o.path,parent:o})]).then(([s,a])=>i(s,a)):i(this._def.left._parseSync({data:o.data,path:o.path,parent:o}),this._def.right._parseSync({data:o.data,path:o.path,parent:o}))}}return e.create=(t,n,r)=>new e(p({left:t,right:n,typeName:E.ZodIntersection},V(r))),e})(),Ao=(()=>{class e extends q{_parse(n){let{status:r,ctx:o}=this._processInputParams(n);if(o.parsedType!==D.array)return C(o,{code:b.invalid_type,expected:D.array,received:o.parsedType}),O;if(o.data.length<this._def.items.length)return C(o,{code:b.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),O;!this._def.rest&&o.data.length>this._def.items.length&&(C(o,{code:b.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());let s=[...o.data].map((a,u)=>{let l=this._def.items[u]||this._def.rest;return l?l._parse(new nt(o,a,o.path,u)):null}).filter(a=>!!a);return o.common.async?Promise.all(s).then(a=>Te.mergeArray(r,a)):Te.mergeArray(r,s)}get items(){return this._def.items}rest(n){return new e(g(p({},this._def),{rest:n}))}}return e.create=(t,n)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new e(p({items:t,typeName:E.ZodTuple,rest:null},V(n)))},e})(),Xc=class e extends q{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){let{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==D.object)return C(r,{code:b.invalid_type,expected:D.object,received:r.parsedType}),O;let o=[],i=this._def.keyType,s=this._def.valueType;for(let a in r.data)o.push({key:i._parse(new nt(r,a,r.path,a)),value:s._parse(new nt(r,r.data[a],r.path,a)),alwaysSet:a in r.data});return r.common.async?Te.mergeObjectAsync(n,o):Te.mergeObjectSync(n,o)}get element(){return this._def.valueType}static create(t,n,r){return n instanceof q?new e(p({keyType:t,valueType:n,typeName:E.ZodRecord},V(r))):new e(p({keyType:tu.create(),valueType:t,typeName:E.ZodRecord},V(n)))}},F_=(()=>{class e extends q{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(n){let{status:r,ctx:o}=this._processInputParams(n);if(o.parsedType!==D.map)return C(o,{code:b.invalid_type,expected:D.map,received:o.parsedType}),O;let i=this._def.keyType,s=this._def.valueType,a=[...o.data.entries()].map(([u,l],d)=>({key:i._parse(new nt(o,u,o.path,[d,"key"])),value:s._parse(new nt(o,l,o.path,[d,"value"]))}));if(o.common.async){let u=new Map;return Promise.resolve().then(async()=>{for(let l of a){let d=await l.key,f=await l.value;if(d.status==="aborted"||f.status==="aborted")return O;(d.status==="dirty"||f.status==="dirty")&&r.dirty(),u.set(d.value,f.value)}return{status:r.value,value:u}})}else{let u=new Map;for(let l of a){let d=l.key,f=l.value;if(d.status==="aborted"||f.status==="aborted")return O;(d.status==="dirty"||f.status==="dirty")&&r.dirty(),u.set(d.value,f.value)}return{status:r.value,value:u}}}}return e.create=(t,n,r)=>new e(p({valueType:n,keyType:t,typeName:E.ZodMap},V(r))),e})(),$_=(()=>{class e extends q{_parse(n){let{status:r,ctx:o}=this._processInputParams(n);if(o.parsedType!==D.set)return C(o,{code:b.invalid_type,expected:D.set,received:o.parsedType}),O;let i=this._def;i.minSize!==null&&o.data.size<i.minSize.value&&(C(o,{code:b.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),r.dirty()),i.maxSize!==null&&o.data.size>i.maxSize.value&&(C(o,{code:b.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),r.dirty());let s=this._def.valueType;function a(l){let d=new Set;for(let f of l){if(f.status==="aborted")return O;f.status==="dirty"&&r.dirty(),d.add(f.value)}return{status:r.value,value:d}}let u=[...o.data.values()].map((l,d)=>s._parse(new nt(o,l,o.path,d)));return o.common.async?Promise.all(u).then(l=>a(l)):a(u)}min(n,r){return new e(g(p({},this._def),{minSize:{value:n,message:A.toString(r)}}))}max(n,r){return new e(g(p({},this._def),{maxSize:{value:n,message:A.toString(r)}}))}size(n,r){return this.min(n,r).max(n,r)}nonempty(n){return this.min(1,n)}}return e.create=(t,n)=>new e(p({valueType:t,minSize:null,maxSize:null,typeName:E.ZodSet},V(n))),e})(),eu=class e extends q{constructor(){super(...arguments),this.validate=this.implement}_parse(t){let{ctx:n}=this._processInputParams(t);if(n.parsedType!==D.function)return C(n,{code:b.invalid_type,expected:D.function,received:n.parsedType}),O;function r(a,u){return fs({data:a,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,xo(),an].filter(l=>!!l),issueData:{code:b.invalid_arguments,argumentsError:u}})}function o(a,u){return fs({data:a,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,xo(),an].filter(l=>!!l),issueData:{code:b.invalid_return_type,returnTypeError:u}})}let i={errorMap:n.common.contextualErrorMap},s=n.data;if(this._def.returns instanceof ru){let a=this;return De(async function(...u){let l=new Ht([]),d=await a._def.args.parseAsync(u,i).catch(h=>{throw l.addIssue(r(u,h)),l}),f=await Reflect.apply(s,this,d);return await a._def.returns._def.type.parseAsync(f,i).catch(h=>{throw l.addIssue(o(f,h)),l})})}else{let a=this;return De(function(...u){let l=a._def.args.safeParse(u,i);if(!l.success)throw new Ht([r(u,l.error)]);let d=Reflect.apply(s,this,l.data),f=a._def.returns.safeParse(d,i);if(!f.success)throw new Ht([o(d,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...t){return new e(g(p({},this._def),{args:Ao.create(t).rest(ps.create())}))}returns(t){return new e(g(p({},this._def),{returns:t}))}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(t,n,r){return new e(p({args:t||Ao.create([]).rest(ps.create()),returns:n||ps.create(),typeName:E.ZodFunction},V(r)))}},sp=(()=>{class e extends q{get schema(){return this._def.getter()}_parse(n){let{ctx:r}=this._processInputParams(n);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}return e.create=(t,n)=>new e(p({getter:t,typeName:E.ZodLazy},V(n))),e})(),ap=(()=>{class e extends q{_parse(n){if(n.data!==this._def.value){let r=this._getOrReturnCtx(n);return C(r,{received:r.data,code:b.invalid_literal,expected:this._def.value}),O}return{status:"valid",value:n.data}}get value(){return this._def.value}}return e.create=(t,n)=>new e(p({value:t,typeName:E.ZodLiteral},V(n))),e})();function U_(e,t){return new nu(p({values:e,typeName:E.ZodEnum},V(t)))}var nu=(()=>{class e extends q{_parse(n){if(typeof n.data!="string"){let r=this._getOrReturnCtx(n),o=this._def.values;return C(r,{expected:W.joinValues(o),received:r.parsedType,code:b.invalid_type}),O}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(n.data)){let r=this._getOrReturnCtx(n),o=this._def.values;return C(r,{received:r.data,code:b.invalid_enum_value,options:o}),O}return De(n.data)}get options(){return this._def.values}get enum(){let n={};for(let r of this._def.values)n[r]=r;return n}get Values(){let n={};for(let r of this._def.values)n[r]=r;return n}get Enum(){let n={};for(let r of this._def.values)n[r]=r;return n}extract(n,r=this._def){return e.create(n,p(p({},this._def),r))}exclude(n,r=this._def){return e.create(this.options.filter(o=>!n.includes(o)),p(p({},this._def),r))}}return e.create=U_,e})(),cp=(()=>{class e extends q{_parse(n){let r=W.getValidEnumValues(this._def.values),o=this._getOrReturnCtx(n);if(o.parsedType!==D.string&&o.parsedType!==D.number){let i=W.objectValues(r);return C(o,{expected:W.joinValues(i),received:o.parsedType,code:b.invalid_type}),O}if(this._cache||(this._cache=new Set(W.getValidEnumValues(this._def.values))),!this._cache.has(n.data)){let i=W.objectValues(r);return C(o,{received:o.data,code:b.invalid_enum_value,options:i}),O}return De(n.data)}get enum(){return this._def.values}}return e.create=(t,n)=>new e(p({values:t,typeName:E.ZodNativeEnum},V(n))),e})(),ru=(()=>{class e extends q{unwrap(){return this._def.type}_parse(n){let{ctx:r}=this._processInputParams(n);if(r.parsedType!==D.promise&&r.common.async===!1)return C(r,{code:b.invalid_type,expected:D.promise,received:r.parsedType}),O;let o=r.parsedType===D.promise?r.data:Promise.resolve(r.data);return De(o.then(i=>this._def.type.parseAsync(i,{path:r.path,errorMap:r.common.contextualErrorMap})))}}return e.create=(t,n)=>new e(p({type:t,typeName:E.ZodPromise},V(n))),e})(),No=(()=>{class e extends q{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===E.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(n){let{status:r,ctx:o}=this._processInputParams(n),i=this._def.effect||null,s={addIssue:a=>{C(o,a),a.fatal?r.abort():r.dirty()},get path(){return o.path}};if(s.addIssue=s.addIssue.bind(s),i.type==="preprocess"){let a=i.transform(o.data,s);if(o.common.async)return Promise.resolve(a).then(async u=>{if(r.value==="aborted")return O;let l=await this._def.schema._parseAsync({data:u,path:o.path,parent:o});return l.status==="aborted"?O:l.status==="dirty"?_r(l.value):r.value==="dirty"?_r(l.value):l});{if(r.value==="aborted")return O;let u=this._def.schema._parseSync({data:a,path:o.path,parent:o});return u.status==="aborted"?O:u.status==="dirty"?_r(u.value):r.value==="dirty"?_r(u.value):u}}if(i.type==="refinement"){let a=u=>{let l=i.refinement(u,s);if(o.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return u};if(o.common.async===!1){let u=this._def.schema._parseSync({data:o.data,path:o.path,parent:o});return u.status==="aborted"?O:(u.status==="dirty"&&r.dirty(),a(u.value),{status:r.value,value:u.value})}else return this._def.schema._parseAsync({data:o.data,path:o.path,parent:o}).then(u=>u.status==="aborted"?O:(u.status==="dirty"&&r.dirty(),a(u.value).then(()=>({status:r.value,value:u.value}))))}if(i.type==="transform")if(o.common.async===!1){let a=this._def.schema._parseSync({data:o.data,path:o.path,parent:o});if(!An(a))return O;let u=i.transform(a.value,s);if(u instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:u}}else return this._def.schema._parseAsync({data:o.data,path:o.path,parent:o}).then(a=>An(a)?Promise.resolve(i.transform(a.value,s)).then(u=>({status:r.value,value:u})):O);W.assertNever(i)}}return e.create=(t,n,r)=>new e(p({schema:t,typeName:E.ZodEffects,effect:n},V(r))),e.createWithPreprocess=(t,n,r)=>new e(p({schema:n,effect:{type:"preprocess",transform:t},typeName:E.ZodEffects},V(r))),e})();var Nn=(()=>{class e extends q{_parse(n){return this._getType(n)===D.undefined?De(void 0):this._def.innerType._parse(n)}unwrap(){return this._def.innerType}}return e.create=(t,n)=>new e(p({innerType:t,typeName:E.ZodOptional},V(n))),e})(),Ro=(()=>{class e extends q{_parse(n){return this._getType(n)===D.null?De(null):this._def.innerType._parse(n)}unwrap(){return this._def.innerType}}return e.create=(t,n)=>new e(p({innerType:t,typeName:E.ZodNullable},V(n))),e})(),up=(()=>{class e extends q{_parse(n){let{ctx:r}=this._processInputParams(n),o=r.data;return r.parsedType===D.undefined&&(o=this._def.defaultValue()),this._def.innerType._parse({data:o,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}return e.create=(t,n)=>new e(p({innerType:t,typeName:E.ZodDefault,defaultValue:typeof n.default=="function"?n.default:()=>n.default},V(n))),e})(),lp=(()=>{class e extends q{_parse(n){let{ctx:r}=this._processInputParams(n),o=g(p({},r),{common:g(p({},r.common),{issues:[]})}),i=this._def.innerType._parse({data:o.data,path:o.path,parent:p({},o)});return Co(i)?i.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Ht(o.common.issues)},input:o.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Ht(o.common.issues)},input:o.data})}}removeCatch(){return this._def.innerType}}return e.create=(t,n)=>new e(p({innerType:t,typeName:E.ZodCatch,catchValue:typeof n.catch=="function"?n.catch:()=>n.catch},V(n))),e})(),H_=(()=>{class e extends q{_parse(n){if(this._getType(n)!==D.nan){let o=this._getOrReturnCtx(n);return C(o,{code:b.invalid_type,expected:D.nan,received:o.parsedType}),O}return{status:"valid",value:n.data}}}return e.create=t=>new e(p({typeName:E.ZodNaN},V(t))),e})(),qM=Symbol("zod_brand"),ms=class extends q{_parse(t){let{ctx:n}=this._processInputParams(t),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}},gs=class e extends q{_parse(t){let{status:n,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{let i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?O:i.status==="dirty"?(n.dirty(),_r(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{let o=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?O:o.status==="dirty"?(n.dirty(),{status:"dirty",value:o.value}):this._def.out._parseSync({data:o.value,path:r.path,parent:r})}}static create(t,n){return new e({in:t,out:n,typeName:E.ZodPipeline})}},dp=(()=>{class e extends q{_parse(n){let r=this._def.innerType._parse(n),o=i=>(An(i)&&(i.value=Object.freeze(i.value)),i);return Co(r)?r.then(i=>o(i)):o(r)}unwrap(){return this._def.innerType}}return e.create=(t,n)=>new e(p({innerType:t,typeName:E.ZodReadonly},V(n))),e})();function R_(e,t){let n=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof n=="string"?{message:n}:n}function V_(e,t={},n){return e?Yc.create().superRefine((r,o)=>{let i=e(r);if(i instanceof Promise)return i.then(s=>{if(!s){let a=R_(t,r),u=a.fatal??n??!0;o.addIssue(g(p({code:"custom"},a),{fatal:u}))}});if(!i){let s=R_(t,r),a=s.fatal??n??!0;o.addIssue(g(p({code:"custom"},s),{fatal:a}))}}):Yc.create()}var GM={object:Mo.lazycreate},E=(function(e){return e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly",e})(E||{});var WM=(e,t={message:`Input not instance of ${e.name}`})=>V_(n=>n instanceof e,t),B_=tu.create,z_=Kf.create,ZM=H_.create,JM=Xf.create,q_=ep.create,QM=tp.create,YM=L_.create,KM=np.create,XM=rp.create,eA=Yc.create,tA=ps.create,nA=Ir.create,rA=j_.create,oA=hs.create,iA=Mo.create,sA=Mo.strictCreate,aA=op.create,cA=Kc.create,uA=ip.create,lA=Ao.create,dA=Xc.create,fA=F_.create,pA=$_.create,hA=eu.create,mA=sp.create,gA=ap.create,yA=nu.create,vA=cp.create,_A=ru.create,IA=No.create,wA=Nn.create,bA=Ro.create,EA=No.createWithPreprocess,SA=gs.create,TA=()=>B_().optional(),xA=()=>z_().optional(),CA=()=>q_().optional(),DA={string:e=>tu.create(g(p({},e),{coerce:!0})),number:e=>Kf.create(g(p({},e),{coerce:!0})),boolean:e=>ep.create(g(p({},e),{coerce:!0})),bigint:e=>Xf.create(g(p({},e),{coerce:!0})),date:e=>tp.create(g(p({},e),{coerce:!0}))};var MA=O;function G_(){return{}}function W_(e,t){let n={type:"array"};return e.type?._def?.typeName!==E.ZodAny&&(n.items=k(e.type._def,g(p({},t),{currentPath:[...t.currentPath,"items"]}))),e.minLength&&J(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&J(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(J(n,"minItems",e.exactLength.value,e.exactLength.message,t),J(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function Z_(e,t){let n={type:"integer",format:"int64"};if(!e.checks)return n;for(let r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?J(n,"minimum",r.value,r.message,t):J(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),J(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?J(n,"maximum",r.value,r.message,t):J(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),J(n,"maximum",r.value,r.message,t));break;case"multipleOf":J(n,"multipleOf",r.value,r.message,t);break}return n}function J_(){return{type:"boolean"}}function Q_(e,t){return k(e.type._def,t)}var Y_=(e,t)=>k(e.innerType._def,t);function fp(e,t,n){let r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((o,i)=>fp(e,t,o))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return AA(e,t)}}var AA=(e,t)=>{let n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(let r of e.checks)switch(r.kind){case"min":J(n,"minimum",r.value,r.message,t);break;case"max":J(n,"maximum",r.value,r.message,t);break}return n};function K_(e,t){return g(p({},k(e.innerType._def,t)),{default:e.defaultValue()})}function X_(e,t,n){return t.effectStrategy==="input"?k(e.schema._def,t,n):{}}function eI(e){return{type:"string",enum:[...e.values]}}var NA=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function tI(e,t){let n=[k(e.left._def,g(p({},t),{currentPath:[...t.currentPath,"allOf","0"]})),k(e.right._def,g(p({},t),{currentPath:[...t.currentPath,"allOf","1"]}))].filter(i=>!!i),r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0,o=[];return n.forEach(i=>{if(NA(i))o.push(...i.allOf),i.unevaluatedProperties===void 0&&(r=void 0);else{let a=i;if("additionalProperties"in i&&i.additionalProperties===!1){let s=i,{additionalProperties:u}=s;a=Wt(s,["additionalProperties"])}else r=void 0;o.push(a)}}),o.length?p({allOf:o},r):void 0}function nI(e,t){let n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}var pp,wr={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(pp===void 0&&(pp=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),pp),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function ou(e,t){let n={type:"string"};function r(o){return t.patternStrategy==="escape"?RA(o):o}if(e.checks)for(let o of e.checks)switch(o.kind){case"min":J(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,o.value):o.value,o.message,t);break;case"max":J(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,o.value):o.value,o.message,t);break;case"email":switch(t.emailStrategy){case"format:email":_t(n,"email",o.message,t);break;case"format:idn-email":_t(n,"idn-email",o.message,t);break;case"pattern:zod":It(n,wr.email,o.message,t);break}break;case"url":_t(n,"uri",o.message,t);break;case"uuid":_t(n,"uuid",o.message,t);break;case"regex":It(n,o.regex,o.message,t);break;case"cuid":It(n,wr.cuid,o.message,t);break;case"cuid2":It(n,wr.cuid2,o.message,t);break;case"startsWith":It(n,RegExp(`^${r(o.value)}`),o.message,t);break;case"endsWith":It(n,RegExp(`${r(o.value)}$`),o.message,t);break;case"datetime":_t(n,"date-time",o.message,t);break;case"date":_t(n,"date",o.message,t);break;case"time":_t(n,"time",o.message,t);break;case"duration":_t(n,"duration",o.message,t);break;case"length":J(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,o.value):o.value,o.message,t),J(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,o.value):o.value,o.message,t);break;case"includes":{It(n,RegExp(r(o.value)),o.message,t);break}case"ip":{o.version!=="v6"&&_t(n,"ipv4",o.message,t),o.version!=="v4"&&_t(n,"ipv6",o.message,t);break}case"emoji":It(n,wr.emoji,o.message,t);break;case"ulid":{It(n,wr.ulid,o.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{_t(n,"binary",o.message,t);break}case"contentEncoding:base64":{J(n,"contentEncoding","base64",o.message,t);break}case"pattern:zod":{It(n,wr.base64,o.message,t);break}}break}case"nanoid":It(n,wr.nanoid,o.message,t);case"toLowerCase":case"toUpperCase":case"trim":break;default:}return n}var RA=e=>Array.from(e).map(t=>/[a-zA-Z0-9]/.test(t)?t:`\\${t}`).join(""),_t=(e,t,n,r)=>{e.format||e.anyOf?.some(o=>o.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push(p({format:e.format},e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}})),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push(p({format:t},n&&r.errorMessages&&{errorMessage:{format:n}}))):J(e,"format",t,n,r)},It=(e,t,n,r)=>{e.pattern||e.allOf?.some(o=>o.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push(p({pattern:e.pattern},e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}})),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push(p({pattern:rI(t,r)},n&&r.errorMessages&&{errorMessage:{pattern:n}}))):J(e,"pattern",rI(t,r),n,r)},rI=(e,t)=>{let n=typeof e=="function"?e():e;if(!t.applyRegexFlags||!n.flags)return n.source;let r={i:n.flags.includes("i"),m:n.flags.includes("m"),s:n.flags.includes("s")},o=r.i?n.source.toLowerCase():n.source,i="",s=!1,a=!1,u=!1;for(let l=0;l<o.length;l++){if(s){i+=o[l],s=!1;continue}if(r.i){if(a){if(o[l].match(/[a-z]/)){u?(i+=o[l],i+=`${o[l-2]}-${o[l]}`.toUpperCase(),u=!1):o[l+1]==="-"&&o[l+2]?.match(/[a-z]/)?(i+=o[l],u=!0):i+=`${o[l]}${o[l].toUpperCase()}`;continue}}else if(o[l].match(/[a-z]/)){i+=`[${o[l]}${o[l].toUpperCase()}]`;continue}}if(r.m){if(o[l]==="^"){i+=`(^|(?<=[\r
]))`;continue}else if(o[l]==="$"){i+=`($|(?=[\r
]))`;continue}}if(r.s&&o[l]==="."){i+=a?`${o[l]}\r
`:`[${o[l]}\r
]`;continue}i+=o[l],o[l]==="\\"?s=!0:a&&o[l]==="]"?a=!1:!a&&o[l]==="["&&(a=!0)}try{let l=new RegExp(i)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return i};function iu(e,t){if(t.target==="openApi3"&&e.keyType?._def.typeName===E.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((r,o)=>g(p({},r),{[o]:k(e.valueType._def,g(p({},t),{currentPath:[...t.currentPath,"properties",o]}))??{}}),{}),additionalProperties:!1};let n={type:"object",additionalProperties:k(e.valueType._def,g(p({},t),{currentPath:[...t.currentPath,"additionalProperties"]}))??{}};if(t.target==="openApi3")return n;if(e.keyType?._def.typeName===E.ZodString&&e.keyType._def.checks?.length){let r=Object.entries(ou(e.keyType._def,t)).reduce((o,[i,s])=>i==="type"?o:g(p({},o),{[i]:s}),{});return g(p({},n),{propertyNames:r})}else if(e.keyType?._def.typeName===E.ZodEnum)return g(p({},n),{propertyNames:{enum:e.keyType._def.values}});return n}function oI(e,t){if(t.mapStrategy==="record")return iu(e,t);let n=k(e.keyType._def,g(p({},t),{currentPath:[...t.currentPath,"items","items","0"]}))||{},r=k(e.valueType._def,g(p({},t),{currentPath:[...t.currentPath,"items","items","1"]}))||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function iI(e){let t=e.values,r=Object.keys(e.values).filter(i=>typeof t[t[i]]!="number").map(i=>t[i]),o=Array.from(new Set(r.map(i=>typeof i)));return{type:o.length===1?o[0]==="string"?"string":"number":["string","number"],enum:r}}function sI(){return{not:{}}}function aI(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}var ys={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function uI(e,t){if(t.target==="openApi3")return cI(e,t);let n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in ys&&(!r._def.checks||!r._def.checks.length))){let r=n.reduce((o,i)=>{let s=ys[i._def.typeName];return s&&!o.includes(s)?[...o,s]:o},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){let r=n.reduce((o,i)=>{let s=typeof i._def.value;switch(s){case"string":case"number":case"boolean":return[...o,s];case"bigint":return[...o,"integer"];case"object":if(i._def.value===null)return[...o,"null"];case"symbol":case"undefined":case"function":default:return o}},[]);if(r.length===n.length){let o=r.filter((i,s,a)=>a.indexOf(i)===s);return{type:o.length>1?o:o[0],enum:n.reduce((i,s)=>i.includes(s._def.value)?i:[...i,s._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,o)=>[...r,...o._def.values.filter(i=>!r.includes(i))],[])};return cI(e,t)}var cI=(e,t)=>{let n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,o)=>k(r._def,g(p({},t),{currentPath:[...t.currentPath,"anyOf",`${o}`]}))).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function lI(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"||t.nullableStrategy==="property"?{type:ys[e.innerType._def.typeName],nullable:!0}:{type:[ys[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){let r=k(e.innerType._def,g(p({},t),{currentPath:[...t.currentPath]}));return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&g(p({},r),{nullable:!0})}let n=k(e.innerType._def,g(p({},t),{currentPath:[...t.currentPath,"anyOf","0"]}));return n&&{anyOf:[n,{type:"null"}]}}function dI(e,t){let n={type:"number"};if(!e.checks)return n;for(let r of e.checks)switch(r.kind){case"int":n.type="integer",Jf(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?J(n,"minimum",r.value,r.message,t):J(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),J(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?J(n,"maximum",r.value,r.message,t):J(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),J(n,"maximum",r.value,r.message,t));break;case"multipleOf":J(n,"multipleOf",r.value,r.message,t);break}return n}function OA(e,t){return t.removeAdditionalStrategy==="strict"?e.catchall._def.typeName==="ZodNever"?e.unknownKeys!=="strict":k(e.catchall._def,g(p({},t),{currentPath:[...t.currentPath,"additionalProperties"]}))??!0:e.catchall._def.typeName==="ZodNever"?e.unknownKeys==="passthrough":k(e.catchall._def,g(p({},t),{currentPath:[...t.currentPath,"additionalProperties"]}))??!0}function fI(e,t){let n=g(p({type:"object"},Object.entries(e.shape()).reduce((r,[o,i])=>{if(i===void 0||i._def===void 0)return r;let s=[...t.currentPath,"properties",o],a=k(i._def,g(p({},t),{currentPath:s,propertyPath:s}));if(a===void 0)return r;if(t.openaiStrictMode&&i.isOptional()&&!i.isNullable()&&typeof i._def?.defaultValue>"u")throw new Error(`Zod field at \`${s.join("/")}\` uses \`.optional()\` without \`.nullable()\` which is not supported by the API. See: https://platform.openai.com/docs/guides/structured-outputs?api-mode=responses#all-fields-must-be-required`);return{properties:g(p({},r.properties),{[o]:a}),required:i.isOptional()&&!t.openaiStrictMode?r.required:[...r.required,o]}},{properties:{},required:[]})),{additionalProperties:OA(e,t)});return n.required.length||delete n.required,n}var pI=(e,t)=>{if(t.propertyPath&&t.currentPath.slice(0,t.propertyPath.length).toString()===t.propertyPath.toString())return k(e.innerType._def,g(p({},t),{currentPath:t.currentPath}));let n=k(e.innerType._def,g(p({},t),{currentPath:[...t.currentPath,"anyOf","1"]}));return n?{anyOf:[{not:{}},n]}:{}};var hI=(e,t)=>{if(t.pipeStrategy==="input")return k(e.in._def,t);if(t.pipeStrategy==="output")return k(e.out._def,t);let n=k(e.in._def,g(p({},t),{currentPath:[...t.currentPath,"allOf","0"]})),r=k(e.out._def,g(p({},t),{currentPath:[...t.currentPath,"allOf",n?"1":"0"]}));return{allOf:[n,r].filter(o=>o!==void 0)}};function mI(e,t){return k(e.type._def,t)}function gI(e,t){let r={type:"array",uniqueItems:!0,items:k(e.valueType._def,g(p({},t),{currentPath:[...t.currentPath,"items"]}))};return e.minSize&&J(r,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&J(r,"maxItems",e.maxSize.value,e.maxSize.message,t),r}function yI(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>k(n._def,g(p({},t),{currentPath:[...t.currentPath,"items",`${r}`]}))).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:k(e.rest._def,g(p({},t),{currentPath:[...t.currentPath,"additionalItems"]}))}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>k(n._def,g(p({},t),{currentPath:[...t.currentPath,"items",`${r}`]}))).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function vI(){return{not:{}}}function _I(){return{}}var II=(e,t)=>k(e.innerType._def,t);function k(e,t,n=!1){let r=t.seen.get(e);if(t.override){let s=t.override?.(e,t,r,n);if(s!==T_)return s}if(r&&!n){let s=kA(r,t);if(s!==void 0)return"$ref"in s&&t.seenRefs.add(s.$ref),s}let o={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,o);let i=LA(e,e.typeName,t,n);return i&&jA(e,t,i),o.jsonSchema=i,i}var kA=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"extract-to-root":let n=e.path.slice(t.basePath.length+1).join("_");return n!==t.name&&t.nameStrategy==="duplicate-ref"&&(t.definitions[n]=e.def),{$ref:[...t.basePath,t.definitionPath,n].join("/")};case"relative":return{$ref:PA(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((r,o)=>t.currentPath[o]===r)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},PA=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},LA=(e,t,n,r)=>{switch(t){case E.ZodString:return ou(e,n);case E.ZodNumber:return dI(e,n);case E.ZodObject:return fI(e,n);case E.ZodBigInt:return Z_(e,n);case E.ZodBoolean:return J_();case E.ZodDate:return fp(e,n);case E.ZodUndefined:return vI();case E.ZodNull:return aI(n);case E.ZodArray:return W_(e,n);case E.ZodUnion:case E.ZodDiscriminatedUnion:return uI(e,n);case E.ZodIntersection:return tI(e,n);case E.ZodTuple:return yI(e,n);case E.ZodRecord:return iu(e,n);case E.ZodLiteral:return nI(e,n);case E.ZodEnum:return eI(e);case E.ZodNativeEnum:return iI(e);case E.ZodNullable:return lI(e,n);case E.ZodOptional:return pI(e,n);case E.ZodMap:return oI(e,n);case E.ZodSet:return gI(e,n);case E.ZodLazy:return k(e.getter()._def,n);case E.ZodPromise:return mI(e,n);case E.ZodNaN:case E.ZodNever:return sI();case E.ZodEffects:return X_(e,n,r);case E.ZodAny:return G_();case E.ZodUnknown:return _I();case E.ZodDefault:return K_(e,n);case E.ZodBranded:return Q_(e,n);case E.ZodReadonly:return II(e,n);case E.ZodCatch:return Y_(e,n);case E.ZodPipeline:return hI(e,n);case E.ZodFunction:case E.ZodVoid:case E.ZodSymbol:return;default:return(o=>{})(t)}},jA=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n);var hp=(e,t)=>{let n=D_(t),r=typeof t=="string"?t:t?.nameStrategy==="title"?void 0:t?.name,o=k(e._def,r===void 0?n:g(p({},n),{currentPath:[...n.basePath,n.definitionPath,r]}),!1)??{},i=typeof t=="object"&&t.name!==void 0&&t.nameStrategy==="title"?t.name:void 0;i!==void 0&&(o.title=i);let s=(()=>{if(C_(n.definitions))return;let u={},l=new Set;for(let d=0;d<500;d++){let f=Object.entries(n.definitions).filter(([m])=>!l.has(m));if(f.length===0)break;for(let[m,h]of f)u[m]=k(ds(h),g(p({},n),{currentPath:[...n.basePath,n.definitionPath,m]}),!0)??{},l.add(m)}return u})(),a=r===void 0?s?g(p({},o),{[n.definitionPath]:s}):o:n.nameStrategy==="duplicate-ref"?p(p({},o),s||n.seenRefs.size?{[n.definitionPath]:p(p({},s),n.seenRefs.size?{[r]:o}:void 0)}:void 0):{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,r].join("/"),[n.definitionPath]:g(p({},s),{[r]:o})};return n.target==="jsonSchema7"?a.$schema="http://json-schema.org/draft-07/schema#":n.target==="jsonSchema2019-09"&&(a.$schema="https://json-schema.org/draft/2019-09/schema#"),a};function wI(e,{parser:t,callback:n}){let r=p({},e);return Object.defineProperties(r,{$brand:{value:"auto-parseable-tool",enumerable:!1},$parseRaw:{value:t,enumerable:!1},$callback:{value:n,enumerable:!1}}),r}function bI(e){if(e.type!=="object")throw new Error(`Root schema must have type: 'object' but got type: ${e.type?`'${e.type}'`:"undefined"}`);let t=structuredClone(e);return un(t,[],t)}function mp(e){if(typeof e=="boolean")return!1;if(e.type==="null")return!0;for(let t of e.oneOf??[])if(mp(t))return!0;for(let t of e.anyOf??[])if(mp(t))return!0;return!1}function un(e,t,n){if(typeof e=="boolean")throw new TypeError(`Expected object schema but got boolean; path=${t.join("/")}`);if(!br(e))throw new TypeError(`Expected ${JSON.stringify(e)} to be an object; path=${t.join("/")}`);let r=e.$defs;if(br(r))for(let[m,h]of Object.entries(r))un(h,[...t,"$defs",m],n);let o=e.definitions;if(br(o))for(let[m,h]of Object.entries(o))un(h,[...t,"definitions",m],n);e.type==="object"&&!("additionalProperties"in e)&&(e.additionalProperties=!1);let s=e.required??[],a=e.properties;if(br(a)){for(let[m,h]of Object.entries(a))if(!mp(h)&&!s.includes(m))throw new Error(`Zod field at \`${[...t,"properties",m].join("/")}\` uses \`.optional()\` without \`.nullable()\` which is not supported by the API. See: https://platform.openai.com/docs/guides/structured-outputs?api-mode=responses#all-fields-must-be-required`);e.required=Object.keys(a),e.properties=Object.fromEntries(Object.entries(a).map(([m,h])=>[m,un(h,[...t,"properties",m],n)]))}let u=e.items;br(u)&&(e.items=un(u,[...t,"items"],n));let l=e.anyOf;Array.isArray(l)&&(e.anyOf=l.map((m,h)=>un(m,[...t,"anyOf",String(h)],n)));let d=e.allOf;if(Array.isArray(d))if(d.length===1){let m=un(d[0],[...t,"allOf","0"],n);Object.assign(e,m),delete e.allOf}else e.allOf=d.map((m,h)=>un(m,[...t,"allOf",String(h)],n));e.default===null&&delete e.default;let f=e.$ref;if(f&&$A(e,1)){if(typeof f!="string")throw new TypeError(`Received non-string $ref - ${f}; path=${t.join("/")}`);let m=FA(n,f);if(typeof m=="boolean")throw new Error(`Expected \`$ref: ${f}\` to resolve to an object schema but got boolean`);if(!br(m))throw new Error(`Expected \`$ref: ${f}\` to resolve to an object but got ${JSON.stringify(m)}`);return Object.assign(e,p(p({},m),e)),delete e.$ref,un(e,t,n)}return e}function FA(e,t){if(!t.startsWith("#/"))throw new Error(`Unexpected $ref format ${JSON.stringify(t)}; Does not start with #/`);let n=t.slice(2).split("/"),r=e;for(let o of n){if(!br(r))throw new Error(`encountered non-object entry while resolving ${t} - ${JSON.stringify(r)}`);let i=r[o];if(i===void 0)throw new Error(`Key ${o} not found while resolving ${t}`);r=i}return r}function br(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function $A(e,t){let n=0;for(let r in e)if(n++,n>t)return!0;return!1}function EI(e,t){return hp(e,{openaiStrictMode:!0,name:t.name,nameStrategy:"duplicate-ref",$refStrategy:"extract-to-root",nullableStrategy:"property"})}function SI(e){return bI(Zf(e,{target:"draft-7"}))}function TI(e){return"_zod"in e}function xI(e,t,n){return E_(g(p({type:"json_schema"},n),{name:t,strict:!0,schema:TI(e)?SI(e):EI(e,{name:t})}),r=>e.parse(JSON.parse(r)))}function CI(e){return wI(p({type:"function",name:e.name,parameters:TI(e.parameters)?SI(e.parameters):EI(e.parameters,{name:e.name}),strict:!0},e.description?{description:e.description}:void 0),{callback:e.function,parser:t=>e.parameters.parse(JSON.parse(t))})}var wt=class extends Error{state;constructor(t,n){super(t),this.state=n}},vs=class extends wt{},Oo=class extends wt{},ae=class extends wt{},B=class extends wt{},ko=class extends wt{error;constructor(t,n,r){super(t,r),this.error=n}},_s=class extends wt{error;constructor(t,n,r){super(t,r),this.error=n}},Po=class extends wt{result;constructor(t,n,r){super(t,r),this.result=n}},ln=class extends wt{result;constructor(t,n,r){super(t,r),this.result=n}};function Rn(e){if(typeof e!="object"||e===null)return;let t=e;return t._zod?.def||t._def||t.def}function Lo(e){let t=Rn(e);if(!t)return;let n=typeof t.typeName=="string"&&t.typeName||typeof t.type=="string"&&t.type;if(typeof n!="string")return;let r=n.toLowerCase();return r.startsWith("zod")?r.slice(3):r}function Qe(e){return Rn(e)?Lo(e)==="object":!1}function DI(e){return typeof e=="object"&&e!==null&&"input"in e&&typeof e.input=="string"}var UA="http://json-schema.org/draft-07/schema#",HA=new Set(["optional"]),VA=new Set(["brand","branded","catch","default","effects","pipeline","pipe","prefault","readonly","refinement","transform"]),MI={string:{type:"string"},number:{type:"number"},bigint:{type:"integer"},boolean:{type:"boolean"},date:{type:"string",format:"date-time"}};function yp(e){return typeof e=="object"&&e!==null&&e.type==="object"&&"properties"in e&&"additionalProperties"in e}function AI(e){let t=NI(e);if(t)return Array.isArray(t.required)||(t.required=[]),typeof t.additionalProperties>"u"&&(t.additionalProperties=!1),typeof t.$schema!="string"&&(t.$schema=UA),t}function NI(e){let t=eN(e);if(!t)return;let n={},r=[];for(let[o,i]of Object.entries(t)){let{schema:s,optional:a}=BA(i);if(!s)return;n[o]=s,a||r.push(o)}return{type:"object",properties:n,required:r,additionalProperties:!1}}function BA(e){let t=gp(e),n=!1;for(;HA.has(Lo(t)??"");){n=!0;let r=Rn(t),o=gp(r?.innerType);if(!o||o===t)break;t=o}return{schema:Vt(t),optional:n}}function Vt(e){if(e===void 0)return;let t=gp(e),n=Lo(t),r=Rn(t);if(n){if(n in MI)return MI[n];switch(n){case"object":return NI(t);case"array":return zA(r);case"tuple":return qA(r);case"union":return GA(r);case"intersection":return WA(r);case"literal":return KA(r);case"enum":case"nativeenum":return XA(r);case"record":return ZA(r);case"map":return JA(r);case"set":return QA(r);case"nullable":return YA(r);default:return}}}function zA(e){let t=Vt(RI(e,"element","items","type"));return t?{type:"array",items:t}:void 0}function qA(e){let t=OI(e?.items).map(r=>Vt(r)).filter(Boolean);if(!t.length)return;let n={type:"array",items:t,minItems:t.length};return e?.rest||(n.maxItems=t.length),n}function GA(e){let t=OI(e?.options??e?.schemas).map(n=>Vt(n)).filter(Boolean);return t.length?{anyOf:t}:void 0}function WA(e){let t=Vt(e?.left),n=Vt(e?.right);return t&&n?{allOf:[t,n]}:void 0}function ZA(e){let t=Vt(e?.valueType??e?.values);return t?{type:"object",additionalProperties:t}:void 0}function JA(e){let t=Vt(e?.valueType??e?.values);return t?{type:"array",items:t}:void 0}function QA(e){let t=Vt(e?.valueType);return t?{type:"array",items:t,uniqueItems:!0}:void 0}function YA(e){let t=Vt(e?.innerType??e?.type);return t?{anyOf:[t,{type:"null"}]}:void 0}function gp(e){let t=e;for(;VA.has(Lo(t)??"");){let n=Rn(t),r=n?.innerType??n?.schema??n?.base??n?.type??n?.wrapped??n?.underlying;if(!r||r===t)return t;t=r}return t}function RI(e,...t){if(e){for(let n of t)if(n in e&&e[n]!==void 0)return e[n]}}function OI(e){return Array.isArray(e)?e:e===void 0?[]:[e]}function KA(e){if(!e)return;let t=RI(e,"value","literal");if(t!==void 0)return{const:t,type:t===null?"null":typeof t}}function XA(e){if(e){if(Array.isArray(e.values))return{enum:e.values};if(Array.isArray(e.options))return{enum:e.options};if(e.values&&typeof e.values=="object")return{enum:Object.values(e.values)};if(e.enum&&typeof e.enum=="object")return{enum:Object.values(e.enum)}}}function eN(e){if(typeof e!="object"||e===null)return;let t=e;if(t.shape&&typeof t.shape=="object")return t.shape;if(typeof t.shape=="function")try{return t.shape()}catch{return}let r=Rn(t)?.shape;if(r&&typeof r=="object")return r;if(typeof r=="function")try{return r()}catch{return}}var tN=CI,nN=xI;function kI(e){return AI(e)}function Er(e){if(e=e.replace(/\s/g,"_"),e=e.replace(/[^a-zA-Z0-9]/g,"_"),e.length===0)throw new Error("Tool name cannot be empty");return e}function jo(e,t){let n=r=>JSON.parse(r);if(Qe(e)){let r=i=>{let s=kI(e);if(s)return{schema:s,parser:u=>e.parse(JSON.parse(u))};let a=i instanceof Error?` Upstream helper error: ${i.message}`:"";throw new B(`Unable to convert the provided Zod schema to JSON Schema. Ensure that the \`zod\` package is available at runtime or provide a JSON schema object instead.${a}`)},o;try{o=tN({name:t,parameters:e,function:()=>{},description:""})}catch(i){return r(i)}return yp(o.parameters)?{schema:o.parameters,parser:o.$parseRaw}:r()}else if(typeof e=="object"&&e!==null)return{schema:e,parser:n};throw new B("Input type is not a ZodObject or a valid JSON schema")}function vp(e){if(e==="text")return"text";if(Qe(e)){let t=(r,o)=>{let i=kI(e);if(i)return{type:r?.type??"json_schema",name:r?.name??"output",strict:r?.strict??!1,schema:i};let s=o instanceof Error?` Upstream helper error: ${o.message}`:"";throw new B(`Unable to convert the provided Zod schema to JSON Schema. Ensure that the \`zod\` package is available at runtime or provide a JSON schema object instead.${s}`)},n;try{n=nN(e,"output")}catch(r){return t(void 0,r)}return yp(n.schema)?{type:n.type,name:n.name,strict:n.strict||!1,schema:n.schema}:t(n)}return e}var UI=Sh(_p(),1);function cu(){return $I()}function Ip(e){let t=cu();return typeof t<"u"&&(t[e]==="true"||t[e]==="1")}var uu={get disabled(){return lu()||cu().NODE_ENV==="test"?!0:Ip("OPENAI_AGENTS_DISABLE_TRACING")}},wp={get dontLogModelData(){return Ip("OPENAI_AGENTS_DONT_LOG_MODEL_DATA")},get dontLogToolData(){return Ip("OPENAI_AGENTS_DONT_LOG_TOOL_DATA")}};var mN=wp.dontLogModelData,gN=wp.dontLogToolData;function Is(e="openai-agents"){return{namespace:e,debug:(0,UI.default)(e),error:console.error,warn:console.warn,dontLogModelData:mN,dontLogToolData:gN}}var Tr=Is("openai-agents:core"),M=Tr;function Ye(e){if(e==null)return String(e);if(HI(e))return ws(new Uint8Array(e));if(xr(e)){let t=e;return ws(new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}if(typeof e=="string")return e;if(typeof e=="object")try{return JSON.stringify(e,vN)}catch{return"[object with circular references]"}return String(e)}function HI(e){if(e instanceof ArrayBuffer)return!0;let t=globalThis.SharedArrayBuffer;return!!(t&&e instanceof t)}function xr(e){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView(e)}function Ho(e){return typeof e=="object"&&e!==null&&e.type==="Buffer"&&Array.isArray(e.data)}function bs(e){let t=globalThis.Buffer;return!!(t&&typeof t.isBuffer=="function"&&t.isBuffer(e))}function ws(e){if(e.length===0)return"[byte array (0 bytes)]";let t=Math.min(e.length,20),n=[];for(let i=0;i<t;i++)n.push(yN(e[i]));let r=e.length>20?" \u2026":"";return`[byte array ${n.join(" ")}${r} (${e.length} bytes)]`}function yN(e){return`0x${e.toString(16).padStart(2,"0")}`}function vN(e,t){if(HI(t))return ws(new Uint8Array(t));if(xr(t)){let n=t;return ws(new Uint8Array(n.buffer,n.byteOffset,n.byteLength))}return Ho(t)?ws(Uint8Array.from(t.data)):t}function _N(e,t){return`An error occurred while running the tool. Please try again. Error: ${t instanceof Error?t.toString():String(t)}`}function Cr(e){let t=e.name?Er(e.name):Er(e.execute.name),n=typeof e.errorFunction>"u"?_N:e.errorFunction;if(!t)throw new Error("Tool name cannot be empty. Either name your function or provide a name in the options.");let r=e.strict??!0;if(!r&&Qe(e.parameters))throw new B("Strict mode is required for Zod parameters");let{parser:o,schema:i}=jo(e.parameters,t);async function s(d,f,m){let[h,y]=await To(()=>o(f));if(h!==null)throw M.dontLogToolData?M.debug(`Invalid JSON input for tool ${t}`):M.debug(`Invalid JSON input for tool ${t}: ${f}`),new ae("Invalid JSON input for tool");M.dontLogToolData?M.debug(`Invoking tool ${t}`):M.debug(`Invoking tool ${t} with input ${f}`);let v=await e.execute(y,d,m),_=Ye(v);return M.dontLogToolData?M.debug(`Tool ${t} completed`):M.debug(`Tool ${t} returned: ${_}`),v}async function a(d,f,m){return s(d,f,m).catch(h=>{if(n)return dn()?.setError({message:"Error running tool (non-fatal)",data:{tool_name:t,error:h.toString()}}),n(d,h);throw h})}let u=typeof e.needsApproval=="function"?e.needsApproval:async()=>typeof e.needsApproval=="boolean"?e.needsApproval:!1,l=typeof e.isEnabled=="function"?async(d,f)=>{let m=e.isEnabled;return!!await m({runContext:d,agent:f})}:async()=>typeof e.isEnabled=="boolean"?e.isEnabled:!0;return{type:"function",name:t,description:e.description,parameters:i,strict:r,invoke:a,needsApproval:u,isEnabled:l}}var IN=Sh(_p(),1);var j9=c.object({name:c.string(),description:c.string().optional(),inputSchema:c.object({type:c.literal("object"),properties:c.record(c.string(),c.any()),required:c.array(c.string()),additionalProperties:c.boolean()})});var bp={},Ep={};var wN=({server:e,agent:t})=>e.toolFilter&&typeof e.toolFilter=="function"&&t?`${e.name}:${t.name}`:e.name;async function bN({server:e,convertSchemasToStrict:t,runContext:n,agent:r,generateMCPToolCacheKey:o}){let i=(o||wN)({server:e,agent:r,runContext:n});if(e.cacheToolsList&&bp[i])return bp[i].map(a=>Sp(a,e,t));let s=async a=>{let u=await e.listTools(),l=u;if(n&&r){let f={runContext:n,agent:r,serverName:e.name},m=[];for(let h of u){let y=e.toolFilter;if(y)if(typeof y=="function"){if(!await y(f,h)){Tr.debug(`MCP Tool (server: ${e.name}, tool: ${h.name}) is blocked by the callable filter.`);continue}}else{let v=y.allowedToolNames??[],_=y.blockedToolNames??[];if(v.length>0||_.length>0){let I=v.length>0?v.includes(h.name):!0,w=_.length>0?_.includes(h.name):!1;if(!I||w){w?Tr.debug(`MCP Tool (server: ${e.name}, tool: ${h.name}) is blocked by the static filter.`):I||Tr.debug(`MCP Tool (server: ${e.name}, tool: ${h.name}) is not allowed by the static filter.`);continue}}}m.push(h)}l=m}a&&(a.spanData.result=l.map(f=>f.name));let d=l.map(f=>Sp(f,e,t));return e.cacheToolsList&&(bp[i]=l,Ep[e.name]||(Ep[e.name]=new Set),Ep[e.name].add(i)),d};return Bt()?VI(s,{data:{server:e.name}}):s()}async function Tp(e,t,n,r=!1){let o=Array.isArray(e)?{mcpServers:e,runContext:t,agent:n,convertSchemasToStrict:r}:e,{mcpServers:i,convertSchemasToStrict:s=!1,runContext:a,agent:u,generateMCPToolCacheKey:l}=o,d=[],f=new Set;for(let m of i){let h=await bN({server:m,convertSchemasToStrict:s,runContext:a,agent:u,generateMCPToolCacheKey:l}),v=[...new Set(h.map(_=>_.name))].filter(_=>f.has(_));if(v.length>0)throw new B(`Duplicate tool names found across MCP servers: ${v.join(", ")}`);for(let _ of h)f.add(_.name),d.push(_)}return d}function Sp(e,t,n){async function r(s,a){let u={};typeof s=="string"&&s?u=JSON.parse(s):typeof s=="object"&&s!=null&&(u=s);let l=dn();l&&(l.spanData.mcp_data={server:t.name});let d=await t.callTool(e.name,u);return d.length===1?d[0]:d}let o=g(p({},e.inputSchema),{type:e.inputSchema?.type??"object",properties:e.inputSchema?.properties??{},required:e.inputSchema?.required??[],additionalProperties:e.inputSchema?.additionalProperties??!1});if(n||o.additionalProperties===!0)try{let s=EN(o);return Cr({name:e.name,description:e.description||"",parameters:s,strict:!0,execute:r})}catch(s){Tr.warn(`Error converting MCP schema to strict mode: ${s}`)}let i=g(p({},o),{additionalProperties:!0});return Cr({name:e.name,description:e.description||"",parameters:i,strict:!1,execute:r})}function EN(e){let t=g(p({},e),{additionalProperties:!1});return t.required||(t.required=[]),t}function $I(){return{}}var zt=class{#e=new EventTarget;#t=new Map;on(t,n){let r=t,o=this.#t.get(r);o||(o=new Map,this.#t.set(r,o));let i=o.get(n);i||(i=new Set,o.set(n,i));let s=a=>n(...a.detail??[]);return i.add(s),this.#e.addEventListener(r,s),this}off(t,n){let r=t,o=this.#t.get(r),i=o?.get(n);if(i?.size){for(let s of i)this.#e.removeEventListener(r,s);o?.delete(n),o?.size===0&&this.#t.delete(r)}return this}emit(t,...n){let r=new CustomEvent(t,{detail:n});return this.#e.dispatchEvent(r)}once(t,n){let r=(...o)=>{this.off(t,r),n(...o)};return this.on(t,r),this}};var fu=()=>typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)}),BI=class{constructor(){}pipeTo(t,n){}pipeThrough(t,n){}},zI=globalThis.ReadableStream,G9=globalThis.ReadableStreamDefaultController,qI=globalThis.TransformStream,du=class{context=null;constructor(){}run(t,n){return this.context=t,n()}getStore(){return this.context}enterWith(t){this.context=t}};function lu(){return!0}function GI(){return!1}var xp=class{constructor(){}setTimeout(t,n){let r=setTimeout(t,n);return r.ref=typeof r.ref=="function"?r.ref:()=>r,r.unref=typeof r.unref=="function"?r.unref:()=>r,r.hasRef=typeof r.hasRef=="function"?r.hasRef:()=>!0,r.refresh=typeof r.refresh=="function"?r.refresh:()=>r,r}clearTimeout(t){window.clearTimeout(t)}},WI=new xp;var Dr=class{on(t,n){return this.eventEmitter.on(t,n),this.eventEmitter}off(t,n){return this.eventEmitter.off(t,n),this.eventEmitter}emit(t,...n){return this.eventEmitter.emit(t,...n)}once(t,n){return this.eventEmitter.once(t,n),this.eventEmitter}},Es=class extends Dr{eventEmitter=new zt},pu=class extends Dr{eventEmitter=new zt};var ZI="OPENAI_DEFAULT_MODEL";function Mr(e){return e.startsWith("gpt-5-chat")?!1:e.startsWith("gpt-5")}function Ss(){return Mr(Cp())}function Cp(){return cu()[ZI]?.toLowerCase()??"gpt-4.1"}function Dp(e){let t=e??Cp();return Mr(t)?{reasoning:{effort:"low"},text:{verbosity:"low"}}:{}}function xs(e){return JSON.stringify({assistant:e.name})}function CN(e){return`transfer_to_${Er(e.name)}`}function DN(e){return`Handoff to the ${e.name} agent to handle the request. ${e.handoffDescription??""}`}var Ts=class{toolName;toolDescription;inputJsonSchema={type:"object",properties:{},required:[],additionalProperties:!1};strictJsonSchema=!0;onInvokeHandoff;agentName;inputFilter;agent;getHandoffAsFunctionTool(){return{type:"function",name:this.toolName,description:this.toolDescription,parameters:this.inputJsonSchema,strict:this.strictJsonSchema}}isEnabled=async()=>!0;constructor(t,n){this.agentName=t.name,this.onInvokeHandoff=n,this.toolName=CN(t),this.toolDescription=DN(t),this.agent=t}};function hu(e,t={}){let n,r=!!t.onHandoff,o=!!t.inputType;if(!(r===o))throw new B("You must provide either both `onHandoff` and `inputType` or neither.");async function s(u,l){if(n){if(!l)throw rt({message:`Handoff function expected non empty input but got: ${l}`,data:{details:"input is empty"}}),new ae("Handoff function expected non empty input");try{let d=await n(l);t.onHandoff&&await t.onHandoff(u,d)}catch(d){throw rt({message:"Invalid JSON provided",data:{}}),M.dontLogToolData||M.error(`Invalid JSON when parsing: ${l}. Error: ${d}`),new ae("Invalid JSON provided")}}else await t.onHandoff?.(u);return e}let a=new Ts(e,s);if(typeof t.isEnabled=="function"){let u=t.isEnabled;a.isEnabled=async({runContext:l,agent:d})=>!!await u({runContext:l,agent:d})}else typeof t.isEnabled=="boolean"&&(a.isEnabled=async()=>t.isEnabled);if(t.inputType){let u=jo(t.inputType,a.toolName);a.inputJsonSchema=u.schema,a.strictJsonSchema=!0,n=u.parser}return t.toolNameOverride&&(a.toolName=t.toolNameOverride),t.toolDescriptionOverride&&(a.toolDescription=t.toolDescriptionOverride),t.inputFilter&&(a.inputFilter=t.inputFilter),a}function Mp(e){return e instanceof Ts?e:hu(e)}function Ap(e){if(e.type!=="message"||e.role!=="assistant")return;let t=e.content[e.content.length-1];if(t.type==="output_text")return t.text}function JI(e){return e.output.length===0?"":Ap(e.output[e.output.length-1])||""}var Np=new WeakMap;function MN(e,t){e&&Np.set(e,t)}function QI(e){let t=Np.get(e);return t&&Np.delete(e),t}var AN=c.object({input:c.string()}),bt=(()=>{class e extends Es{static create(n){return new e(g(p({},n),{handoffs:n.handoffs,outputType:n.outputType,handoffOutputTypeWarningEnabled:!1}))}static DEFAULT_MODEL_PLACEHOLDER="";name;instructions;prompt;handoffDescription;handoffs;model;modelSettings;tools;mcpServers;inputGuardrails;outputGuardrails;outputType="text";toolUseBehavior;resetToolChoice;_toolsExplicitlyConfigured;constructor(n){if(super(),typeof n.name!="string"||n.name.trim()==="")throw new B("Agent must have a name.");if(this.name=n.name,this.instructions=n.instructions??e.DEFAULT_MODEL_PLACEHOLDER,this.prompt=n.prompt,this.handoffDescription=n.handoffDescription??"",this.handoffs=n.handoffs??[],this.model=n.model??"",this.modelSettings=n.modelSettings??Dp(),this.tools=n.tools??[],this._toolsExplicitlyConfigured=n.tools!==void 0,this.mcpServers=n.mcpServers??[],this.inputGuardrails=n.inputGuardrails??[],this.outputGuardrails=n.outputGuardrails??[],n.outputType&&(this.outputType=n.outputType),this.toolUseBehavior=n.toolUseBehavior??"run_llm_again",this.resetToolChoice=n.resetToolChoice??!0,n.model!==void 0&&Ss()&&(typeof n.model!="string"||!Mr(n.model))&&n.modelSettings===void 0&&(this.modelSettings={}),(n.handoffOutputTypeWarningEnabled===void 0||n.handoffOutputTypeWarningEnabled)&&this.handoffs&&this.outputType){let r=new Set([JSON.stringify(this.outputType)]);for(let o of this.handoffs)"outputType"in o&&o.outputType?r.add(JSON.stringify(o.outputType)):"agent"in o&&o.agent.outputType&&r.add(JSON.stringify(o.agent.outputType));r.size>1&&M.warn(`[Agent] Warning: Handoff agents have different output types: ${Array.from(r).join(", ")}. You can make it type-safe by using Agent.create({ ... }) method instead.`)}}get outputSchemaName(){if(this.outputType==="text")return"text";if(Qe(this.outputType))return"ZodOutput";if(typeof this.outputType=="object")return this.outputType.name;throw new Error(`Unknown output type: ${this.outputType}`)}clone(n){return new e(p(p({},this),n))}asTool(n){let{toolName:r,toolDescription:o,customOutputExtractor:i,needsApproval:s,runConfig:a,runOptions:u,isEnabled:l}=n;return Cr({name:r??Er(this.name),description:o??"",parameters:AN,strict:!0,needsApproval:s,isEnabled:l,execute:async(d,f,m)=>{if(!DI(d))throw new ae("Agent tool called with invalid input");let v=await new Cs(a??{}).run(this,d.input,p({context:f},u??{})),_=typeof this.toolUseBehavior=="object"&&this.toolUseBehavior!==null&&"stopAtToolNames"in this.toolUseBehavior;typeof i!="function"&&_&&M.debug(`You're passing the agent (name: ${this.name}) with toolUseBehavior.stopAtToolNames configured as a tool to a different agent; this may not work as you expect. You may want to have a wrapper function tool to consistently return the final output.`);let I=typeof i=="function"?await i(v):JI(v.rawResponses[v.rawResponses.length-1]);return m?.toolCall&&MN(m.toolCall,v),I}})}async getSystemPrompt(n){return typeof this.instructions=="function"?await this.instructions(n,this):this.instructions}async getPrompt(n){return typeof this.prompt=="function"?await this.prompt(n,this):this.prompt}async getMcpTools(n){return this.mcpServers.length>0?Tp({mcpServers:this.mcpServers,runContext:n,agent:this,convertSchemasToStrict:!1}):[]}async getAllTools(n){let r=await this.getMcpTools(n),o=[];for(let i of this.tools){if(i.type==="function"){let s=i.isEnabled;if(!(typeof s=="function"?await s(n,this):typeof s=="boolean"?s:!0))continue}o.push(i)}return[...r,...o]}hasExplicitToolConfig(){return this._toolsExplicitlyConfigured}async getEnabledHandoffs(n){let r=this.handoffs?.map(i=>Mp(i))??[],o=[];for(let i of r)await i.isEnabled({runContext:n,agent:this})&&o.push(i);return o}processFinalOutput(n){if(this.outputType==="text")return n;if(typeof this.outputType=="object"){let r=JSON.parse(n);return Qe(this.outputType)?this.outputType.parse(r):r}throw new Error(`Unknown output type: ${this.outputType}`)}toJSON(){return{name:this.name}}}return e})();function Rp({name:e,execute:t,runInParallel:n=!0}){return{type:"input",name:e,runInParallel:n,guardrailFunction:t,async run(r){return{guardrail:{type:"input",name:e},output:await t(r)}}}}function Vo({name:e,execute:t}){return{type:"output",name:e,guardrailFunction:t,async run(n){return{guardrail:{type:"output",name:e},agent:n.agent,agentOutput:n.agentOutput,output:await t(n)}}}}var YI;function KI(){if(typeof YI>"u")throw new Error("No default model provider set. Make sure to set a provider using setDefaultModelProvider before calling getDefaultModelProvider or pass an explicit provider.");return YI}var pe=c.object({providerData:c.record(c.string(),c.any()).optional()}),Et=pe.extend({id:c.string().optional()}),NN=pe.extend({type:c.literal("refusal"),refusal:c.string()}),RN=pe.extend({type:c.literal("output_text"),text:c.string()}),Op=pe.extend({type:c.literal("input_text"),text:c.string()}),ON=pe.extend({type:c.literal("reasoning_text"),text:c.string()}),XI=pe.extend({type:c.literal("input_image"),image:c.string().or(c.object({id:c.string().describe("OpenAI file ID")})).describe("Either base64 encoded image data, a data URL, or an object with a file ID.").optional(),detail:c.string().optional()}),ew=pe.extend({type:c.literal("input_file"),file:c.string().describe("Either base64 encoded file data or a publicly accessible file URL").or(c.object({id:c.string().describe("OpenAI file ID")})).or(c.object({url:c.string().describe("Publicly accessible file URL")})).describe("Contents of the file or an object with a file ID.").optional(),filename:c.string().optional()}),tw=pe.extend({type:c.literal("audio"),audio:c.string().or(c.object({id:c.string()})).describe("Base64 encoded audio data or file id"),format:c.string().nullable().optional(),transcript:c.string().nullable().optional()}),kN=pe.extend({type:c.literal("image"),image:c.string().describe("Base64 encoded image data")}),PN=pe.extend({type:c.literal("text"),text:c.string()}),LN=c.object({data:c.union([c.string(),c.instanceof(Uint8Array)]).describe("Base64 image data, or raw bytes that will be base64 encoded automatically."),mediaType:c.string().optional()}),jN=c.object({url:c.string().describe("Publicly accessible URL pointing to the image content")}),FN=c.object({fileId:c.string().describe("OpenAI file ID referencing uploaded image content")}),$N=c.union([LN,jN,FN]).describe("Inline image data or references to uploaded content."),UN=c.object({data:c.union([c.string(),c.instanceof(Uint8Array)]).describe("Base64 encoded file data, or raw bytes that will be encoded automatically."),mediaType:c.string().describe("IANA media type describing the file contents"),filename:c.string().describe("Filename associated with the inline data")}),HN=c.object({url:c.string().describe("Publicly accessible URL for the file content"),filename:c.string().optional()}),VN=c.object({id:c.string().describe("OpenAI file ID referencing uploaded content"),filename:c.string().optional()}),BN=c.union([c.string().describe("Existing data URL or base64 string"),UN,HN,VN]).describe("Inline data (with metadata) or references pointing to file contents."),zN=(...e)=>c.string(),qN=pe.extend({type:c.literal("image"),image:c.string().or($N).optional(),detail:zN("low","high","auto").optional()}),GN=pe.extend({type:c.literal("file"),file:BN}),WN=pe.extend({type:c.literal("computer_screenshot"),data:c.string().describe("Base64 encoded image data or URL")}),ZN=c.discriminatedUnion("type",[c.object({type:c.literal("screenshot")}),c.object({type:c.literal("click"),x:c.number(),y:c.number(),button:c.enum(["left","right","wheel","back","forward"])}),c.object({type:c.literal("double_click"),x:c.number(),y:c.number()}),c.object({type:c.literal("scroll"),x:c.number(),y:c.number(),scroll_x:c.number(),scroll_y:c.number()}),c.object({type:c.literal("type"),text:c.string()}),c.object({type:c.literal("wait")}),c.object({type:c.literal("move"),x:c.number(),y:c.number()}),c.object({type:c.literal("keypress"),keys:c.array(c.string())}),c.object({type:c.literal("drag"),path:c.array(c.object({x:c.number(),y:c.number()}))})]),JN=c.discriminatedUnion("type",[RN,NN,tw,kN]),kp=Et.extend({type:c.literal("message").optional()}),Ds=kp.extend({role:c.literal("assistant"),status:c.enum(["in_progress","completed","incomplete"]),content:c.array(JN)}),QN=c.discriminatedUnion("type",[Op,XI,ew,tw]),nw=kp.extend({role:c.literal("user"),content:c.array(QN).or(c.string())}),rw=kp.extend({role:c.literal("system"),content:c.string()}),S6=c.discriminatedUnion("role",[rw,Ds,nw]),Bo=Et.extend({type:c.literal("hosted_tool_call"),name:c.string().describe("The name of the hosted tool"),arguments:c.string().describe("The arguments of the hosted tool call").optional(),status:c.string().optional(),output:c.string().optional()}),zo=Et.extend({type:c.literal("function_call"),callId:c.string().describe("The ID of the tool call"),name:c.string().describe("The name of the function"),status:c.enum(["in_progress","completed","incomplete"]).optional(),arguments:c.string()}),YN=c.discriminatedUnion("type",[PN,qN,GN]),KN=c.discriminatedUnion("type",[Op,XI,ew]),Ms=Et.extend({type:c.literal("function_call_result"),name:c.string().describe("The name of the tool"),callId:c.string().describe("The ID of the tool call"),status:c.enum(["in_progress","completed","incomplete"]),output:c.union([c.string(),YN,c.array(KN)]).describe("Output returned by the tool call. Supports plain strings, legacy ToolOutput items, or structured input_* items.")}),Pp=Et.extend({type:c.literal("computer_call"),callId:c.string().describe("The ID of the computer call"),status:c.enum(["in_progress","completed","incomplete"]),action:ZN}),XN=Et.extend({type:c.literal("computer_call_result"),callId:c.string().describe("The ID of the computer call"),output:WN}),eR=c.object({commands:c.array(c.string()),timeoutMs:c.number().int().min(0).optional(),maxOutputLength:c.number().int().min(0).optional()}),As=Et.extend({type:c.literal("shell_call"),callId:c.string(),status:c.enum(["in_progress","completed","incomplete"]).optional(),action:eR}),tR=c.discriminatedUnion("type",[c.object({type:c.literal("timeout")}),c.object({type:c.literal("exit"),exitCode:c.number().int().nullable()})]),nR=c.object({stdout:c.string(),stderr:c.string(),outcome:tR}).passthrough(),ow=Et.extend({type:c.literal("shell_call_output"),callId:c.string(),maxOutputLength:c.number().optional(),output:c.array(nR)}),rR=c.object({type:c.literal("create_file"),path:c.string(),diff:c.string()}),oR=c.object({type:c.literal("update_file"),path:c.string(),diff:c.string()}),iR=c.object({type:c.literal("delete_file"),path:c.string()}),sR=c.discriminatedUnion("type",[rR,oR,iR]),Ns=Et.extend({type:c.literal("apply_patch_call"),callId:c.string(),status:c.enum(["in_progress","completed"]),operation:sR}),iw=Et.extend({type:c.literal("apply_patch_call_output"),callId:c.string(),status:c.enum(["completed","failed"]),output:c.string().optional()}),sw=c.discriminatedUnion("type",[Pp,As,Ns,zo,Bo]),mu=pe.extend({id:c.string().optional(),type:c.literal("reasoning"),content:c.array(Op),rawContent:c.array(ON).optional()}),aw=Et.extend({type:c.literal("unknown")}),gu=c.discriminatedUnion("type",[Ds,Bo,zo,Pp,As,Ns,Ms,ow,iw,mu,aw]),cw=c.union([nw,Ds,rw,Bo,zo,Pp,As,Ns,Ms,XN,ow,iw,mu,aw]),uw=c.object({inputTokens:c.number(),outputTokens:c.number(),totalTokens:c.number(),inputTokensDetails:c.record(c.string(),c.number()).optional(),outputTokensDetails:c.record(c.string(),c.number()).optional()}),lw=c.object({requests:c.number().optional(),inputTokens:c.number(),outputTokens:c.number(),totalTokens:c.number(),inputTokensDetails:c.union([c.record(c.string(),c.number()),c.array(c.record(c.string(),c.number()))]).optional(),outputTokensDetails:c.union([c.record(c.string(),c.number()),c.array(c.record(c.string(),c.number()))]).optional(),requestUsageEntries:c.array(uw).optional()}),Lp=pe.extend({type:c.literal("output_text_delta"),delta:c.string()}),aR=pe.extend({type:c.literal("response_started")}),jp=pe.extend({type:c.literal("response_done"),response:pe.extend({id:c.string(),usage:lw,output:c.array(gu)})}),cR=pe.extend({type:c.literal("model"),event:c.any().describe("The event from the model")}),T6=c.discriminatedUnion("type",[Lp,jp,aR,cR]);var On=class{inputTokens;outputTokens;totalTokens;inputTokensDetails;outputTokensDetails;constructor(t){this.inputTokens=t?.inputTokens??t?.input_tokens??0,this.outputTokens=t?.outputTokens??t?.output_tokens??0,this.totalTokens=t?.totalTokens??t?.total_tokens??this.inputTokens+this.outputTokens;let n=t?.inputTokensDetails??t?.input_tokens_details;this.inputTokensDetails=n||{};let r=t?.outputTokensDetails??t?.output_tokens_details;this.outputTokensDetails=r||{}}},St=class{requests;inputTokens;outputTokens;totalTokens;inputTokensDetails=[];outputTokensDetails=[];requestUsageEntries;constructor(t){if(typeof t>"u")this.requests=0,this.inputTokens=0,this.outputTokens=0,this.totalTokens=0,this.inputTokensDetails=[],this.outputTokensDetails=[],this.requestUsageEntries=void 0;else{this.requests=t?.requests??1,this.inputTokens=t?.inputTokens??t?.input_tokens??0,this.outputTokens=t?.outputTokens??t?.output_tokens??0,this.totalTokens=t?.totalTokens??t?.total_tokens??this.inputTokens+this.outputTokens;let n=t?.inputTokensDetails??t?.input_tokens_details;Array.isArray(n)?this.inputTokensDetails=n:this.inputTokensDetails=n?[n]:[];let r=t?.outputTokensDetails??t?.output_tokens_details;Array.isArray(r)?this.outputTokensDetails=r:this.outputTokensDetails=r?[r]:[];let o=t?.requestUsageEntries??t?.request_usage_entries,i=Array.isArray(o)?o.map(s=>s instanceof On?s:new On(s)):void 0;this.requestUsageEntries=i&&i.length>0?i:void 0}}add(t){this.requests+=t.requests??0,this.inputTokens+=t.inputTokens??0,this.outputTokens+=t.outputTokens??0,this.totalTokens+=t.totalTokens??0,t.inputTokensDetails&&this.inputTokensDetails.push(...t.inputTokensDetails),t.outputTokensDetails&&this.outputTokensDetails.push(...t.outputTokensDetails),Array.isArray(t.requestUsageEntries)&&t.requestUsageEntries.length>0?(this.requestUsageEntries??=[],this.requestUsageEntries.push(...t.requestUsageEntries.map(n=>n instanceof On?n:new On(n)))):t.requests===1&&t.totalTokens>0&&(this.requestUsageEntries??=[],this.requestUsageEntries.push(new On({inputTokens:t.inputTokens,outputTokens:t.outputTokens,totalTokens:t.totalTokens,inputTokensDetails:t.inputTokensDetails?.[0],outputTokensDetails:t.outputTokensDetails?.[0]})))}};var ot=class{context;usage;#e;constructor(t={}){this.context=t,this.usage=new St,this.#e=new Map}_rebuildApprovals(t){this.#e=new Map(Object.entries(t))}isToolApproved(t){let{toolName:n,callId:r}=t,o=this.#e.get(n);if(o?.approved===!0&&o.rejected===!0)return M.warn("Tool is permanently approved and rejected at the same time. Approval takes precedence"),!0;if(o?.approved===!0)return!0;if(o?.rejected===!0)return!1;let i=Array.isArray(o?.approved)?o.approved.includes(r):!1,s=Array.isArray(o?.rejected)?o.rejected.includes(r):!1;if(i&&s)return M.warn(`Tool call ${r} is both approved and rejected at the same time. Approval takes precedence`),!0;if(i)return!0;if(s)return!1}approveTool(t,{alwaysApprove:n=!1}={}){let r=t.toolName??t.rawItem.name;if(n){this.#e.set(r,{approved:!0,rejected:[]});return}let o=this.#e.get(r)??{approved:[],rejected:[]};if(Array.isArray(o.approved)){let i="callId"in t.rawItem?t.rawItem.callId:t.rawItem.id;o.approved.push(i)}this.#e.set(r,o)}rejectTool(t,{alwaysReject:n=!1}={}){let r=t.toolName??t.rawItem.name;if(n){this.#e.set(r,{approved:!1,rejected:!0});return}let o=this.#e.get(r)??{approved:[],rejected:[]};if(Array.isArray(o.rejected)){let i="callId"in t.rawItem?t.rawItem.callId:t.rawItem.id;o.rejected.push(i)}this.#e.set(r,o)}toJSON(){return{context:this.context,usage:this.usage,approvals:Object.fromEntries(this.#e.entries())}}};function fw(e){return e.type==="function"?{type:"function",name:e.name,description:e.description,parameters:e.parameters,strict:e.strict}:e.type==="computer"?{type:"computer",name:e.name,environment:e.computer.environment,dimensions:e.computer.dimensions}:e.type==="shell"?{type:"shell",name:e.name}:e.type==="apply_patch"?{type:"apply_patch",name:e.name}:{type:"hosted_tool",name:e.name,providerData:e.providerData}}function pw(e){return{toolName:e.toolName,toolDescription:e.toolDescription,inputJsonSchema:e.inputJsonSchema,strictJsonSchema:e.strictJsonSchema}}var fn=class{type="base_item";rawItem;toJSON(){return{type:this.type,rawItem:this.rawItem}}},pn=class extends fn{rawItem;agent;type="message_output_item";constructor(t,n){super(),this.rawItem=t,this.agent=n}toJSON(){return g(p({},super.toJSON()),{agent:this.agent.toJSON()})}get content(){let t="";for(let n of this.rawItem.content)n.type==="output_text"&&(t+=n.text);return t}},Be=class extends fn{rawItem;agent;type="tool_call_item";constructor(t,n){super(),this.rawItem=t,this.agent=n}toJSON(){return g(p({},super.toJSON()),{agent:this.agent.toJSON()})}},Pe=class extends fn{rawItem;agent;output;type="tool_call_output_item";constructor(t,n,r){super(),this.rawItem=t,this.agent=n,this.output=r}toJSON(){return g(p({},super.toJSON()),{agent:this.agent.toJSON(),output:Ye(this.output)})}},kn=class extends fn{rawItem;agent;type="reasoning_item";constructor(t,n){super(),this.rawItem=t,this.agent=n}toJSON(){return g(p({},super.toJSON()),{agent:this.agent.toJSON()})}},Pn=class extends fn{rawItem;agent;type="handoff_call_item";constructor(t,n){super(),this.rawItem=t,this.agent=n}toJSON(){return g(p({},super.toJSON()),{agent:this.agent.toJSON()})}},Ln=class extends fn{rawItem;sourceAgent;targetAgent;type="handoff_output_item";constructor(t,n,r){super(),this.rawItem=t,this.sourceAgent=n,this.targetAgent=r}toJSON(){return g(p({},super.toJSON()),{sourceAgent:this.sourceAgent.toJSON(),targetAgent:this.targetAgent.toJSON()})}},ue=class extends fn{rawItem;agent;toolName;type="tool_approval_item";constructor(t,n,r){super(),this.rawItem=t,this.agent=n,this.toolName=r,this.toolName=r??t.name}get name(){return this.toolName??this.rawItem.name}get arguments(){return"arguments"in this.rawItem?this.rawItem.arguments:void 0}toJSON(){return g(p({},super.toJSON()),{agent:this.agent.toJSON(),toolName:this.toolName})}};function Tt(e){return async(t,...n)=>Rs(async()=>{let r=e(...n);qo(r);try{return r.start(),await t(r)}catch(o){throw r.setError({message:o.message,data:o.data}),o}finally{r.end(),jn()}})}function uR(e,t){return e={},le().createSpan(g(p({},e),{data:p({type:"response"},e.data)}),t)}var j6=Tt(uR);function Fp(e,t){return le().createSpan(g(p({},e),{data:p({type:"agent",name:e?.data?.name??"Agent"},e?.data)}),t)}var F6=Tt(Fp);function lR(e,t){return le().createSpan(g(p({},e),{data:p({type:"function",input:e?.data?.input??"",output:e?.data?.output??""},e?.data)}),t)}var $p=Tt(lR);function dR(e,t){return le().createSpan(g(p({},e),{data:p({type:"handoff"},e?.data)}),t)}var hw=Tt(dR);function fR(e,t){return le().createSpan(g(p({},e),{data:p({type:"generation"},e?.data)}),t)}var $6=Tt(fR);function pR(e,t){return le().createSpan(g(p({},e),{data:p({type:"custom",data:{}},e?.data)}),t)}var U6=Tt(pR);function hR(e,t){return le().createSpan(g(p({},e),{data:p({type:"guardrail",triggered:!1},e?.data)}),t)}var Up=Tt(hR);function mR(e,t){return le().createSpan(g(p({},e),{data:p({type:"transcription"},e.data)}),t)}var H6=Tt(mR);function gR(e,t){return le().createSpan(g(p({},e),{data:p({type:"speech"},e.data)}),t)}var V6=Tt(gR);function yR(e,t){return le().createSpan(g(p({},e),{data:p({type:"speech_group"},e?.data)}),t)}var B6=Tt(yR);function vR(e,t){return le().createSpan(g(p({},e),{data:p({type:"mcp_tools"},e?.data)}),t)}var VI=Tt(vR);function Le(e){if(e.length===0)return"";let t=typeof globalThis<"u"&&globalThis.Buffer?globalThis.Buffer:void 0;if(t)return t.from(e).toString("base64");let n="";for(let s=0;s<e.length;s+=1)n+=String.fromCharCode(e[s]);if(typeof globalThis.btoa=="function")return globalThis.btoa(n);let r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o="",i=0;for(;i<n.length;){let s=n.charCodeAt(i++),a=n.charCodeAt(i++),u=n.charCodeAt(i++),l=s>>2,d=(s&3)<<4|a>>4,f=isNaN(a)?64:(a&15)<<2|u>>6,m=isNaN(u)?64:u&63;o+=r.charAt(l)+r.charAt(d)+r.charAt(f)+r.charAt(m)}return o}var Os=class{data;type="raw_model_stream_event";constructor(t){this.data=t}},ks=class{name;item;type="run_item_stream_event";constructor(t,n){this.name=t,this.item=n}},Ps=class{agent;type="agent_updated_stream_event";constructor(t){this.agent=t}};function IR(e){if(!e||typeof e!="object"||!("rawItem"in e))return!1;let t=e.rawItem;if(!t||typeof t!="object")return!1;let n=t.type;return n==="function_call"||n==="hosted_tool_call"}function mw(e){let t=e.rawItem;if(!t)return;if(t.type==="function_call"&&t.callId)return`function_call:${t.callId}`;if("callId"in t&&t.callId)return`${t.type}:${t.callId}`;let n="id"in t?t.id:void 0;if(n)return`${t.type}:${n}`;let r=typeof t.providerData=="object"&&t.providerData?t.providerData:void 0;if(r?.id)return`${t.type}:provider:${r.id}`;let o="agent"in e&&e.agent?e.agent.name:"";try{return`${o}:${t.type}:${JSON.stringify(t)}`}catch{return`${o}:${t.type}`}}function wR(e){try{if(e instanceof c.ZodError){let t=e.issues[0];if(t){let n=Array.isArray(t.path)?t.path:[],r=n.length>0?n.map(i=>String(i)).join("."):"(root)",o=gw(t.message??"");return`Invalid output type: final assistant output failed schema validation at "${r}" (${o}).`}return"Invalid output type: final assistant output failed schema validation."}if(e instanceof Error&&e.message)return`Invalid output type: ${gw(e.message)}`}catch{}return"Invalid output type: final assistant output did not match the expected schema."}function gw(e,t=160){let n=e.trim();return n?n.length<=t?n:`${n.slice(0,t-3)}...`:"Schema validation failed."}function Bp(e,t,n,r){let o=[],i=[],s=[],a=[],u=[],l=[],d=[],f=[],m=new Map(r.map(w=>[w.toolName,w])),h=new Map(n.filter(w=>w.type==="function").map(w=>[w.name,w])),y=n.find(w=>w.type==="computer"),v=n.find(w=>w.type==="shell"),_=n.find(w=>w.type==="apply_patch"),I=new Map(n.filter(w=>w.type==="hosted_tool"&&w.providerData?.type==="mcp").map(w=>w).map(w=>[w.providerData.server_label,w]));for(let w of e.output){if(w.type==="message")w.role==="assistant"&&o.push(new pn(w,t));else if(w.type==="hosted_tool_call"){o.push(new Be(w,t));let S=w.name;if(f.push(S),w.providerData?.type==="mcp_approval_request"||w.name==="mcp_approval_request"){let T=w.providerData,R=T.server_label,Y=I.get(R);if(typeof Y>"u"){let he=`MCP server (${R}) not found in Agent (${t.name})`;throw rt({message:he,data:{mcp_server_label:R}}),new ae(he)}let ie=new ue({type:"hosted_tool_call",name:T.name,id:T.id,status:"in_progress",providerData:T},t);d.push({requestItem:ie,mcpTool:Y}),Y.providerData.on_approval||o.push(ie)}}else if(w.type==="reasoning")o.push(new kn(w,t));else if(w.type==="computer_call"){if(o.push(new Be(w,t)),f.push("computer_use"),!y)throw rt({message:"Model produced computer action without a computer tool.",data:{agent_name:t.name}}),new ae("Model produced computer action without a computer tool.");a.push({toolCall:w,computer:y})}else if(w.type==="shell_call"){if(o.push(new Be(w,t)),f.push("shell"),!v)throw rt({message:"Model produced shell action without a shell tool.",data:{agent_name:t.name}}),new ae("Model produced shell action without a shell tool.");u.push({toolCall:w,shell:v})}else if(w.type==="apply_patch_call"){if(o.push(new Be(w,t)),f.push("apply_patch"),!_)throw rt({message:"Model produced apply_patch action without an apply_patch tool.",data:{agent_name:t.name}}),new ae("Model produced apply_patch action without an apply_patch tool.");l.push({toolCall:w,applyPatch:_})}if(w.type!=="function_call")continue;f.push(w.name);let N=m.get(w.name);if(N)o.push(new Pn(w,t)),i.push({toolCall:w,handoff:N});else{let S=h.get(w.name);if(!S)throw rt({message:`Tool ${w.name} not found in agent ${t.name}.`,data:{tool_name:w.name,agent_name:t.name}}),new ae(`Tool ${w.name} not found in agent ${t.name}.`);o.push(new Be(w,t)),s.push({toolCall:w,tool:S})}}return{newItems:o,handoffs:i,functions:s,computerActions:a,shellActions:u,applyPatchActions:l,mcpApprovalRequests:d,toolsUsed:f,hasToolsOrApprovalsToRun(){return i.length>0||s.length>0||d.length>0||a.length>0||u.length>0||l.length>0}}}var bw=c.discriminatedUnion("type",[c.object({type:c.literal("next_step_handoff"),newAgent:c.any()}),c.object({type:c.literal("next_step_final_output"),output:c.string()}),c.object({type:c.literal("next_step_run_again")}),c.object({type:c.literal("next_step_interruption"),data:c.record(c.string(),c.any())})]),it=class{originalInput;modelResponse;preStepItems;newStepItems;nextStep;constructor(t,n,r,o,i){this.originalInput=t,this.modelResponse=n,this.preStepItems=r,this.newStepItems=o,this.nextStep=i}get generatedItems(){return this.preStepItems.concat(this.newStepItems)}};function Ew(e,t,n){return e.resetToolChoice&&t.hasUsedTools(e)?g(p({},n),{toolChoice:void 0}):n}async function zp(e,t,n,r,o,i,s){let a=n.filter(T=>T instanceof ue&&"callId"in T.rawItem&&T.rawItem.type==="function_call").map(T=>T.rawItem.callId),u=s.getInterruptions().filter(IR);if(u.length>0){let T=new Set;for(let R of u){let Y=mw(R);Y&&T.add(Y)}if(T.size>0){let R=0;for(let Y=n.length-1;Y>=0;Y--){let ie=n[Y];if(!(ie instanceof ue))continue;let he=mw(ie);if(he&&T.has(he)&&(R++,T.delete(he),T.size===0))break}R>0&&(s._currentTurnPersistedItemCount=Math.max(0,s._currentTurnPersistedItemCount-R))}}let l=o.functions.filter(T=>a.includes(T.toolCall.callId)),d=await Tw(e,l,i,s),f=o.computerActions.length>0?await Cw(e,o.computerActions,i,s._context):[],m=new Set(n),h=[],y=new Set,v=T=>{m.has(T)||y.has(T)||(h.push(T),y.add(T))};for(let T of d)v(T.runItem);for(let T of f)v(T);let _=o.mcpApprovalRequests.filter(T=>T.requestItem.type==="tool_approval_item"&&T.requestItem.rawItem.type==="hosted_tool_call"&&T.requestItem.rawItem.providerData?.type==="mcp_approval_request"),I=new Set,w=new Set;for(let T of _){let R=T.requestItem.rawItem;if(R.type!=="hosted_tool_call")continue;let Y=R.id,ie=s._context.isToolApproved({toolName:R.name,callId:Y});if(typeof ie<"u"){let he={approve:ie,approval_request_id:Y,reason:void 0},$r=new Be({type:"hosted_tool_call",name:"mcp_approval_response",providerData:he},e);v($r)}else I.add(T.requestItem),w.add(Y),d.push({type:"hosted_mcp_tool_approval",tool:T.mcpTool,runItem:T.requestItem}),v(T.requestItem)}let N=n.filter(T=>{if(!(T instanceof ue))return!0;if(T.rawItem.type==="hosted_tool_call"&&T.rawItem.providerData?.type==="mcp_approval_request"){if(I.has(T))return!0;let R=T.rawItem.id;return R?w.has(R):!1}return!1}),S=await Sw({agent:e,runner:i,state:s,functionResults:d,originalInput:t,newResponse:r,preStepItems:N,newItems:h});return S||new it(t,r,N,h,{type:"next_step_run_again"})}async function qp(e,t,n,r,o,i,s){let a=n,u=new Set(n),l=[],d=S=>{u.has(S)||(l.push(S),u.add(S))};for(let S of o.newItems)d(S);let[f,m,h,y]=await Promise.all([Tw(e,o.functions,i,s),Cw(e,o.computerActions,i,s._context),xR(e,o.shellActions,i,s._context),CR(e,o.applyPatchActions,i,s._context)]);for(let S of f)d(S.runItem);for(let S of m)d(S);for(let S of h)d(S);for(let S of y)d(S);if(o.mcpApprovalRequests.length>0)for(let S of o.mcpApprovalRequests){let T=S.mcpTool.providerData,R=S.requestItem.rawItem.providerData;if(T.on_approval){let Y=await T.on_approval(s._context,S.requestItem),ie={approve:Y.approve,approval_request_id:R.id,reason:Y.reason};l.push(new Be({type:"hosted_tool_call",name:"mcp_approval_response",providerData:ie},e))}else{l.push(S.requestItem);let Y={type:"hosted_mcp_tool_approval",tool:S.mcpTool,runItem:new ue({type:"hosted_tool_call",name:R.name,id:R.id,arguments:R.arguments,status:"in_progress",providerData:R},e)};f.push(Y)}}if(o.handoffs.length>0)return await DR(e,t,a,l,r,o.handoffs,i,s._context);let v=await Sw({agent:e,runner:i,state:s,functionResults:f,originalInput:t,newResponse:r,preStepItems:a,newItems:l});if(v)return v;if((o.functions?.length??0)>0||(o.computerActions?.length??0)>0||(o.shellActions?.length??0)>0||(o.applyPatchActions?.length??0)>0||(o.mcpApprovalRequests?.length??0)>0||(o.handoffs?.length??0)>0)return new it(t,r,a,l,{type:"next_step_run_again"});let I=l.filter(S=>S instanceof pn),w=I.length>0?Ap(I[I.length-1].rawItem):void 0;if(typeof w>"u")return new it(t,r,a,l,{type:"next_step_run_again"});if(!f.some(S=>S.runItem instanceof ue)){if(e.outputType==="text")return new it(t,r,a,l,{type:"next_step_final_output",output:w});if(e.outputType!=="text"&&w){let{parser:S}=jo(e.outputType,"final_output"),[T]=await To(()=>S(w));if(T){let R=wR(T);throw rt({message:R,data:{error:String(T)}}),new ae(R)}return new it(t,r,a,l,{type:"next_step_final_output",output:w})}}return new it(t,r,a,l,{type:"next_step_run_again"})}async function Sw({agent:e,runner:t,state:n,functionResults:r,originalInput:o,newResponse:i,preStepItems:s,newItems:a}){let u=await MR(e,r,n);return u.isFinalOutput?(t.emit("agent_end",n._context,e,u.finalOutput),e.emit("agent_end",n._context,u.finalOutput),new it(o,i,s,a,{type:"next_step_final_output",output:u.finalOutput})):u.isInterrupted?new it(o,i,s,a,{type:"next_step_interruption",data:{interruptions:u.interruptions}}):null}function _u(e,t){let n=PR(t);if(n){let r=n.map(LR);return{type:"function_call_result",name:e.name,callId:e.callId,status:"completed",output:r}}return{type:"function_call_result",name:e.name,callId:e.callId,status:"completed",output:{type:"text",text:Ye(t)}}}function bR(e){let t=e.file;if(typeof t=="string"&&t.length>0)return t;let n=ER(t);if(n)return n;let r=SR(e);return r||null}function ER(e){if(!Ar(e))return null;if("data"in e&&e.data!==void 0){let n=e.data,r=typeof n=="string"&&n.length>0,o=n instanceof Uint8Array&&n.length>0;return!r&&!o||!_e(e.mediaType)||!_e(e.filename)?null:{data:typeof n=="string"?n:new Uint8Array(n),mediaType:e.mediaType,filename:e.filename}}if(_e(e.url)){let n={url:e.url};return _e(e.filename)&&(n.filename=e.filename),n}let t=_e(e.id)&&e.id||_e(e.fileId)&&e.fileId;if(t){let n={id:t};return _e(e.filename)&&(n.filename=e.filename),n}return null}function SR(e){let t=typeof e.filename=="string"&&e.filename.length>0?e.filename:void 0,n=typeof e.mediaType=="string"&&e.mediaType.length>0?e.mediaType:void 0;if(typeof e.fileData=="string"&&e.fileData.length>0)return!n||!t?null:{data:e.fileData,mediaType:n,filename:t};if(e.fileData instanceof Uint8Array&&e.fileData.length>0)return!n||!t?null:{data:new Uint8Array(e.fileData),mediaType:n,filename:t};if(typeof e.fileUrl=="string"&&e.fileUrl.length>0){let r={url:e.fileUrl};return t&&(r.filename=t),r}if(typeof e.fileId=="string"&&e.fileId.length>0){let r={id:e.fileId};return t&&(r.filename=t),r}return null}function Ar(e){return typeof e=="object"&&e!==null}function _e(e){return typeof e=="string"&&e.length>0}function yu(e,t){if(typeof e=="string")return t&&!e.startsWith("data:")?Go(e,t):e;let n=Le(e);return Go(n,t)}function Go(e,t){return t?`data:${t};base64,${e}`:e}async function Tw(e,t,n,r){async function o(i){let s=i.toolCall.arguments;if(i.tool.parameters&&(Qe(i.tool.parameters)?s=i.tool.parameters.parse(s):s=JSON.parse(s)),await i.tool.needsApproval(r._context,s,i.toolCall.callId)){let u=r._context.isToolApproved({toolName:i.tool.name,callId:i.toolCall.callId});if(u===!1)return $p(async l=>{let d="Tool execution was not approved.";return l.setError({message:d,data:{tool_name:i.tool.name,error:`Tool execution for ${i.toolCall.callId} was manually rejected by user.`}}),l.spanData.output=d,{type:"function_output",tool:i.tool,output:d,runItem:new Pe(_u(i.toolCall,d),e,d)}},{data:{name:i.tool.name}});if(u!==!0)return{type:"function_approval",tool:i.tool,runItem:new ue(i.toolCall,e)}}return $p(async u=>{n.config.traceIncludeSensitiveData&&(u.spanData.input=i.toolCall.arguments);try{n.emit("agent_tool_start",r._context,e,i.tool,{toolCall:i.toolCall}),e.emit("agent_tool_start",r._context,i.tool,{toolCall:i.toolCall});let l=await i.tool.invoke(r._context,i.toolCall.arguments,{toolCall:i.toolCall}),d=Ye(l);n.emit("agent_tool_end",r._context,e,i.tool,d,{toolCall:i.toolCall}),e.emit("agent_tool_end",r._context,i.tool,d,{toolCall:i.toolCall}),n.config.traceIncludeSensitiveData&&(u.spanData.output=d);let f={type:"function_output",tool:i.tool,output:l,runItem:new Pe(_u(i.toolCall,l),e,l)},m=QI(i.toolCall);if(m){f.agentRunResult=m;let h=m.interruptions;h.length>0&&(f.interruptions=h)}return f}catch(l){throw u.setError({message:"Error running tool",data:{tool_name:i.tool.name,error:String(l)}}),l}},{data:{name:i.tool.name}})}try{return await Promise.all(t.map(o))}catch(i){throw new _s(`Failed to run function tools: ${i}`,i,r)}}async function TR(e,t){let n=t.action,r;switch(n.type){case"click":await e.click(n.x,n.y,n.button);break;case"double_click":await e.doubleClick(n.x,n.y);break;case"drag":await e.drag(n.path.map(o=>[o.x,o.y]));break;case"keypress":await e.keypress(n.keys);break;case"move":await e.move(n.x,n.y);break;case"screenshot":r=await e.screenshot();break;case"scroll":await e.scroll(n.x,n.y,n.scroll_x,n.scroll_y);break;case"type":await e.type(n.text);break;case"wait":await e.wait();break;default:break}if(typeof r<"u"||typeof e.screenshot=="function"&&(r=await e.screenshot(),typeof r<"u"))return r;throw new Error("Computer does not implement screenshot()")}function xw(e){if(e instanceof Error)return e.message||e.toString();try{return JSON.stringify(e)}catch{return String(e)}}async function xR(e,t,n,r,o=void 0){let i=o??M,s=[];for(let a of t){let u=a.shell,l=a.toolCall,d=new ue(l,e,u.name);if(await u.needsApproval(r,l.action,l.callId)){if(u.onApproval){let I=await u.onApproval(r,d);I.approve===!0?r.approveTool(d):I.approve===!1&&r.rejectTool(d)}let _=r.isToolApproved({toolName:u.name,callId:l.callId});if(_===!1){let I="Tool execution was not approved.",w={stdout:"",stderr:I,outcome:{type:"exit",exitCode:null}};s.push(new Pe({type:"shell_call_output",callId:l.callId,output:[w]},e,I));continue}if(_!==!0){s.push(d);continue}}n.emit("agent_tool_start",r,e,u,{toolCall:l}),typeof e.emit=="function"&&e.emit("agent_tool_start",r,u,{toolCall:l});let m,h={},y;try{let _=await u.shell.run(l.action);m=_.output??[],_.providerData&&Object.assign(h,_.providerData),typeof _.maxOutputLength=="number"&&(y=_.maxOutputLength)}catch(_){m=[{stdout:"",stderr:xw(_),outcome:{type:"exit",exitCode:null}}],i.error("Failed to execute shell action:",_)}m=m??[],n.emit("agent_tool_end",r,e,u,JSON.stringify(m),{toolCall:l}),typeof e.emit=="function"&&e.emit("agent_tool_end",r,u,JSON.stringify(m),{toolCall:l});let v={type:"shell_call_output",callId:l.callId,output:m??[]};typeof y=="number"&&(v.maxOutputLength=y),Object.keys(h).length>0&&(v.providerData=h),s.push(new Pe(v,e,v.output))}return s}async function CR(e,t,n,r,o=void 0){let i=o??M,s=[];for(let a of t){let u=a.applyPatch,l=a.toolCall,d=new ue(l,e,u.name);if(await u.needsApproval(r,l.operation,l.callId)){if(u.onApproval){let _=await u.onApproval(r,d);_.approve===!0?r.approveTool(d):_.approve===!1&&r.rejectTool(d)}let v=r.isToolApproved({toolName:u.name,callId:l.callId});if(v===!1){let _="Tool execution was not approved.";s.push(new Pe({type:"apply_patch_call_output",callId:l.callId,status:"failed",output:_},e,_));continue}if(v!==!0){s.push(d);continue}}n.emit("agent_tool_start",r,e,u,{toolCall:l}),typeof e.emit=="function"&&e.emit("agent_tool_start",r,u,{toolCall:l});let m="completed",h="";try{let v;switch(l.operation.type){case"create_file":v=await u.editor.createFile(l.operation);break;case"update_file":v=await u.editor.updateFile(l.operation);break;case"delete_file":v=await u.editor.deleteFile(l.operation);break;default:throw new Error("Unsupported apply_patch operation")}v&&typeof v.status=="string"&&(m=v.status),v&&typeof v.output=="string"&&(h=v.output)}catch(v){m="failed",h=xw(v),i.error("Failed to execute apply_patch operation:",v)}n.emit("agent_tool_end",r,e,u,h,{toolCall:l}),typeof e.emit=="function"&&e.emit("agent_tool_end",r,u,h,{toolCall:l});let y={type:"apply_patch_call_output",callId:l.callId,status:m};h&&(y.output=h),s.push(new Pe(y,e,h))}return s}async function Cw(e,t,n,r,o=void 0){let i=o??M,s=[];for(let a of t){let u=a.computer.computer,l=a.toolCall;n.emit("agent_tool_start",r,e,a.computer,{toolCall:l}),typeof e.emit=="function"&&e.emit("agent_tool_start",r,a.computer,{toolCall:l});let d;try{d=await TR(u,l)}catch(h){i.error("Failed to execute computer action:",h),d=""}n.emit("agent_tool_end",r,e,a.computer,d,{toolCall:l}),typeof e.emit=="function"&&e.emit("agent_tool_end",r,a.computer,d,{toolCall:l});let f=d?`data:image/png;base64,${d}`:"",m={type:"computer_call_result",callId:l.callId,output:{type:"computer_screenshot",data:f}};s.push(new Pe(m,e,f))}return s}async function DR(e,t,n,r,o,i,s,a){if(r=[...r],i.length===0)return M.warn("Incorrectly called executeHandoffCalls with no handoffs. This should not happen. Moving on."),new it(t,o,n,r,{type:"next_step_run_again"});if(i.length>1){let l="Multiple handoffs detected, ignoring this one.";for(let d=1;d<i.length;d++)r.push(new Pe(_u(i[d].toolCall,l),e,l))}let u=i[0];return hw(async l=>{let d=u.handoff,f=await d.onInvokeHandoff(a,u.toolCall.arguments);if(l.spanData.to_agent=f.name,i.length>1){let h=i.map(y=>y.handoff.agentName);l.setError({message:"Multiple handoffs requested",data:{requested_agents:h}})}r.push(new Ln(_u(u.toolCall,xs(f)),e,f)),s.emit("agent_handoff",a,e,f),e.emit("agent_handoff",a,f);let m=d.inputFilter??s.config.handoffInputFilter;if(m){M.debug("Filtering inputs for handoff"),typeof m!="function"&&l.setError({message:"Invalid input filter",data:{details:"not callable"}});let h={inputHistory:Array.isArray(t)?[...t]:t,preHandoffItems:[...n],newItems:[...r],runContext:a},y=m(h);t=y.inputHistory,n=y.preHandoffItems,r=y.newItems}return new it(t,o,n,r,{type:"next_step_handoff",newAgent:f})},{data:{from_agent:e.name}})}var vu={isFinalOutput:!1,isInterrupted:void 0};async function MR(e,t,n){if(t.length===0)return vu;let r=[];for(let s of t)if(s.runItem instanceof ue&&r.push(s.runItem),s.type==="function_output"){if(Array.isArray(s.interruptions))r.push(...s.interruptions);else if(s.agentRunResult){let a=s.agentRunResult.interruptions;a.length>0&&r.push(...a)}}if(r.length>0)return{isFinalOutput:!1,isInterrupted:!0,interruptions:r};if(e.toolUseBehavior==="run_llm_again")return vu;let o=t[0];if(e.toolUseBehavior==="stop_on_first_tool")return o?.type==="function_output"?{isFinalOutput:!0,isInterrupted:void 0,finalOutput:Ye(o.output)}:vu;let i=e.toolUseBehavior;if(typeof i=="object"){let s=t.find(a=>i.stopAtToolNames.includes(a.tool.name));return s?.type==="function_output"?{isFinalOutput:!0,isInterrupted:void 0,finalOutput:Ye(s.output)}:vu}if(typeof i=="function")return i(n._context,t);throw new B(`Invalid toolUseBehavior: ${i}`,n)}function AR(e){if(e instanceof pn)return"message_output_created";if(e instanceof Pn)return"handoff_requested";if(e instanceof Ln)return"handoff_occurred";if(e instanceof Be)return"tool_called";if(e instanceof Pe)return"tool_output";if(e instanceof kn)return"reasoning_item_created";if(e instanceof ue)return"tool_approval_requested"}function Dw(e,t){let n=AR(t);if(!n){M.warn("Unknown item type: ",t);return}e._addItem(new ks(n,t))}function Mw(e,t){for(let n of t)Dw(e,n)}function Gp(e,t,n){let r=n?.skipItems;for(let o of t.newStepItems)r?.has(o)||Dw(e,o)}var Ls=class{#e=new Map;addToolUse(t,n){this.#e.set(t,n)}hasUsedTools(t){return this.#e.has(t)}toJSON(){return Object.fromEntries(Array.from(this.#e.entries()).map(([t,n])=>[t.name,n]))}};function NR(e){return typeof e=="string"?[{type:"message",role:"user",content:e}]:[...e]}function Aw(e){return e.filter(t=>t.type!=="tool_approval_item").map(t=>t.rawItem)}function Wp(e){return e.map(t=>Hp(Vp(t)))}function Hp(e,t={}){if(e==null)return e;let n=RR(e);if(n)return OR(n,t.mediaType);if(Array.isArray(e))return e.map(s=>Hp(s,t));if(!Nw(e))return e;let r=e,o={},i=typeof r.mediaType=="string"&&r.mediaType.length>0?r.mediaType:t.mediaType;for(let[s,a]of Object.entries(r)){let u=s==="data"||s==="fileData"?{mediaType:i}:t;o[s]=Hp(a,u)}return o}function RR(e){if(e instanceof ArrayBuffer)return new Uint8Array(e);if(xr(e)){let t=e;return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}if(bs(e)){let t=e;return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}if(Ho(e))return Uint8Array.from(e.data)}function OR(e,t){let n=Le(e);return`data:${t&&!t.startsWith("data:")?t:"text/plain"};base64,${n}`}function Nw(e){if(typeof e!="object"||e===null)return!1;let t=Object.getPrototypeOf(e);return t===Object.prototype||t===null}function Vp(e){if(e==null)return e;if(Array.isArray(e))return e.map(i=>Vp(i));if(!Nw(e))return e;let t=e,n={},o=typeof t.type=="string"&&t.type.length>0&&kR(t.type);for(let[i,s]of Object.entries(t))o&&i==="id"||(n[i]=Vp(s));return n}function kR(e){switch(e){case"function_call":case"function_call_result":return!0;default:return!1}}async function Rw(e,t,n){if(!e)return;let r=t??[],o=n.state,i=o._currentTurnPersistedItemCount??0,s=n.newItems.slice(i);process.env.OPENAI_AGENTS__DEBUG_SAVE_SESSION&&console.debug("saveToSession:newRunItems",s.map(d=>d.type));let a=Aw(s),u=[...r,...a];if(u.length===0){o._currentTurnPersistedItemCount=i+s.length;return}let l=Wp(u);await e.addItems(l),o._currentTurnPersistedItemCount=i+s.length}async function Ow(e,t){if(!e||!t||t.length===0)return;let n=Wp(t);await e.addItems(n)}async function Zp(e,t){if(!e)return;let n=t.state,r=n._currentTurnPersistedItemCount??0,o=t.newItems.slice(r),i=Aw(o);if(i.length===0){n._currentTurnPersistedItemCount=r+o.length;return}let s=Wp(i);await e.addItems(s),n._currentTurnPersistedItemCount=r+o.length}async function kw(e,t,n,r){if(!t)return{preparedInput:e,sessionItems:void 0};let o=r?.includeHistoryInPreparedInput??!0,i=r?.preserveDroppedNewItems??!1,s=await t.getItems(),a=Array.isArray(e)?[...e]:NR(e);if(!n)return{preparedInput:o?[...s,...a]:a,sessionItems:a};let u=s.slice(),l=a.slice(),d=await n(s,a);if(!Array.isArray(d))throw new B("Session input callback must return an array of AgentInputItem objects.");let f=vw(u),m=vw(l),h=_w(u),y=_w(l),v=[];for(let I of d){let w=Jp(I);if(Iw(y,w,I)){ww(m,w),v.push(I);continue}if(Iw(h,w,I)){ww(f,w);continue}let N=f.get(w)??0;if(N>0){f.set(w,N-1);continue}let S=m.get(w)??0;if(S>0){m.set(w,S-1),v.push(I);continue}v.push(I)}return{preparedInput:o?d:v.length>0?v:i?l:[],sessionItems:v}}function PR(e){if(Array.isArray(e)){let n=[];for(let r of e){let o=yw(r);if(!o)return null;n.push(o)}return n}let t=yw(e);return t?[t]:null}function yw(e){if(!Ar(e))return null;let t=e.type;if(t==="text"&&typeof e.text=="string"){let n={type:"text",text:e.text};return Ar(e.providerData)&&(n.providerData=e.providerData),n}if(t==="image"){let n={type:"image"},r,o,i=_e(e.mediaType)?e.mediaType:void 0,s=e.image;if(typeof s=="string"&&s.length>0)r=s;else if(Ar(s)){let a=s,u=_e(a.mediaType)?a.mediaType:i;if(_e(a.url)?r=a.url:(_e(a.data)||a.data instanceof Uint8Array&&a.data.length>0)&&(r=yu(a.data,u)),!r){let l=_e(a.fileId)&&a.fileId||_e(a.id)&&a.id||void 0;l&&(o=l)}}if(!r&&typeof e.imageUrl=="string"&&e.imageUrl.length>0&&(r=e.imageUrl),!o&&typeof e.fileId=="string"&&e.fileId.length>0&&(o=e.fileId),!r&&typeof e.data=="string"&&e.data.length>0?r=i?yu(e.data,i):e.data:!r&&e.data instanceof Uint8Array&&e.data.length>0&&(r=yu(e.data,i)),typeof e.detail=="string"&&e.detail.length>0&&(n.detail=e.detail),r)n.image=r;else if(o)n.image={fileId:o};else return null;return Ar(e.providerData)&&(n.providerData=e.providerData),n}if(t==="file"){let n=bR(e);if(!n)return null;let r={type:"file",file:n};return Ar(e.providerData)&&(r.providerData=e.providerData),r}return null}function LR(e){if(e.type==="text"){let n={type:"input_text",text:e.text};return e.providerData&&(n.providerData=e.providerData),n}if(e.type==="image"){let n={type:"input_image"};if(typeof e.detail=="string"&&e.detail.length>0&&(n.detail=e.detail),typeof e.image=="string"&&e.image.length>0)n.image=e.image;else if(Ar(e.image)){let r=e.image,o=_e(r.mediaType)?r.mediaType:void 0;if(_e(r.url))n.image=r.url;else if(_e(r.data))n.image=o&&!r.data.startsWith("data:")?Go(r.data,o):r.data;else if(r.data instanceof Uint8Array&&r.data.length>0){let i=Le(r.data);n.image=Go(i,o)}else{let i=_e(r.fileId)&&r.fileId||_e(r.id)&&r.id||void 0;i&&(n.image={id:i})}}return e.providerData&&(n.providerData=e.providerData),n}if(e.type==="file"){let n={type:"input_file"},r=e.file;if(typeof r=="string")n.file=r;else if(r&&typeof r=="object"){let o=r;if("data"in o&&o.data){let i=o.mediaType??"text/plain";if(typeof o.data=="string")n.file=Go(o.data,i);else{let s=Le(o.data);n.file=Go(s,i)}}else if(typeof o.url=="string"&&o.url.length>0)n.file={url:o.url};else{let i=typeof o.id=="string"&&o.id.length>0&&o.id||(typeof o.fileId=="string"&&o.fileId.length>0?o.fileId:void 0);i&&(n.file={id:i})}typeof o.filename=="string"&&o.filename.length>0&&(n.filename=o.filename)}return e.providerData&&(n.providerData=e.providerData),n}return e}function vw(e){let t=new Map;for(let n of e){let r=Jp(n);t.set(r,(t.get(r)??0)+1)}return t}function _w(e){let t=new Map;for(let n of e){let r=Jp(n),o=t.get(r);o?o.push(n):t.set(r,[n])}return t}function Iw(e,t,n){let r=e.get(t);if(!r||r.length===0)return!1;let o=r.findIndex(i=>i===n);return o===-1?!1:(r.splice(o,1),r.length===0&&e.delete(t),!0)}function ww(e,t){let n=(e.get(t)??0)-1;n<=0?e.delete(t):e.set(t,n)}function Jp(e){return JSON.stringify(e,jR)}function jR(e,t){if(t instanceof ArrayBuffer)return{__type:"ArrayBuffer",data:Le(new Uint8Array(t))};if(xr(t)){let n=t;return{__type:n.constructor.name,data:Le(new Uint8Array(n.buffer,n.byteOffset,n.byteLength))}}if(bs(t)){let n=t;return{__type:"Buffer",data:Le(new Uint8Array(n.buffer,n.byteOffset,n.byteLength))}}return Ho(t)?{__type:"Buffer",data:Le(Uint8Array.from(t.data))}:t}var Iu="1.0",FR=c.literal(Iu),qt=c.object({name:c.string()}),$R=c.object({object:c.literal("trace.span"),id:c.string(),trace_id:c.string(),parent_id:c.string().nullable(),started_at:c.string().nullable(),ended_at:c.string().nullable(),error:c.object({message:c.string(),data:c.record(c.string(),c.any()).optional()}).nullable(),span_data:c.record(c.string(),c.any())}),Fw=$R.extend({previous_span:c.lazy(()=>Fw).optional()}),UR=c.object({inputTokens:c.number(),outputTokens:c.number(),totalTokens:c.number(),inputTokensDetails:c.record(c.string(),c.number()).optional(),outputTokensDetails:c.record(c.string(),c.number()).optional()}),$w=c.object({requests:c.number(),inputTokens:c.number(),outputTokens:c.number(),totalTokens:c.number(),inputTokensDetails:c.array(c.record(c.string(),c.number())).optional(),outputTokensDetails:c.array(c.record(c.string(),c.number())).optional(),requestUsageEntries:c.array(UR).optional()}),Pw=c.object({usage:$w,output:c.array(gu),responseId:c.string().optional(),providerData:c.record(c.string(),c.any()).optional()}),Uw=c.discriminatedUnion("type",[c.object({type:c.literal("message_output_item"),rawItem:Ds,agent:qt}),c.object({type:c.literal("tool_call_item"),rawItem:sw.or(Bo),agent:qt}),c.object({type:c.literal("tool_call_output_item"),rawItem:Ms,agent:qt,output:c.string()}),c.object({type:c.literal("reasoning_item"),rawItem:mu,agent:qt}),c.object({type:c.literal("handoff_call_item"),rawItem:zo,agent:qt}),c.object({type:c.literal("handoff_output_item"),rawItem:Ms,sourceAgent:qt,targetAgent:qt}),c.object({type:c.literal("tool_approval_item"),rawItem:zo.or(Bo).or(As).or(Ns),agent:qt,toolName:c.string().optional()})]),HR=c.object({object:c.literal("trace"),id:c.string(),workflow_name:c.string(),group_id:c.string().nullable(),metadata:c.record(c.string(),c.any())}),VR=c.object({newItems:c.array(Uw),toolsUsed:c.array(c.string()),handoffs:c.array(c.object({toolCall:c.any(),handoff:c.any()})),functions:c.array(c.object({toolCall:c.any(),tool:c.any()})),computerActions:c.array(c.object({toolCall:c.any(),computer:c.any()})),shellActions:c.array(c.object({toolCall:c.any(),shell:c.any()})).optional(),applyPatchActions:c.array(c.object({toolCall:c.any(),applyPatch:c.any()})).optional(),mcpApprovalRequests:c.array(c.object({requestItem:c.object({rawItem:c.object({type:c.literal("hosted_tool_call"),name:c.string(),arguments:c.string().optional(),status:c.string().optional(),output:c.string().optional(),providerData:c.record(c.string(),c.any()).nullable().optional()})}),mcpTool:c.object({type:c.literal("hosted_tool"),name:c.literal("hosted_mcp"),providerData:c.record(c.string(),c.any())})})).optional()}),Hw=c.object({tripwireTriggered:c.boolean(),outputInfo:c.any()}),BR=c.object({guardrail:c.object({type:c.literal("input"),name:c.string()}),output:Hw}),zR=c.object({guardrail:c.object({type:c.literal("output"),name:c.string()}),agentOutput:c.any(),agent:qt,output:Hw}),Lw=c.object({$schemaVersion:FR,currentTurn:c.number(),currentAgent:qt,originalInput:c.string().or(c.array(cw)),modelResponses:c.array(Pw),context:c.object({usage:$w,approvals:c.record(c.string(),c.object({approved:c.array(c.string()).or(c.boolean()),rejected:c.array(c.string()).or(c.boolean())})),context:c.record(c.string(),c.any())}),toolUseTracker:c.record(c.string(),c.array(c.string())),maxTurns:c.number(),currentAgentSpan:Fw.nullable().optional(),noActiveAgentRun:c.boolean(),inputGuardrailResults:c.array(BR),outputGuardrailResults:c.array(zR),currentStep:bw.optional(),lastModelResponse:Pw.optional(),generatedItems:c.array(Uw),lastProcessedResponse:VR.optional(),currentTurnPersistedItemCount:c.number().int().min(0).optional(),trace:HR.nullable()}),xt=class e{_currentTurn=0;_currentAgent;_originalInput;_modelResponses;_currentAgentSpan;_context;get usage(){return this._context.usage}_toolUseTracker;_generatedItems;_currentTurnPersistedItemCount;_maxTurns;_noActiveAgentRun=!0;_lastTurnResponse;_inputGuardrailResults;_outputGuardrailResults;_currentStep=void 0;_lastProcessedResponse=void 0;_trace=null;constructor(t,n,r,o){this._context=t,this._originalInput=structuredClone(n),this._modelResponses=[],this._currentAgentSpan=void 0,this._currentAgent=r,this._toolUseTracker=new Ls,this._generatedItems=[],this._currentTurnPersistedItemCount=0,this._maxTurns=o,this._inputGuardrailResults=[],this._outputGuardrailResults=[],this._trace=Bt()}get history(){return Fn(this._originalInput,this._generatedItems)}getInterruptions(){return this._currentStep?.type!=="next_step_interruption"?[]:this._currentStep.data.interruptions}approve(t,n={alwaysApprove:!1}){this._context.approveTool(t,n)}reject(t,n={alwaysReject:!1}){this._context.rejectTool(t,n)}toJSON(){let t={$schemaVersion:Iu,currentTurn:this._currentTurn,currentAgent:{name:this._currentAgent.name},originalInput:this._originalInput,modelResponses:this._modelResponses.map(r=>({usage:p({requests:r.usage.requests,inputTokens:r.usage.inputTokens,outputTokens:r.usage.outputTokens,totalTokens:r.usage.totalTokens,inputTokensDetails:r.usage.inputTokensDetails,outputTokensDetails:r.usage.outputTokensDetails},r.usage.requestUsageEntries&&r.usage.requestUsageEntries.length>0?{requestUsageEntries:r.usage.requestUsageEntries.map(o=>({inputTokens:o.inputTokens,outputTokens:o.outputTokens,totalTokens:o.totalTokens,inputTokensDetails:o.inputTokensDetails,outputTokensDetails:o.outputTokensDetails}))}:{}),output:r.output,responseId:r.responseId,providerData:r.providerData})),context:this._context.toJSON(),toolUseTracker:this._toolUseTracker.toJSON(),maxTurns:this._maxTurns,currentAgentSpan:this._currentAgentSpan?.toJSON(),noActiveAgentRun:this._noActiveAgentRun,inputGuardrailResults:this._inputGuardrailResults,outputGuardrailResults:this._outputGuardrailResults.map(r=>g(p({},r),{agent:r.agent.toJSON()})),currentStep:this._currentStep,lastModelResponse:this._lastTurnResponse,generatedItems:this._generatedItems.map(r=>r.toJSON()),currentTurnPersistedItemCount:this._currentTurnPersistedItemCount,lastProcessedResponse:this._lastProcessedResponse,trace:this._trace?this._trace.toJSON():null},n=Lw.safeParse(t);if(!n.success)throw new vs(`Failed to serialize run state. ${n.error.message}`);return n.data}toString(){return JSON.stringify(this.toJSON())}static async fromString(t,n){let[r,o]=await To(()=>JSON.parse(n));if(r)throw new B(`Failed to parse run state. ${r instanceof Error?r.message:String(r)}`);let i=o.$schemaVersion;if(!i)throw new B("Run state is missing schema version");if(i!==Iu)throw new B(`Run state schema version ${i} is not supported. Please use version ${Iu}`);let s=Lw.parse(JSON.parse(n)),a=qR(t),u=new ot(s.context.context);u._rebuildApprovals(s.context.approvals);let l=a.get(s.currentAgent.name);if(!l)throw new B(`Agent ${s.currentAgent.name} not found`);let d=new e(u,"",l,s.maxTurns);d._currentTurn=s.currentTurn,d._toolUseTracker=new Ls;for(let[f,m]of Object.entries(s.toolUseTracker))d._toolUseTracker.addToolUse(a.get(f),m);if(s.currentAgentSpan){s.trace||M.warn("Trace is not set, skipping tracing setup");let f=le().createTrace({traceId:s.trace?.id,name:s.trace?.workflow_name,groupId:s.trace?.group_id??void 0,metadata:s.trace?.metadata});d._currentAgentSpan=Vw(f,s.currentAgentSpan),d._trace=f}return d._noActiveAgentRun=s.noActiveAgentRun,d._inputGuardrailResults=s.inputGuardrailResults,d._outputGuardrailResults=s.outputGuardrailResults.map(f=>g(p({},f),{agent:a.get(f.agent.name)})),d._currentStep=s.currentStep,d._originalInput=s.originalInput,d._modelResponses=s.modelResponses.map(jw),d._lastTurnResponse=s.lastModelResponse?jw(s.lastModelResponse):void 0,d._generatedItems=s.generatedItems.map(f=>Bw(f,a)),d._currentTurnPersistedItemCount=s.currentTurnPersistedItemCount??0,d._lastProcessedResponse=s.lastProcessedResponse?await GR(a,d._currentAgent,d._context,s.lastProcessedResponse):void 0,s.currentStep?.type==="next_step_handoff"&&(d._currentStep={type:"next_step_handoff",newAgent:a.get(s.currentStep.newAgent.name)}),d}};function qR(e){let t=new Map,n=[e];for(;n.length>0;){let r=n.shift();if(!t.has(r.name)){t.set(r.name,r);for(let o of r.handoffs)o instanceof bt?t.has(o.name)||n.push(o):o.agent&&(t.has(o.agent.name)||n.push(o.agent))}}return t}function Vw(e,t){let n=t.span_data,r=t.previous_span?Vw(e,t.previous_span):void 0,o=le().createSpan({spanId:t.id,traceId:t.trace_id,parentId:t.parent_id??void 0,startedAt:t.started_at??void 0,endedAt:t.ended_at??void 0,data:n},e);return o.previousSpan=r,o}function jw(e){return{usage:new St(e.usage),output:e.output.map(n=>gu.parse(n)),responseId:e.responseId,providerData:e.providerData}}function Bw(e,t){switch(e.type){case"message_output_item":return new pn(e.rawItem,t.get(e.agent.name));case"tool_call_item":return new Be(e.rawItem,t.get(e.agent.name));case"tool_call_output_item":return new Pe(e.rawItem,t.get(e.agent.name),e.output);case"reasoning_item":return new kn(e.rawItem,t.get(e.agent.name));case"handoff_call_item":return new Pn(e.rawItem,t.get(e.agent.name));case"handoff_output_item":return new Ln(e.rawItem,t.get(e.sourceAgent.name),t.get(e.targetAgent.name));case"tool_approval_item":return new ue(e.rawItem,t.get(e.agent.name),e.toolName)}}async function GR(e,t,n,r){let o=await t.getAllTools(n),i=new Map(o.filter(f=>f.type==="function").map(f=>[f.name,f])),s=new Map(o.filter(f=>f.type==="computer").map(f=>[f.name,f])),a=new Map(o.filter(f=>f.type==="shell").map(f=>[f.name,f])),u=new Map(o.filter(f=>f.type==="apply_patch").map(f=>[f.name,f])),l=new Map(t.handoffs.map(f=>f instanceof bt?[f.name,hu(f)]:[f.toolName,f])),d={newItems:r.newItems.map(f=>Bw(f,e)),toolsUsed:r.toolsUsed,handoffs:r.handoffs.map(f=>{if(!l.has(f.handoff.toolName))throw new B(`Handoff ${f.handoff.toolName} not found`);return{toolCall:f.toolCall,handoff:l.get(f.handoff.toolName)}}),functions:await Promise.all(r.functions.map(async f=>{if(!i.has(f.tool.name))throw new B(`Tool ${f.tool.name} not found`);return{toolCall:f.toolCall,tool:i.get(f.tool.name)}})),computerActions:r.computerActions.map(f=>{let m=f.computer.name;if(!s.has(m))throw new B(`Computer tool ${m} not found`);return{toolCall:f.toolCall,computer:s.get(m)}}),shellActions:(r.shellActions??[]).map(f=>{let m=f.shell.name;if(!a.has(m))throw new B(`Shell tool ${m} not found`);return{toolCall:f.toolCall,shell:a.get(m)}}),applyPatchActions:(r.applyPatchActions??[]).map(f=>{let m=f.applyPatch.name;if(!u.has(m))throw new B(`Apply patch tool ${m} not found`);return{toolCall:f.toolCall,applyPatch:u.get(m)}}),mcpApprovalRequests:(r.mcpApprovalRequests??[]).map(f=>({requestItem:new ue(f.requestItem.rawItem,t),mcpTool:f.mcpTool}))};return g(p({},d),{hasToolsOrApprovalsToRun(){return d.handoffs.length>0||d.functions.length>0||d.mcpApprovalRequests.length>0||d.computerActions.length>0||d.shellActions.length>0||d.applyPatchActions.length>0}})}var Cs=class extends pu{config;constructor(t={}){super(),this.config={modelProvider:t.modelProvider??KI(),model:t.model,modelSettings:t.modelSettings,handoffInputFilter:t.handoffInputFilter,inputGuardrails:t.inputGuardrails,outputGuardrails:t.outputGuardrails,tracingDisabled:t.tracingDisabled??!1,traceIncludeSensitiveData:t.traceIncludeSensitiveData??!0,workflowName:t.workflowName??"Agent workflow",traceId:t.traceId,groupId:t.groupId,traceMetadata:t.traceMetadata,sessionInputCallback:t.sessionInputCallback,callModelInputFilter:t.callModelInputFilter},this.inputGuardrailDefs=(t.inputGuardrails??[]).map(Rp),this.outputGuardrailDefs=(t.outputGuardrails??[]).map(Vo)}async run(t,n,r={stream:!1,context:void 0}){let o=r??{stream:!1,context:void 0},i=o.sessionInputCallback??this.config.sessionInputCallback,s=o.callModelInputFilter??this.config.callModelInputFilter,a=!!s,u=g(p({},o),{sessionInputCallback:i,callModelInputFilter:s}),l=!!u.conversationId||!!u.previousResponseId,d=u.session,f=n instanceof xt,m=d&&f?[]:void 0,h,y=d&&f?new Map:void 0,v=(S,T)=>{let R=y;if(T!==void 0){if(!R){h=T.map(ze=>structuredClone(ze));return}let ie=[],he=new WeakMap;for(let ze of S){if(!ze||typeof ze!="object")continue;let ct=(he.get(ze)??0)+1;he.set(ze,ct)}let $r=()=>{for(let[ze,ct]of R)if(ct>0)return R.set(ze,ct-1),!0;return!1};for(let ze=0;ze<T.length;ze++){let ct=T[ze];if(!ct)continue;let Us=!1,$n=S[ze];if($n&&typeof $n=="object"){let _h=(he.get($n)??0)-1;if(he.set($n,_h),_h>0)continue;let Ih=Nr($n),wh=R.get(Ih)??0;if(wh>0){R.set(Ih,wh-1),ie.push(structuredClone(ct)),Us=!0;continue}}let yh=Nr(ct),vh=R.get(yh)??0;if(vh>0){R.set(yh,vh-1),ie.push(structuredClone(ct)),Us=!0;continue}!$n&&$r()&&(ie.push(structuredClone(ct)),Us=!0),!Us&&!$n&&h===void 0&&ie.push(structuredClone(ct))}(ie.length>0||h===void 0)&&(h=ie);return}let Y=[];if(R)for(let ie of S){if(!ie)continue;let he=Nr(ie),$r=R.get(he)??0;$r<=0||(R.set(he,$r-1),Y.push(structuredClone(ie)))}else for(let ie of S)ie&&Y.push(structuredClone(ie));Y.length>0?h=Y:h===void 0&&(h=[])},_=()=>{if(h!==void 0)return h;if(!a)return m},I=n;if(!(I instanceof xt)){if(d&&Array.isArray(I)&&!i)throw new B("RunConfig.sessionInputCallback must be provided when using session history with list inputs.");let S=await kw(I,d,i,{includeHistoryInPreparedInput:!l,preserveDroppedNewItems:l});if(l&&d){let T=S.sessionItems;T&&T.length>0?I=T:I=S.preparedInput}else I=S.preparedInput;if(d){let T=S.sessionItems??[];m=T.map(R=>structuredClone(R)),y=new Map;for(let R of T){let Y=Nr(R);y.set(Y,(y.get(Y)??0)+1)}}}let w;if(d&&!l){let S=!1;w=async()=>{if(S)return;let T=_();!T||T.length===0||(S=!0,await Ow(d,T))}}let N=async()=>{if(u.stream)return await this.#i(t,I,u,w,v);let S=await this.#n(t,I,u,v);return d&&!l&&await Rw(d,_(),S),S};return I instanceof xt&&I._trace?Yp(I._trace,async()=>(I._currentAgentSpan&&qo(I._currentAgentSpan),N())):Kp(async()=>N(),{traceId:this.config.traceId,name:this.config.workflowName,groupId:this.config.groupId,metadata:this.config.traceMetadata})}inputGuardrailDefs;outputGuardrailDefs;#e(t){return this.inputGuardrailDefs.concat(t._currentAgent.inputGuardrails.map(Rp))}#t(t){let n=this.#e(t),r=[],o=[];for(let i of n)i.runInParallel===!1?r.push(i):o.push(i);return{blocking:r,parallel:o}}async#o(t){let n=t.model!==void 0&&t.model!==bt.DEFAULT_MODEL_PLACEHOLDER||this.config.model!==void 0&&this.config.model!==bt.DEFAULT_MODEL_PLACEHOLDER,r=WR(t.model,this.config.model);return typeof r=="string"&&(r=await this.config.modelProvider.getModel(r)),{model:r,explictlyModelSet:n}}async#n(t,n,r,o){return Rs(async()=>{let i=n instanceof xt,s=i?n:new xt(r.context instanceof ot?r.context:new ot(r.context),n,t,r.maxTurns??zw),a=r.conversationId||r.previousResponseId?new wu({conversationId:r.conversationId,previousResponseId:r.previousResponseId}):void 0;a&&i&&a.primeFromState({originalInput:s._originalInput,generatedItems:s._generatedItems,modelResponses:s._modelResponses});try{for(;;){if(s._currentStep=s._currentStep??{type:"next_step_run_again"},s._currentStep.type==="next_step_interruption"){if(M.debug("Continuing from interruption"),!s._lastTurnResponse||!s._lastProcessedResponse)throw new B("No model response found in previous state",s);let u=await zp(s._currentAgent,s._originalInput,s._generatedItems,s._lastTurnResponse,s._lastProcessedResponse,this,s);if(s._toolUseTracker.addToolUse(s._currentAgent,s._lastProcessedResponse.toolsUsed),s._originalInput=u.originalInput,s._generatedItems=u.generatedItems,u.nextStep.type==="next_step_run_again"&&(s._currentTurnPersistedItemCount=0),s._currentStep=u.nextStep,u.nextStep.type==="next_step_interruption")return new Rr(s);continue}if(s._currentStep.type==="next_step_run_again"){let u=await Gw(s);if(s._currentTurn++,s._currentTurnPersistedItemCount=0,s._currentTurn>s._maxTurns)throw s._currentAgentSpan?.setError({message:"Max turns exceeded",data:{max_turns:s._maxTurns}}),new Oo(`Max turns (${s._maxTurns}) exceeded`,s);M.debug(`Running agent ${s._currentAgent.name} (turn ${s._currentTurn})`);let l;if(s._currentTurn===1){let y=this.#t(s);y.blocking.length>0&&await this.#s(s,y.blocking),y.parallel.length>0&&(l=this.#s(s,y.parallel),l.catch(()=>{}))}let d=a?a.prepareInput(s._originalInput,s._generatedItems):Fn(s._originalInput,s._generatedItems);s._noActiveAgentRun&&(s._currentAgent.emit("agent_start",s._context,s._currentAgent),this.emit("agent_start",s._context,s._currentAgent));let f=await this.#c(s,r,u,d,a,o);s._lastTurnResponse=await f.model.getResponse(g(p({systemInstructions:f.modelInput.instructions,prompt:f.prompt},f.explictlyModelSet?{overridePromptModel:!0}:{}),{input:f.modelInput.input,previousResponseId:f.previousResponseId,conversationId:f.conversationId,modelSettings:f.modelSettings,tools:f.serializedTools,toolsExplicitlyProvided:f.toolsExplicitlyProvided,outputType:vp(s._currentAgent.outputType),handoffs:f.serializedHandoffs,tracing:qw(this.config.tracingDisabled,this.config.traceIncludeSensitiveData),signal:r.signal})),s._modelResponses.push(s._lastTurnResponse),s._context.usage.add(s._lastTurnResponse.usage),s._noActiveAgentRun=!1,a?.trackServerItems(s._lastTurnResponse);let m=Bp(s._lastTurnResponse,s._currentAgent,f.tools,f.handoffs);s._lastProcessedResponse=m;let h=await qp(s._currentAgent,s._originalInput,s._generatedItems,s._lastTurnResponse,s._lastProcessedResponse,this,s);s._toolUseTracker.addToolUse(s._currentAgent,s._lastProcessedResponse.toolsUsed),s._originalInput=h.originalInput,s._generatedItems=h.generatedItems,h.nextStep.type==="next_step_run_again"&&(s._currentTurnPersistedItemCount=0),s._currentStep=h.nextStep,l&&await l}if(s._currentStep&&s._currentStep.type==="next_step_final_output")return await this.#r(s,s._currentStep.output),this.emit("agent_end",s._context,s._currentAgent,s._currentStep.output),s._currentAgent.emit("agent_end",s._context,s._currentStep.output),new Rr(s);if(s._currentStep&&s._currentStep.type==="next_step_handoff")s._currentAgent=s._currentStep.newAgent,s._currentAgentSpan&&(s._currentAgentSpan.end(),jn(),s._currentAgentSpan=void 0),s._noActiveAgentRun=!0,s._currentStep={type:"next_step_run_again"};else{if(s._currentStep&&s._currentStep.type==="next_step_interruption")return new Rr(s);M.debug("Running next loop")}}}catch(u){throw s._currentAgentSpan&&s._currentAgentSpan.setError({message:"Error in agent run",data:{error:String(u)}}),u}finally{s._currentAgentSpan&&(s._currentStep?.type!=="next_step_interruption"&&s._currentAgentSpan.end(),jn())}})}async#a(t,n,r,o,i){let s=!!n.conversationId||!!n.previousResponseId,a=s?new wu({conversationId:n.conversationId,previousResponseId:n.previousResponseId}):void 0,u=!1,l=!1,d=async()=>{l||!o||(await o(),l=!0)};a&&r&&a.primeFromState({originalInput:t.state._originalInput,generatedItems:t.state._generatedItems,modelResponses:t.state._modelResponses});try{for(;;){let f=t.state._currentAgent;if(t.state._currentStep=t.state._currentStep??{type:"next_step_run_again"},t.state._currentStep.type==="next_step_interruption"){if(M.debug("Continuing from interruption"),!t.state._lastTurnResponse||!t.state._lastProcessedResponse)throw new B("No model response found in previous state",t.state);let m=await zp(t.state._currentAgent,t.state._originalInput,t.state._generatedItems,t.state._lastTurnResponse,t.state._lastProcessedResponse,this,t.state);if(Gp(t,m),t.state._toolUseTracker.addToolUse(t.state._currentAgent,t.state._lastProcessedResponse.toolsUsed),t.state._originalInput=m.originalInput,t.state._generatedItems=m.generatedItems,m.nextStep.type==="next_step_run_again"&&(t.state._currentTurnPersistedItemCount=0),t.state._currentStep=m.nextStep,m.nextStep.type==="next_step_interruption")return;continue}if(t.state._currentStep.type==="next_step_run_again"){let m=await Gw(t.state);if(t.state._currentTurn++,t.state._currentTurnPersistedItemCount=0,t.state._currentTurn>t.state._maxTurns)throw t.state._currentAgentSpan?.setError({message:"Max turns exceeded",data:{max_turns:t.state._maxTurns}}),new Oo(`Max turns (${t.state._maxTurns}) exceeded`,t.state);M.debug(`Running agent ${f.name} (turn ${t.state._currentTurn})`);let h,y;if(t.state._currentTurn===1){let T=this.#t(t.state);T.blocking.length>0&&await this.#s(t.state,T.blocking),T.parallel.length>0&&(y=this.#s(t.state,T.parallel).catch(Y=>(h=Y,[])))}let v=a?a.prepareInput(t.input,t.newItems):Fn(t.input,t.newItems);t.state._noActiveAgentRun&&(f.emit("agent_start",t.state._context,f),this.emit("agent_start",t.state._context,f));let _,I=await this.#c(t.state,n,m,v,a,i);if(h)throw h;u=!0,await d();for await(let T of I.model.getStreamedResponse(g(p({systemInstructions:I.modelInput.instructions,prompt:I.prompt},I.explictlyModelSet?{overridePromptModel:!0}:{}),{input:I.modelInput.input,previousResponseId:I.previousResponseId,conversationId:I.conversationId,modelSettings:I.modelSettings,tools:I.serializedTools,toolsExplicitlyProvided:I.toolsExplicitlyProvided,handoffs:I.serializedHandoffs,outputType:vp(f.outputType),tracing:qw(this.config.tracingDisabled,this.config.traceIncludeSensitiveData),signal:n.signal}))){if(h)throw h;if(T.type==="response_done"){let R=jp.parse(T);_={usage:new St(R.response.usage),output:R.response.output,responseId:R.response.id}}if(t.cancelled)return;t._addItem(new Os(T))}if(y&&(await y,h))throw h;if(t.state._noActiveAgentRun=!1,!_)throw new ae("Model did not produce a final response!",t.state);t.state._lastTurnResponse=_,a?.trackServerItems(_),t.state._modelResponses.push(t.state._lastTurnResponse);let w=Bp(t.state._lastTurnResponse,f,I.tools,I.handoffs);t.state._lastProcessedResponse=w;let N=new Set(w.newItems);N.size>0&&Mw(t,w.newItems);let S=await qp(f,t.state._originalInput,t.state._generatedItems,t.state._lastTurnResponse,t.state._lastProcessedResponse,this,t.state);Gp(t,S,{skipItems:N}),t.state._toolUseTracker.addToolUse(f,w.toolsUsed),t.state._originalInput=S.originalInput,t.state._generatedItems=S.generatedItems,S.nextStep.type==="next_step_run_again"&&(t.state._currentTurnPersistedItemCount=0),t.state._currentStep=S.nextStep}if(t.state._currentStep.type==="next_step_final_output"){await this.#r(t.state,t.state._currentStep.output),await d(),s||await Zp(n.session,t),this.emit("agent_end",t.state._context,f,t.state._currentStep.output),f.emit("agent_end",t.state._context,t.state._currentStep.output);return}else if(t.state._currentStep.type==="next_step_interruption"){await d(),s||await Zp(n.session,t);return}else t.state._currentStep.type==="next_step_handoff"?(t.state._currentAgent=t.state._currentStep?.newAgent,t.state._currentAgentSpan&&(t.state._currentAgentSpan.end(),jn()),t.state._currentAgentSpan=void 0,t._addItem(new Ps(t.state._currentAgent)),t.state._noActiveAgentRun=!0,t.state._currentStep={type:"next_step_run_again"}):M.debug("Running next loop")}}catch(f){throw u&&!l&&await d(),t.state._currentAgentSpan&&t.state._currentAgentSpan.setError({message:"Error in agent run",data:{error:String(f)}}),f}finally{t.state._currentAgentSpan&&(t.state._currentStep?.type!=="next_step_interruption"&&t.state._currentAgentSpan.end(),jn())}}async#i(t,n,r,o,i){return r=r??{},Rs(async()=>{let s=n instanceof xt,a=s?n:new xt(r.context instanceof ot?r.context:new ot(r.context),n,t,r.maxTurns??zw),u=new Or({signal:r.signal,state:a});u.maxTurns=r.maxTurns??a._maxTurns;let l=this.#a(u,r,s,o,i).then(()=>{u._done()},d=>{u._raiseError(d)});return u._setStreamLoopPromise(l),u})}async#s(t,n){let r=n??this.#e(t);if(r.length>0){let o={agent:t._currentAgent,input:t._originalInput,context:t._context};try{let i=await Promise.all(r.map(async s=>Up(async a=>{let u=await s.run(o);return a.spanData.triggered=u.output.tripwireTriggered,u},{data:{name:s.name}},t._currentAgentSpan)));t._inputGuardrailResults.push(...i);for(let s of i)if(s.output.tripwireTriggered)throw t._currentAgentSpan&&t._currentAgentSpan.setError({message:"Guardrail tripwire triggered",data:{guardrail:s.guardrail.name}}),new Po(`Input guardrail triggered: ${JSON.stringify(s.output.outputInfo)}`,s,t);return i}catch(i){throw i instanceof Po?i:(t._currentTurn--,new ko(`Input guardrail failed to complete: ${i}`,i,t))}}return[]}async#r(t,n){let r=this.outputGuardrailDefs.concat(t._currentAgent.outputGuardrails.map(Vo));if(r.length>0){let o=t._currentAgent.processFinalOutput(n),i=Fn([],t._generatedItems),s={agent:t._currentAgent,agentOutput:o,context:t._context,details:{modelResponse:t._lastTurnResponse,output:i}};try{let a=await Promise.all(r.map(async u=>Up(async l=>{let d=await u.run(s);return l.spanData.triggered=d.output.tripwireTriggered,d},{data:{name:u.name}},t._currentAgentSpan)));for(let u of a)if(u.output.tripwireTriggered)throw t._currentAgentSpan&&t._currentAgentSpan.setError({message:"Guardrail tripwire triggered",data:{guardrail:u.guardrail.name}}),new ln(`Output guardrail triggered: ${JSON.stringify(u.output.outputInfo)}`,u,t)}catch(a){throw a instanceof ln?a:new ko(`Output guardrail failed to complete: ${a}`,a,t)}}}async#c(t,n,r,o,i,s){let{model:a,explictlyModelSet:u}=await this.#o(t._currentAgent),l=p(p({},this.config.modelSettings),t._currentAgent.modelSettings);l=JR(u,t._currentAgent.modelSettings,a,l),l=Ew(t._currentAgent,t._toolUseTracker,l);let d=await t._currentAgent.getSystemPrompt(t._context),f=await t._currentAgent.getPrompt(t._context),{modelInput:m,sourceItems:h,persistedItems:y,filterApplied:v}=await ZR(t._currentAgent,n.callModelInputFilter,t._context,o,d);i?.markInputAsSent(h),s?.(h,v?y:void 0);let _=i?.previousResponseId??n.previousResponseId,I=i?.conversationId??n.conversationId;return g(p({},r),{model:a,explictlyModelSet:u,modelSettings:l,modelInput:m,prompt:f,previousResponseId:_,conversationId:I})}};function Fn(e,t){let n=t.filter(r=>r.type!=="tool_approval_item").map(r=>r.rawItem);return[...Qp(e),...n]}var zw=10;function WR(e,t){return typeof e=="string"&&e!==bt.DEFAULT_MODEL_PLACEHOLDER||e?e:t??e??bt.DEFAULT_MODEL_PLACEHOLDER}function qw(e,t){return e?!1:t?!0:"enabled_without_data"}async function ZR(e,t,n,r,o){let i=(h,y)=>h.map(v=>{let _=structuredClone(v);return y&&_&&typeof _=="object"&&y.set(_,v),_}),s=new WeakMap,a=QR(r),u=[];for(let h of r)h&&typeof h=="object"&&u.push(h);let l=h=>{if(!h||typeof h!="object")return;let y=u.findIndex(v=>v===h);y!==-1&&u.splice(y,1)},d=()=>{let h=u.shift();return h&&Ww(a,h),h},m={input:i(r,s),instructions:o};if(!t)return{modelInput:m,sourceItems:[...r],persistedItems:[],filterApplied:!1};try{let h=await t({modelData:m,agent:e,context:n.context});if(!h||!Array.isArray(h.input))throw new B("callModelInputFilter must return a ModelInputData object with an input array.");let y=h.input.map(_=>{if(!_||typeof _!="object")return;let I=s.get(_);if(I)return l(I),Ww(a,I),I;let w=Nr(_),N=YR(a,w);if(N)return l(N),N;let S=d();if(S)return S}),v=i(h.input);return{modelInput:{input:v,instructions:typeof h.instructions>"u"?o:h.instructions},sourceItems:y,persistedItems:v.map(_=>structuredClone(_)),filterApplied:!0}}catch(h){throw rt({message:"Error in callModelInputFilter",data:{error:String(h)}}),h}}var wu=class{conversationId;previousResponseId;sentInitialInput=!1;sentItems=new WeakSet;serverItems=new WeakSet;remainingInitialInput=null;constructor({conversationId:t,previousResponseId:n}){this.conversationId=t??void 0,this.previousResponseId=n??void 0}primeFromState({originalInput:t,generatedItems:n,modelResponses:r}){if(this.sentInitialInput)return;for(let i of Qp(t))i&&typeof i=="object"&&this.sentItems.add(i);this.sentInitialInput=!0,this.remainingInitialInput=null;let o=r[r.length-1];for(let i of r)for(let s of i.output)s&&typeof s=="object"&&this.serverItems.add(s);!this.conversationId&&o?.responseId&&(this.previousResponseId=o.responseId);for(let i of n){let s=i.rawItem;!s||typeof s!="object"||this.serverItems.has(s)&&this.sentItems.add(s)}}trackServerItems(t){if(t){for(let n of t.output)n&&typeof n=="object"&&this.serverItems.add(n);!this.conversationId&&t.responseId&&(this.previousResponseId=t.responseId)}}prepareInput(t,n){let r=[];if(this.sentInitialInput)this.remainingInitialInput&&this.remainingInitialInput.length>0&&r.push(...this.remainingInitialInput);else{let o=Qp(t);r.push(...o),this.remainingInitialInput=o.filter(i=>!!i&&typeof i=="object"),this.sentInitialInput=!0}for(let o of n){if(o.type==="tool_approval_item")continue;let i=o.rawItem;!i||typeof i!="object"||this.sentItems.has(i)||this.serverItems.has(i)||r.push(i)}return r}markInputAsSent(t){if(!t.length)return;let n=new Set;for(let r of t)!r||typeof r!="object"||n.has(r)||(n.add(r),this.sentItems.add(r));!this.remainingInitialInput||this.remainingInitialInput.length===0||(this.remainingInitialInput=this.remainingInitialInput.filter(r=>!n.has(r)),this.remainingInitialInput.length===0&&(this.remainingInitialInput=null))}};function JR(e,t,n,r){if(Ss()&&e&&(typeof n!="string"||!Mr(n))&&(t.providerData?.reasoning||t.providerData?.text?.verbosity||t.providerData?.reasoning_effort)){let o=p({},r);return delete o.providerData?.reasoning,delete o.providerData?.text?.verbosity,delete o.providerData?.reasoning_effort,o.reasoning&&(delete o.reasoning.effort,delete o.reasoning.summary),o.text&&delete o.text.verbosity,o}return r}async function Gw(e){let t=await e._currentAgent.getEnabledHandoffs(e._context),n=await e._currentAgent.getAllTools(e._context);if(e._currentAgentSpan)e._currentAgentSpan.spanData.tools=n.map(r=>r.name);else{let r=t.map(o=>o.agentName);e._currentAgentSpan=Fp({data:{name:e._currentAgent.name,handoffs:r,tools:n.map(o=>o.name),output_type:e._currentAgent.outputSchemaName}}),e._currentAgentSpan.start(),qo(e._currentAgentSpan)}return{handoffs:t,tools:n,serializedHandoffs:t.map(r=>pw(r)),serializedTools:n.map(r=>fw(r)),toolsExplicitlyProvided:e._currentAgent.hasExplicitToolConfig()}}function Nr(e){return JSON.stringify(e,KR)}function QR(e){let t=new Map;for(let n of e){let r=Nr(n),o=t.get(r);o?o.push(n):t.set(r,[n])}return t}function YR(e,t){let n=e.get(t);if(!n||n.length===0)return;let[r]=n;return n.shift(),n.length===0&&e.delete(t),r}function Ww(e,t){let n=Nr(t),r=e.get(n);if(!r||r.length===0)return;let o=r.findIndex(i=>i===t);o!==-1&&(r.splice(o,1),r.length===0&&e.delete(n))}function KR(e,t){if(t instanceof ArrayBuffer)return{__type:"ArrayBuffer",data:Le(new Uint8Array(t))};if(xr(t)){let n=t;return{__type:n.constructor.name,data:Le(new Uint8Array(n.buffer,n.byteOffset,n.byteLength))}}if(bs(t)){let n=t;return{__type:"Buffer",data:Le(new Uint8Array(n.buffer,n.byteOffset,n.byteLength))}}return Ho(t)?{__type:"Buffer",data:Le(Uint8Array.from(t.data))}:t}function Qp(e){return typeof e=="string"?[{type:"message",role:"user",content:e}]:[...e]}var bu=class{state;constructor(t){this.state=t}get history(){return Fn(this.input,this.newItems)}get output(){return Fn([],this.newItems)}get input(){return this.state._originalInput}get newItems(){return this.state._generatedItems}get rawResponses(){return this.state._modelResponses}get lastResponseId(){let t=this.rawResponses;return t&&t.length>0?t[t.length-1].responseId:void 0}get lastAgent(){return this.state._currentAgent}get inputGuardrailResults(){return this.state._inputGuardrailResults}get outputGuardrailResults(){return this.state._outputGuardrailResults}get interruptions(){return this.state._currentStep?.type==="next_step_interruption"?this.state._currentStep.data.interruptions:[]}get finalOutput(){if(this.state._currentStep?.type==="next_step_final_output")return this.state._currentAgent.processFinalOutput(this.state._currentStep.output);M.warn("Accessed finalOutput before agent run is completed.")}},Rr=class extends bu{constructor(t){super(t)}},Or=class extends bu{get currentAgent(){return this.lastAgent}currentTurn=0;maxTurns;#e=null;#t;#o;#n;#a;#i;#s;#r=!1;#c;constructor(t={}){if(super(t.state),this.#t=t.signal,this.#n=new zI({start:n=>{this.#o=n},cancel:()=>{this.#r=!0}}),this.#a=new Promise((n,r)=>{this.#i=n,this.#s=r}),this.#t){let n=()=>{if(this.#r)return;this.#r=!0;let r=this.#o;if(this.#o=void 0,this.#n.locked){if(r)try{r.close()}catch(o){M.debug(`Failed to close readable stream on abort: ${o}`)}}else this.#n.cancel(this.#t?.reason).catch(o=>{M.debug(`Failed to cancel readable stream on abort: ${o}`)});this.#i?.()};this.#t.aborted?n():this.#t.addEventListener("abort",n,{once:!0})}}_addItem(t){this.cancelled||this.#o?.enqueue(t)}_done(){!this.cancelled&&this.#o&&(this.#o.close(),this.#o=void 0,this.#i?.())}_raiseError(t){!this.cancelled&&this.#o&&(this.#o.error(t),this.#o=void 0),this.#e=t,this.#s?.(t),this.#a.catch(n=>{M.debug(`Resulted in an error: ${n}`)})}get cancelled(){return this.#r}toStream(){return this.#n}get completed(){return this.#a}get error(){return this.#e}toTextStream(t={}){let n=this.#n.pipeThrough(new qI({transform(r,o){if(r.type==="raw_model_stream_event"&&r.data.type==="output_text_delta"){let i=Lp.parse(r.data);o.enqueue(i.delta)}}}));return t.compatibleWithNodeStreams?BI.fromWeb(n):n}[Symbol.asyncIterator](){return this.#n[Symbol.asyncIterator]()}_setStreamLoopPromise(t){this.#c=t}_getStreamLoopPromise(){return this.#c}};var Zw;function Gt(){return Zw??=new du,Zw}function Bt(){let e=Gt().getStore();return e?.trace?e.trace:null}function dn(){let e=Gt().getStore();return e?.span?e.span:null}function Jw(e){return async()=>{let t=Bt();if(!t)throw new Error("No trace found");await t.start();let n=await e(t);if(n instanceof Or){let r=n._getStreamLoopPromise();if(r)return r.finally(()=>t.end()),n}return await t.end(),n}}async function Yp(e,t,n={}){let r=typeof e=="string"?le().createTrace(g(p({},n),{name:e})):e;return Gt().run({trace:r},Jw(t))}async function Kp(e,t={}){if(Bt())return await e();let r=le().createTrace(t);return Gt().run({trace:r},Jw(e))}function qo(e){let t=Gt().getStore();if(!t)throw new Error("No existing trace found");t.span&&(t.span.previousSpan=t.previousSpan,t.previousSpan=t.span),t.span=e,Gt().enterWith(t)}function jn(){let e=Gt().getStore();e&&(e.span=e.previousSpan,e.previousSpan=e.previousSpan?.previousSpan,Gt().enterWith(e))}function rt(e){let t=dn();t&&t.setError(e)}function XR(e){return{trace:e.trace?.clone(),span:e.span?.clone(),previousSpan:e.previousSpan?.clone()}}function Rs(e){let t=Gt().getStore();if(!t)throw new Error("No existing trace found");let n=XR(t);return Gt().run(n,e)}var Eu=class{async export(t){if(uu.disabled){M.debug("Tracing is disabled. Skipping export");return}for(let n of t)n.type==="trace"?console.log(`[Exporter] Export trace traceId=${n.traceId} name=${n.name}${n.groupId?` groupId=${n.groupId}`:""}`):console.log(`[Exporter] Export span: ${JSON.stringify(n)}`)}},Su=class{#e;#t;#o;#n;#a;#i=[];#s;#r=null;#c=!1;#l=null;constructor(t,{maxQueueSize:n=1e3,maxBatchSize:r=100,scheduleDelay:o=5e3,exportTriggerRatio:i=.8}={}){this.#e=n,this.#t=r,this.#o=o,this.#n=n*i,this.#a=t,this.#s=WI,GI()?this.start():M.debug("Automatic trace export loop is not supported in this environment. You need to manually call `getGlobalTraceProvider().forceFlush()` to export traces.")}start(){this.#l=new AbortController,this.#f()}async#u(t){if(this.#i.length+1>this.#e){M.error("Dropping trace because buffer is full");return}this.#i.push(t),this.#i.length>this.#n&&await this.#d()}#f(){this.#r=this.#s.setTimeout(async()=>{await this.#d(),this.#f()},this.#o),typeof this.#r.unref=="function"&&this.#r.unref()}async#d(t=!1){if(this.#i.length!==0){if(M.debug(`Exporting batches. Force: ${t}. Buffer size: ${this.#i.length}`),t||this.#i.length<this.#t){let n=[...this.#i];this.#i=[],this.#c=!0,await this.#a.export(n),this.#c=!1}else if(this.#i.length>0){let n=this.#i.splice(0,this.#t);this.#c=!0,await this.#a.export(n),this.#c=!1}}}async onTraceStart(t){await this.#u(t)}async onTraceEnd(t){}async onSpanStart(t){}async onSpanEnd(t){await this.#u(t)}async shutdown(t){for(t&&this.#s.setTimeout(()=>{this.#l?.abort()},t),M.debug("Shutting down gracefully");this.#i.length>0;){if(M.debug(`Waiting for buffer to empty. Items left: ${this.#i.length}`),this.#c||await this.#d(!0),this.#l?.signal.aborted){M.debug("Timeout reached, force flushing"),await this.#d(!0);break}await new Promise(n=>this.#s.setTimeout(n,500))}M.debug("Buffer empty. Exiting"),this.#s&&this.#r&&this.#s.clearTimeout(this.#r)}async forceFlush(){this.#i.length>0&&await this.#d(!0)}},Tu=class{#e=[];start(){for(let t of this.#e)t.start&&t.start()}addTraceProcessor(t){this.#e.push(t)}setProcessors(t){M.debug("Shutting down old processors");for(let n of this.#e)n.shutdown();this.#e=t}async onTraceStart(t){for(let n of this.#e)await n.onTraceStart(t)}async onTraceEnd(t){for(let n of this.#e)await n.onTraceEnd(t)}async onSpanStart(t){for(let n of this.#e)await n.onSpanStart(t)}async onSpanEnd(t){for(let n of this.#e)await n.onSpanEnd(t)}async shutdown(t){for(let n of this.#e)await n.shutdown(t)}async forceFlush(){for(let t of this.#e)await t.forceFlush()}},Xp=null,eh=null;function eO(){return Xp||(Xp=new Eu),Xp}function xu(){return eh||(eh=new Su(eO())),eh}function th(){return new Date().toISOString()}function js(){return`trace_${fu().replace(/-/g,"")}`}function nh(){return`span_${fu().replace(/-/g,"").slice(0,24)}`}function Qw(e){return Object.fromEntries(Object.entries(e).filter(([t])=>!t.startsWith("_")))}var kr=class e{type="trace.span";#e;#t;#o;#n;#a;#i;#s;#r;#c;constructor(t,n){this.#t=t.traceId,this.#o=t.spanId??nh(),this.#e=t.data,this.#a=n,this.#n=t.parentId??null,this.#r=t.error??null,this.#i=t.startedAt??null,this.#s=t.endedAt??null}get traceId(){return this.#t}get spanData(){return this.#e}get spanId(){return this.#o}get parentId(){return this.#n}get previousSpan(){return this.#c}set previousSpan(t){this.#c=t}start(){if(this.#i){M.warn("Span already started");return}this.#i=th(),this.#a.onSpanStart(this)}end(){if(this.#s){M.debug("Span already finished",this.spanData);return}this.#s=th(),this.#a.onSpanEnd(this)}setError(t){this.#r=t}get error(){return this.#r}get startedAt(){return this.#i}get endedAt(){return this.#s}clone(){let t=new e({traceId:this.traceId,spanId:this.spanId,parentId:this.parentId??void 0,data:this.spanData,startedAt:this.#i??void 0,endedAt:this.#s??void 0,error:this.#r??void 0},this.#a);return t.previousSpan=this.previousSpan?.clone(),t}toJSON(){return{object:this.type,id:this.spanId,trace_id:this.traceId,parent_id:this.parentId,started_at:this.startedAt,ended_at:this.endedAt,span_data:Qw(this.spanData),error:this.error}}},st=class extends kr{constructor(t,n){super({traceId:"no-op",spanId:"no-op",data:t},n)}start(){}end(){}setError(){}toJSON(){return null}};var Pr=class e{type="trace";traceId;name;groupId=null;metadata;#e;#t;constructor(t,n){this.traceId=t.traceId??js(),this.name=t.name??"Agent workflow",this.groupId=t.groupId??null,this.metadata=t.metadata??{},this.#e=n??xu(),this.#t=t.started??!1}async start(){this.#t||(this.#t=!0,await this.#e.onTraceStart(this))}async end(){this.#t&&(this.#t=!1,await this.#e.onTraceEnd(this))}clone(){return new e({traceId:this.traceId,name:this.name,groupId:this.groupId??void 0,metadata:this.metadata,started:this.#t})}toJSON(){return{object:this.type,id:this.traceId,workflow_name:this.name,group_id:this.groupId,metadata:this.metadata}}},Lr=class extends Pr{constructor(){super({})}async start(){}async end(){}toJSON(){return null}};var Cu=class{#e;#t;constructor(){this.#e=new Tu,this.#t=uu.disabled,this.#o()}registerProcessor(t){this.#e.addTraceProcessor(t)}setProcessors(t){this.#e.setProcessors(t)}getCurrentTrace(){return Bt()}getCurrentSpan(){return dn()}setDisabled(t){this.#t=t}startExportLoop(){this.#e.start()}createTrace(t){if(this.#t)return M.debug("Tracing is disabled, Not creating trace %o",t),new Lr;let n=t.traceId??js(),r=t.name??"Agent workflow";return M.debug("Creating trace %s with name %s",n,r),new Pr(g(p({},t),{name:r,traceId:n}),this.#e)}createSpan(t,n){if(this.#t||t.disabled)return M.debug("Tracing is disabled, Not creating span %o",t),new st(t.data,this.#e);let r,o;if(n){if(n instanceof Pr){if(n instanceof Lr)return M.debug("Parent trace is no-op, returning NoopSpan"),new st(t.data,this.#e);o=n.traceId}else if(n instanceof kr){if(n instanceof st)return M.debug("Parent span is no-op, returning NoopSpan"),new st(t.data,this.#e);r=n.spanId,o=n.traceId}}else{let i=Bt(),s=dn();if(!i)return M.error("No active trace. Make sure to start a trace with `withTrace()` first. Returning NoopSpan."),new st(t.data,this.#e);if(s instanceof st||i instanceof Lr)return M.debug(`Parent ${s} or ${i} is no-op, returning NoopSpan`),new st(t.data,this.#e);o=i.traceId,s?(M.debug("Using parent span %s",s.spanId),r=s.spanId):M.debug("No parent span, using current trace %s",i.traceId)}return o?(M.debug(`Creating span ${JSON.stringify(t.data)} with id ${t.spanId??o}`),new kr(g(p({},t),{traceId:o,parentId:r}),this.#e)):(M.error("No traceId found. Make sure to start a trace with `withTrace()` first. Returning NoopSpan."),new st(t.data,this.#e))}async shutdown(t){try{M.debug("Shutting down tracing provider"),await this.#e.shutdown(t)}catch(n){M.error("Error shutting down tracing provider %o",n)}}#o(){if(typeof process<"u"&&typeof process.on=="function"){let t=async()=>{let n=setTimeout(()=>{console.warn("Cleanup timeout, forcing exit"),process.exit(1)},5e3);try{await this.shutdown()}finally{clearTimeout(n)}};process.on("beforeExit",t),process.on("SIGINT",async()=>{await t(),Yw("SIGINT")||process.exit(130)}),process.on("SIGTERM",async()=>{await t(),Yw("SIGTERM")||process.exit(0)}),process.on("unhandledRejection",async(n,r)=>{M.error("Unhandled rejection",n,r),await t(),tO("unhandledRejection")||process.exit(1)})}}async forceFlush(){await this.#e.forceFlush()}};function Yw(e){return process.listeners(e).length>1}function tO(e){return process.listeners(e).length>1}var rh;function le(){return rh||(rh=new Cu),rh}function Kw(e){le().registerProcessor(e)}Kw(xu());function oh(e){let t=atob(e),n=t.length,r=new Uint8Array(n);for(let o=0;o<n;o++)r[o]=t.charCodeAt(o);return r.buffer}function ih(e){let t=String.fromCharCode(...new Uint8Array(e));return btoa(t)}function sh(e){if(typeof e>"u"||e===null||typeof e!="object"||!("type"in e)||typeof e.type!="string"||!e.type||e.type!=="message"||!("content"in e)||!Array.isArray(e.content)||e.content.length<1)return;let t=e.content[e.content.length-1];if(!(!("type"in t)||typeof t.type!="string")){if(t.type==="output_text")return typeof t.text=="string"?t.text:void 0;if(t.type==="output_audio")return typeof t.transcript=="string"?t.transcript:void 0}}function eb(e,t){let n=e.filter(i=>!t.some(s=>s.itemId===i.itemId)),r=t.filter(i=>!e.some(s=>s.itemId===i.itemId)),o=t.filter(i=>e.some(s=>s.itemId===i.itemId&&JSON.stringify(s)!==JSON.stringify(i)));return{removals:n,additions:r,updates:o}}function tb(){return typeof window>"u"?!1:typeof window.RTCPeerConnection<"u"}function Xw(e){return e.role==="system"?e:e.role==="assistant"?g(p({},e),{content:e.content.map(t=>t.type==="output_audio"?g(p({},t),{audio:null}):t)}):e.role==="user"?g(p({},e),{content:e.content.map(t=>t.type==="input_audio"?g(p({},t),{audio:null}):t)}):e}function nO(e,t){if(e.role!=="assistant"||t.role!=="assistant")return t;let n=t.content.map((r,o)=>{if(r.type!=="output_audio"||!(typeof r.transcript!="string"||r.transcript.length===0))return r;let s=e.content[o];return s&&s.type==="output_audio"&&typeof s.transcript=="string"&&s.transcript.length>0?g(p({},r),{transcript:s.transcript}):r});return g(p({},t),{content:n})}function ah(e,t,n){if(t.type==="conversation.item.input_audio_transcription.completed")return e.map(i=>{if(i.itemId===t.item_id&&i.type==="message"&&"role"in i&&i.role==="user"){let s=i.content.map(a=>a.type==="input_audio"?g(p({},a),{transcript:t.transcript}):a);return g(p({},i),{content:s,status:"completed"})}return i});let r=!n&&t.type==="message"?Xw(t):t,o=e.findIndex(i=>i.itemId===t.itemId);if(o!==-1){let i=e[o],s=r.type==="message"&&i.type==="message"?nO(i,r):r;return e.map((a,u)=>u===o?s:!n&&a.type==="message"?Xw(a):a)}else if(t.previousItemId){let i=e.findIndex(s=>s.itemId===t.previousItemId);return i!==-1?[...e.slice(0,i+1),r,...e.slice(i+1)]:[...e,r]}else return[...e,r]}var Du={"User-Agent":`Agents/JavaScript ${Wc.version}`,"X-OpenAI-Agents-SDK":`openai-agents-sdk.${Wc.version}`},nb=`openai-agents-sdk.${Wc.version}`;function rb(e,t){let i=t,{name:n,arguments:r}=i,o=Wt(i,["name","arguments"]);return new ue({type:"hosted_tool_call",name:n,arguments:JSON.stringify(r),status:"in_progress",providerData:p({},o)},e)}function ch(e){if(e.rawItem.type!=="function_call"&&e.rawItem.type!=="hosted_tool_call")throw new Error("Invalid approval item type for Realtime MCP approval request");let{name:t,arguments:n,providerData:r}=e.rawItem,a=r??{},{itemId:o,serverLabel:i}=a,s=Wt(a,["itemId","serverLabel"]);if(!o||!i)throw new Error("Invalid approval item for Realtime MCP approval request");return g(p({type:"mcp_approval_request",itemId:o,serverLabel:i},s),{name:t,arguments:n?JSON.parse(n):{},approved:null})}var Fs=class extends bt{voice;constructor(t){super(t),this.voice=t.voice}};function ob(e){return{debounceTextLength:e.debounceTextLength??100}}function ib(n){var r=n,{policyHint:e}=r,t=Wt(r,["policyHint"]);let o=Vo(t),i=e??o.name;return g(p({},o),{policyHint:i,run:async s=>{let a=await o.run(s);return g(p({},a),{guardrail:g(p({},a.guardrail),{policyHint:i})})}})}function sb(e){return`
\u26A0\uFE0F Your last answer was blocked. 
Failed Guardrail Reason: ${e.guardrail.policyHint}. 
Failure Details: ${JSON.stringify(e.output.outputInfo??{})}. 
Please respond again following policy. Apologize for not being able to answer the question (while avoiding the specific reason) and divert discussion back to an approved topic immediately and not invite more discussion.
`.trim()}function jr(e,t){return e in t&&typeof t[e]<"u"}function oO(e){return jr("modalities",e)||jr("inputAudioFormat",e)||jr("outputAudioFormat",e)||jr("inputAudioTranscription",e)||jr("turnDetection",e)||jr("inputAudioNoiseReduction",e)||jr("speed",e)}function ab(e){if(!oO(e)){let t=e.audio?.input?{format:Mu(e.audio.input.format),noiseReduction:e.audio.input.noiseReduction??null,transcription:e.audio.input.transcription,turnDetection:e.audio.input.turnDetection}:void 0,n=e.audio?.output?.voice??e.voice,r=e.audio?.output||typeof n<"u"?{format:Mu(e.audio?.output?.format),voice:n,speed:e.audio?.output?.speed}:void 0;return{model:e.model,instructions:e.instructions,toolChoice:e.toolChoice,tools:e.tools,tracing:e.tracing,providerData:e.providerData,prompt:e.prompt,outputModalities:e.outputModalities,audio:t||r?{input:t,output:r}:void 0}}return{model:e.model,instructions:e.instructions,toolChoice:e.toolChoice,tools:e.tools,tracing:e.tracing,providerData:e.providerData,prompt:e.prompt,outputModalities:e.modalities,audio:{input:{format:Mu(e.inputAudioFormat),noiseReduction:e.inputAudioNoiseReduction??null,transcription:e.inputAudioTranscription,turnDetection:e.turnDetection},output:{format:Mu(e.outputAudioFormat),voice:e.voice,speed:e.speed}}}}function Mu(e){if(!e)return;if(typeof e=="object")return e;let t=String(e);return t==="pcm16"?{type:"audio/pcm",rate:24e3}:t==="g711_ulaw"?{type:"audio/pcmu"}:t==="g711_alaw"?{type:"audio/pcma"}:{type:"audio/pcm",rate:24e3}}var GQ=c.object({itemId:c.string()}),uh=c.discriminatedUnion("role",[c.object({itemId:c.string(),previousItemId:c.string().nullable().optional(),type:c.literal("message"),role:c.literal("system"),content:c.array(c.object({type:c.literal("input_text"),text:c.string()}))}),c.object({itemId:c.string(),previousItemId:c.string().nullable().optional(),type:c.literal("message"),role:c.literal("user"),status:c.enum(["in_progress","completed"]),content:c.array(c.object({type:c.literal("input_text"),text:c.string()}).or(c.object({type:c.literal("input_audio"),audio:c.string().nullable().optional(),transcript:c.string().nullable()})))}),c.object({itemId:c.string(),previousItemId:c.string().nullable().optional(),type:c.literal("message"),role:c.literal("assistant"),status:c.enum(["in_progress","completed","incomplete"]),content:c.array(c.object({type:c.literal("output_text"),text:c.string()}).or(c.object({type:c.literal("output_audio"),audio:c.string().nullable().optional(),transcript:c.string().nullable().optional()})))})]),lh=c.object({itemId:c.string(),previousItemId:c.string().nullable().optional(),type:c.literal("function_call"),status:c.enum(["in_progress","completed","incomplete"]),arguments:c.string(),name:c.string(),output:c.string().nullable()}),dh=c.object({itemId:c.string(),previousItemId:c.string().nullable().optional(),type:c.enum(["mcp_call","mcp_tool_call"]),status:c.enum(["in_progress","completed","incomplete"]),arguments:c.string(),name:c.string(),output:c.string().nullable()}),cb=c.object({itemId:c.string(),type:c.literal("mcp_approval_request"),serverLabel:c.string(),name:c.string(),arguments:c.record(c.string(),c.any()),approved:c.boolean().optional().nullable()});var iO=Is("openai-agents:realtime"),je=iO;var ub=c.object({id:c.string().optional().nullable(),conversation_id:c.string().optional().nullable(),max_output_tokens:c.number().or(c.literal("inf")).optional().nullable(),metadata:c.record(c.string(),c.any()).optional().nullable(),output_modalities:c.array(c.string()).optional().nullable(),object:c.literal("realtime.response").optional().nullable(),output:c.array(c.any()).optional().nullable(),audio:c.object({output:c.object({format:c.any().optional().nullable(),voice:c.string().optional().nullable()}).optional().nullable()}).optional().nullable(),status:c.enum(["completed","incomplete","failed","cancelled","in_progress"]).optional().nullable(),status_details:c.record(c.string(),c.any()).optional().nullable(),usage:c.object({input_tokens:c.number().optional(),input_token_details:c.record(c.string(),c.any()).optional().nullable(),output_tokens:c.number().optional(),output_token_details:c.record(c.string(),c.any()).optional().nullable()}).optional().nullable()}),sO=c.object({id:c.string().optional(),audio:c.string().nullable().optional(),text:c.string().nullable().optional(),transcript:c.string().nullable().optional(),type:c.union([c.literal("input_text"),c.literal("input_audio"),c.literal("item_reference"),c.literal("output_text"),c.literal("output_audio")])}),Wo=c.object({id:c.string().optional(),arguments:c.string().optional(),call_id:c.string().optional(),content:c.array(sO).optional(),name:c.string().optional(),output:c.string().nullable().optional(),role:c.enum(["user","assistant","system"]).optional(),status:c.enum(["completed","incomplete","in_progress"]).optional(),type:c.enum(["message","function_call","function_call_output","mcp_list_tools","mcp_tool_call","mcp_call","mcp_approval_request","mcp_approval_response"]).optional(),approval_request_id:c.string().nullable().optional(),approve:c.boolean().nullable().optional(),reason:c.string().nullable().optional(),server_label:c.string().optional(),error:c.any().nullable().optional(),tools:c.array(c.object({name:c.string(),description:c.string(),input_schema:c.record(c.any()).optional()}).passthrough()).optional()}).passthrough(),aO=c.object({type:c.literal("conversation.created"),event_id:c.string(),conversation:c.object({id:c.string().optional(),object:c.literal("realtime.conversation").optional()})}),cO=c.object({type:c.literal("conversation.item.added"),event_id:c.string(),item:Wo,previous_item_id:c.string().nullable().optional()}),uO=c.object({type:c.literal("conversation.item.done"),event_id:c.string(),item:Wo,previous_item_id:c.string().nullable().optional()}),lO=c.object({type:c.literal("conversation.item.deleted"),event_id:c.string(),item_id:c.string()}),dO=c.object({type:c.literal("conversation.item.input_audio_transcription.completed"),event_id:c.string(),item_id:c.string(),content_index:c.number(),transcript:c.string(),logprobs:c.array(c.any()).nullable().optional()}),fO=c.object({type:c.literal("conversation.item.input_audio_transcription.delta"),event_id:c.string(),item_id:c.string(),content_index:c.number().optional(),delta:c.string().optional(),logprobs:c.array(c.any()).nullable().optional()}),pO=c.object({type:c.literal("conversation.item.input_audio_transcription.failed"),event_id:c.string(),item_id:c.string(),content_index:c.number(),error:c.object({code:c.string().optional(),message:c.string().optional(),param:c.string().optional(),type:c.string().optional()})}),hO=c.object({type:c.literal("conversation.item.retrieved"),event_id:c.string(),item:Wo}),mO=c.object({type:c.literal("conversation.item.truncated"),event_id:c.string(),item_id:c.string(),audio_end_ms:c.number(),content_index:c.number()}),gO=c.object({type:c.literal("conversation.item.create"),item:Wo,event_id:c.string().optional(),previous_item_id:c.string().nullable().optional()}),yO=c.object({type:c.literal("conversation.item.delete"),item_id:c.string(),event_id:c.string().optional()}),vO=c.object({type:c.literal("conversation.item.retrieve"),item_id:c.string(),event_id:c.string().optional()}),_O=c.object({type:c.literal("conversation.item.truncate"),item_id:c.string(),audio_end_ms:c.number(),content_index:c.number(),event_id:c.string().optional()}),IO=c.object({type:c.literal("error"),event_id:c.string().optional(),error:c.any().optional()}),wO=c.object({type:c.literal("input_audio_buffer.cleared"),event_id:c.string()}),bO=c.object({type:c.literal("input_audio_buffer.append"),audio:c.string(),event_id:c.string().optional()}),EO=c.object({type:c.literal("input_audio_buffer.clear"),event_id:c.string().optional()}),SO=c.object({type:c.literal("input_audio_buffer.commit"),event_id:c.string().optional()}),TO=c.object({type:c.literal("input_audio_buffer.committed"),event_id:c.string(),item_id:c.string(),previous_item_id:c.string().nullable().optional()}),xO=c.object({type:c.literal("input_audio_buffer.speech_started"),event_id:c.string(),item_id:c.string(),audio_start_ms:c.number()}),CO=c.object({type:c.literal("input_audio_buffer.speech_stopped"),event_id:c.string(),item_id:c.string(),audio_end_ms:c.number()}),DO=c.object({type:c.literal("output_audio_buffer.started"),event_id:c.string()}).passthrough(),MO=c.object({type:c.literal("output_audio_buffer.stopped"),event_id:c.string()}).passthrough(),AO=c.object({type:c.literal("output_audio_buffer.cleared"),event_id:c.string()}),NO=c.object({type:c.literal("rate_limits.updated"),event_id:c.string(),rate_limits:c.array(c.object({limit:c.number().optional(),name:c.enum(["requests","tokens"]).optional(),remaining:c.number().optional(),reset_seconds:c.number().optional()}))}),RO=c.object({type:c.literal("response.output_audio.delta"),event_id:c.string(),item_id:c.string(),content_index:c.number(),delta:c.string(),output_index:c.number(),response_id:c.string()}),OO=c.object({type:c.literal("response.output_audio.done"),event_id:c.string(),item_id:c.string(),content_index:c.number(),output_index:c.number(),response_id:c.string()}),kO=c.object({type:c.literal("response.output_audio_transcript.delta"),event_id:c.string(),item_id:c.string(),content_index:c.number(),delta:c.string(),output_index:c.number(),response_id:c.string()}),PO=c.object({type:c.literal("response.output_audio_transcript.done"),event_id:c.string(),item_id:c.string(),content_index:c.number(),transcript:c.string(),output_index:c.number(),response_id:c.string()}),LO=c.object({type:c.literal("response.content_part.added"),event_id:c.string(),item_id:c.string(),content_index:c.number(),output_index:c.number(),response_id:c.string(),part:c.object({audio:c.string().optional(),text:c.string().optional(),transcript:c.string().optional(),type:c.enum(["text","audio"]).optional()})}),jO=c.object({type:c.literal("response.content_part.done"),event_id:c.string(),item_id:c.string(),content_index:c.number(),output_index:c.number(),response_id:c.string(),part:c.object({audio:c.string().optional(),text:c.string().optional(),transcript:c.string().optional(),type:c.enum(["text","audio"]).optional()})}),FO=c.object({type:c.literal("response.created"),event_id:c.string(),response:ub}),fh=c.object({type:c.literal("response.done"),event_id:c.string(),response:ub}),$O=c.object({type:c.literal("response.function_call_arguments.delta"),event_id:c.string(),item_id:c.string(),call_id:c.string(),delta:c.string(),output_index:c.number(),response_id:c.string()}),UO=c.object({type:c.literal("response.function_call_arguments.done"),event_id:c.string(),item_id:c.string(),call_id:c.string(),arguments:c.string(),output_index:c.number(),response_id:c.string()}),HO=c.object({type:c.literal("response.output_item.added"),event_id:c.string(),item:Wo,output_index:c.number(),response_id:c.string()}),VO=c.object({type:c.literal("response.output_item.done"),event_id:c.string(),item:Wo,output_index:c.number(),response_id:c.string()}),BO=c.object({type:c.literal("response.output_text.delta"),event_id:c.string(),item_id:c.string(),content_index:c.number(),delta:c.string(),output_index:c.number(),response_id:c.string()}),zO=c.object({type:c.literal("response.output_text.done"),event_id:c.string(),item_id:c.string(),content_index:c.number(),text:c.string(),output_index:c.number(),response_id:c.string()}),qO=c.object({type:c.literal("session.created"),event_id:c.string(),session:c.any()}),GO=c.object({type:c.literal("session.updated"),event_id:c.string(),session:c.any()}),WO=c.object({type:c.literal("response.cancel"),event_id:c.string().optional(),response_id:c.string().optional()}),ZO=c.object({type:c.literal("response.create"),event_id:c.string().optional(),response:c.any().optional()}),JO=c.object({type:c.literal("session.update"),event_id:c.string().optional(),session:c.any()}),QO=c.object({type:c.literal("mcp_list_tools.in_progress"),event_id:c.string().optional(),item_id:c.string().optional()}),YO=c.object({type:c.literal("mcp_list_tools.completed"),event_id:c.string().optional(),item_id:c.string().optional()}),KO=c.object({type:c.literal("response.mcp_call_arguments.delta"),event_id:c.string(),response_id:c.string(),item_id:c.string(),output_index:c.number(),delta:c.string(),obfuscation:c.string()}),XO=c.object({type:c.literal("response.mcp_call_arguments.done"),event_id:c.string(),response_id:c.string(),item_id:c.string(),output_index:c.number(),arguments:c.string()}),ek=c.object({type:c.literal("response.mcp_call.in_progress"),event_id:c.string(),output_index:c.number(),item_id:c.string()}),tk=c.object({type:c.literal("response.mcp_call.completed"),event_id:c.string(),output_index:c.number(),item_id:c.string()}),nk=c.object({type:c.literal("mcp_list_tools.failed"),event_id:c.string().optional(),item_id:c.string().optional()}),rk=c.object({type:c.string(),event_id:c.string().optional().nullable()}).passthrough(),ok=c.discriminatedUnion("type",[aO,cO,uO,lO,dO,fO,pO,hO,mO,IO,wO,TO,xO,CO,DO,MO,AO,NO,RO,OO,kO,PO,LO,jO,FO,fh,$O,UO,HO,VO,BO,zO,qO,GO,QO,YO,nk,KO,XO,ek,tk]),YQ=c.discriminatedUnion("type",[gO,yO,vO,_O,bO,EO,SO,WO,ZO,JO]);function Zo(e){let t=JSON.parse(e.data.toString()),n=ok.safeParse(t);if(!n.success){let r=rk.safeParse(t);return r.success?{data:r.data,isGeneric:!0}:{data:null,isGeneric:!0}}return{data:n.data,isGeneric:!1}}var lb="gpt-realtime",at={outputModalities:["audio"],audio:{input:{format:{type:"audio/pcm",rate:24e3},transcription:{model:"gpt-4o-mini-transcribe"},turnDetection:{type:"semantic_vad"},noiseReduction:null},output:{format:{type:"audio/pcm",rate:24e3},speed:1}}},Fr=class e extends Dr{#e;#t;#o=null;#n=null;eventEmitter=new zt;constructor(t={}){super(),this.#e=t.model??lb,this.#t=t.apiKey}get currentModel(){return this.#e}set currentModel(t){this.#e=t}_afterAudioDoneEvent(){}get _rawSessionConfig(){return this.#n??null}async _getApiKey(t){let n=t.apiKey??this.#t;return typeof n=="function"?await n():n}_onMessage(t){let{data:n,isGeneric:r}=Zo(t);if(n!==null&&(this.emit("*",n),!r)){if(n.type==="error"?this.emit("error",{type:"error",error:n}):this.emit(n.type,n),n.type==="response.created"){this.emit("turn_started",{type:"response_started",providerData:p({},n)});return}if(n.type==="session.updated"&&(this.#n=n.session),n.type==="response.done"){let o=fh.safeParse(n);if(!o.success){je.error("Error parsing response done event",o.error);return}let i=o.data.response.usage?.input_tokens??0,s=o.data.response.usage?.output_tokens??0,a=i+s,u=new St({inputTokens:i,inputTokensDetails:o.data.response.usage?.input_token_details??{},outputTokens:s,outputTokensDetails:o.data.response.usage?.output_token_details??{},totalTokens:a});this.emit("usage_update",u),this.emit("turn_done",{type:"response_done",response:{id:o.data.response.id??"",output:o.data.response.output??[],usage:{inputTokens:i,inputTokensDetails:o.data.response.usage?.input_token_details??{},outputTokens:s,outputTokensDetails:o.data.response.usage?.output_token_details??{},totalTokens:a}}});return}if(n.type==="response.output_audio.done"){this.emit("audio_done"),this._afterAudioDoneEvent();return}if(n.type==="conversation.item.deleted"){this.emit("item_deleted",{itemId:n.item_id});return}if(n.type==="conversation.item.input_audio_transcription.completed"||n.type==="conversation.item.truncated"){this.sendEvent({type:"conversation.item.retrieve",item_id:n.item_id});return}if(n.type==="conversation.item.input_audio_transcription.delta"||n.type==="response.output_text.delta"||n.type==="response.output_audio_transcript.delta"||n.type==="response.function_call_arguments.delta"){n.type==="response.output_audio_transcript.delta"&&this.emit("audio_transcript_delta",{type:"transcript_delta",delta:n.delta,itemId:n.item_id,responseId:n.response_id});return}if(n.type==="conversation.item.added"||n.type==="conversation.item.done"||n.type==="conversation.item.retrieved"){if(n.item.type==="mcp_list_tools"&&n.type==="conversation.item.done"){let o=n.item.server_label??"",i=n.item.tools??[];try{this.emit("mcp_tools_listed",{serverLabel:o,tools:i})}catch(s){je.error("Error emitting mcp_tools_listed",s,n.item)}return}if(n.item.type==="message"){let o=n.type==="conversation.item.added"||n.type==="conversation.item.done"?n.previous_item_id:null,i=uh.parse({itemId:n.item.id,previousItemId:o,type:n.item.type,role:n.item.role,content:n.item.content,status:n.item.status});this.emit("item_update",i);return}if(n.item.type==="mcp_approval_request"&&n.type==="conversation.item.done"){let o=n.item,i=cb.parse({itemId:o.id,type:o.type,serverLabel:o.server_label,name:o.name,arguments:JSON.parse(o.arguments||"{}"),approved:o.approved});this.emit("item_update",i),this.emit("mcp_approval_request",i);return}if(n.item.type==="mcp_tool_call"||n.item.type==="mcp_call"){let o=n.type==="conversation.item.done"?"completed":"in_progress",i=dh.parse({itemId:n.item.id,type:n.item.type,status:o,arguments:n.item.arguments,name:n.item.name,output:n.item.output});this.emit("item_update",i),n.type==="conversation.item.done"&&this.emit("mcp_tool_call_completed",i);return}}if(n.type==="response.mcp_call.in_progress"){let o=n;this.sendEvent({type:"conversation.item.retrieve",item_id:o.item_id});return}if(n.type==="mcp_list_tools.in_progress"){let o=n;o.item_id&&this.sendEvent({type:"conversation.item.retrieve",item_id:o.item_id});return}if(n.type==="response.output_item.done"||n.type==="response.output_item.added"){let o=n.item;if(o.type==="function_call"&&o.status==="completed"){let i=lh.parse({itemId:o.id,type:o.type,status:"in_progress",arguments:o.arguments,name:o.name,output:null});this.emit("item_update",i),this.emit("function_call",{id:o.id,type:"function_call",callId:o.call_id??"",arguments:o.arguments??"",name:o.name??""});return}if(o.type==="mcp_tool_call"||o.type==="mcp_call"){let i=dh.parse({itemId:o.id,type:o.type,status:n.type==="response.output_item.done"?"completed":"in_progress",arguments:o.arguments,name:o.name,output:o.output});this.emit("item_update",i);return}if(o.type==="message"){let i=uh.parse({itemId:n.item.id,type:n.item.type,role:n.item.role,content:n.item.content,status:n.type==="response.output_item.done"?o.status??"completed":o.status??"in_progress"});this.emit("item_update",i);return}}}}_onError(t){this.emit("error",{type:"error",error:t})}_onOpen(){this.emit("connected")}_onClose(){this.emit("disconnected")}sendMessage(t,n,{triggerResponse:r=!0}={}){let o=typeof t=="string"?[{type:"input_text",text:t}]:t.content.map(i=>i.type==="input_image"?p({type:"input_image",image_url:i.image},i.providerData??{}):i);this.sendEvent(p({type:"conversation.item.create",item:{type:"message",role:"user",content:o}},n)),r&&this.sendEvent({type:"response.create"})}addImage(t,{triggerResponse:n=!0}={}){this.sendMessage({type:"message",role:"user",content:[{type:"input_image",image:t}]},{},{triggerResponse:n})}_getMergedSessionConfig(t){let n=ab(t),r=p({type:"realtime",instructions:n.instructions,model:n.model??this.#e,output_modalities:n.outputModalities??at.outputModalities,audio:{input:{format:n.audio?.input?.format??at.audio?.input?.format,noise_reduction:n.audio?.input?.noiseReduction??at.audio?.input?.noiseReduction,transcription:n.audio?.input?.transcription??at.audio?.input?.transcription,turn_detection:e.buildTurnDetectionConfig(n.audio?.input?.turnDetection)??at.audio?.input?.turnDetection},output:{format:n.audio?.output?.format??at.audio?.output?.format,voice:n.audio?.output?.voice??at.audio?.output?.voice,speed:n.audio?.output?.speed??at.audio?.output?.speed}},tool_choice:n.toolChoice??at.toolChoice},n.providerData??{});return n.prompt&&(r.prompt={id:n.prompt.promptId,version:n.prompt.version,variables:n.prompt.variables}),n.tools&&n.tools.length>0&&(r.tools=n.tools.map(o=>g(p({},o),{strict:void 0}))),r}buildSessionPayload(t){return this._getMergedSessionConfig(t)}static buildTurnDetectionConfig(t){if(typeof t>"u")return;let I=t,{type:n,createResponse:r,create_response:o,eagerness:i,interruptResponse:s,interrupt_response:a,prefixPaddingMs:u,prefix_padding_ms:l,silenceDurationMs:d,silence_duration_ms:f,threshold:m,idleTimeoutMs:h,idle_timeout_ms:y}=I,v=Wt(I,["type","createResponse","create_response","eagerness","interruptResponse","interrupt_response","prefixPaddingMs","prefix_padding_ms","silenceDurationMs","silence_duration_ms","threshold","idleTimeoutMs","idle_timeout_ms"]),_=p({type:n,create_response:r||o,eagerness:i,interrupt_response:s||a,prefix_padding_ms:u||l,silence_duration_ms:d||f,idle_timeout_ms:h||y,threshold:m},v);return Object.keys(_).forEach(w=>{_[w]===void 0&&delete _[w]}),Object.keys(_).length>0?_:void 0}set _tracingConfig(t){this.#o=t}_updateTracingConfig(t){if(typeof this.#o>"u"&&(this.#o=null),t==="auto"){this.sendEvent({type:"session.update",session:{type:"realtime",tracing:"auto"}});return}if(this.#o!==null&&typeof this.#o!="string"&&typeof t!="string"){je.warn("Tracing config is already set, skipping setting it again. This likely happens when you already set a tracing config on session creation.");return}if(t===null){je.debug("Disabling tracing for this session. It cannot be turned on for this session from this point on."),this.sendEvent({type:"session.update",session:{type:"realtime",tracing:null}});return}if(this.#o===null||typeof this.#o=="string"){this.sendEvent({type:"session.update",session:{type:"realtime",tracing:t}});return}if(t?.group_id!==this.#o?.group_id||t?.metadata!==this.#o?.metadata||t?.workflow_name!==this.#o?.workflow_name){je.warn("Mismatch in tracing config. Ignoring the new tracing config. This likely happens when you already set a tracing config on session creation. Current tracing config: %s, new tracing config: %s",JSON.stringify(this.#o),JSON.stringify(t));return}this.sendEvent({type:"session.update",session:{type:"realtime",tracing:t}})}updateSessionConfig(t){let n=this.buildSessionPayload(t);this.sendEvent({type:"session.update",session:n})}sendFunctionCallOutput(t,n,r=!0){this.sendEvent({type:"conversation.item.create",item:{type:"function_call_output",output:n,call_id:t.callId}});try{let o=lh.parse({itemId:t.id,previousItemId:t.previousItemId,type:"function_call",status:"completed",arguments:t.arguments,name:t.name,output:n});this.emit("item_update",o)}catch(o){je.error("Error parsing tool call item",o,t)}r&&this.sendEvent({type:"response.create"})}sendAudio(t,{commit:n=!1}={}){this.sendEvent({type:"input_audio_buffer.append",audio:ih(t)}),n&&this.sendEvent({type:"input_audio_buffer.commit"})}resetHistory(t,n){let{removals:r,additions:o,updates:i}=eb(t,n),s=new Set(r.map(u=>u.itemId));for(let u of i)s.add(u.itemId);if(s.size>0)for(let u of s)this.sendEvent({type:"conversation.item.delete",item_id:u});let a=[...o,...i];for(let u of a)if(u.type==="message"){let l={type:"message",role:u.role,content:u.content,id:u.itemId};u.role!=="system"&&u.status&&(l.status=u.status),this.sendEvent({type:"conversation.item.create",item:l})}else u.type==="function_call"&&je.warn("Function calls cannot be manually added or updated at the moment. Ignoring.")}sendMcpResponse(t,n){this.sendEvent({type:"conversation.item.create",previous_item_id:t.itemId,item:{type:"mcp_approval_response",approval_request_id:t.itemId,approve:n}})}};var $s=class extends Fr{options;#e;#t={status:"disconnected",peerConnection:void 0,dataChannel:void 0,callId:void 0};#o;#n=!1;#a=!1;constructor(t={}){if(typeof RTCPeerConnection>"u")throw new Error("WebRTC is not supported in this environment");super(t),this.options=t,this.#e=t.baseUrl??"https://api.openai.com/v1/realtime/calls",this.#o=t.useInsecureApiKey??!1}get callId(){return this.#t.callId}get status(){return this.#t.status}get connectionState(){return this.#t}get muted(){return this.#a}async connect(t){if(this.#t.status==="connected")return;this.#t.status==="connecting"&&je.warn("Realtime connection already in progress. Please await original promise");let n=t.model??this.currentModel;this.currentModel=n;let r=t.url??this.#e,o=await this._getApiKey(t),i=typeof o=="string"&&o.startsWith("ek_");if(lu()&&!this.#o&&!i)throw new B("Using the WebRTC connection in a browser environment requires an ephemeral client key. If you need to use a regular API key, use the WebSocket transport or set the `useInsecureApiKey` option to true.");return new Promise(async(s,a)=>{try{let u=g(p({},t.initialSessionConfig||{}),{model:this.currentModel}),l=new URL(r),d=new RTCPeerConnection,f=d.createDataChannel("oai-events"),m,h=N=>{N.onconnectionstatechange=()=>{switch(N.connectionState){case"disconnected":case"failed":case"closed":this.close();break}}};h(d),this.#t={status:"connecting",peerConnection:d,dataChannel:f,callId:m},this.emit("connection_change",this.#t.status),f.addEventListener("open",()=>{this.#t={status:"connected",peerConnection:d,dataChannel:f,callId:m},this.updateSessionConfig(u),this.emit("connection_change",this.#t.status),this._onOpen(),s()}),f.addEventListener("error",N=>{this.close(),this._onError(N),a(N)}),f.addEventListener("message",N=>{this._onMessage(N);let{data:S,isGeneric:T}=Zo(N);if(!(!S||T)&&(S.type==="response.created"?this.#n=!0:S.type==="response.done"&&(this.#n=!1),S.type==="session.created")){this._tracingConfig=S.session.tracing;let R=typeof u.tracing>"u"?"auto":u.tracing;this._updateTracingConfig(R)}});let y=this.options.audioElement??document.createElement("audio");y.autoplay=!0,d.ontrack=N=>{y.srcObject=N.streams[0]};let v=this.options.mediaStream??await navigator.mediaDevices.getUserMedia({audio:!0});if(d.addTrack(v.getAudioTracks()[0]),this.options.changePeerConnection){let N=d;d=await this.options.changePeerConnection(d),N!==d&&(N.onconnectionstatechange=null),h(d),this.#t=g(p({},this.#t),{peerConnection:d})}let _=await d.createOffer();if(await d.setLocalDescription(_),!_.sdp)throw new Error("Failed to create offer");let I=await fetch(l,{method:"POST",body:_.sdp,headers:{"Content-Type":"application/sdp",Authorization:`Bearer ${o}`,"X-OpenAI-Agents-SDK":Du["X-OpenAI-Agents-SDK"]}});m=I.headers?.get("Location")?.split("/").pop(),this.#t=g(p({},this.#t),{callId:m});let w={type:"answer",sdp:await I.text()};await d.setRemoteDescription(w)}catch(u){this.close(),this._onError(u),a(u)}})}sendEvent(t){if(!this.#t.dataChannel||this.#t.dataChannel.readyState!=="open")throw new Error("WebRTC data channel is not connected. Make sure you call `connect()` before sending events.");this.#t.dataChannel.send(JSON.stringify(t))}mute(t){this.#a=t,this.#t.peerConnection&&this.#t.peerConnection.getSenders().forEach(r=>{r.track&&(r.track.enabled=!t)})}_afterAudioDoneEvent(){this.#n=!1}close(){if(this.#t.dataChannel&&this.#t.dataChannel.close(),this.#t.peerConnection){let t=this.#t.peerConnection;t.onconnectionstatechange=null,t.getSenders().forEach(n=>{n.track?.stop()}),t.close()}this.#t.status!=="disconnected"&&(this.#t={status:"disconnected",peerConnection:void 0,dataChannel:void 0,callId:void 0},this.emit("connection_change",this.#t.status),this._onClose())}interrupt(){this.#n&&(this.sendEvent({type:"response.cancel"}),this.#n=!1),this.sendEvent({type:"output_audio_buffer.clear"})}};var db=globalThis.WebSocket;function fb(){return!0}var pb=!0;var Jo=class extends Fr{#e;#t;#o;#n={status:"disconnected",websocket:void 0};#a;#i;#s;_firstAudioTimestamp;_audioLengthMs=0;#r=!1;#c;#l;#u(){this.#i=void 0,this._firstAudioTimestamp=void 0,this._audioLengthMs=0,this.#s=void 0}constructor(t={}){super(t),this.#t=t.url,this.#o=t.url,this.#a=t.useInsecureApiKey??!1,this.#c=t.createWebSocket,this.#l=t.skipOpenEventListeners??!1}getCommonRequestHeaders(){return Du}get status(){return this.#n.status}get connectionState(){return this.#n}get muted(){return null}get currentItemId(){return this.#i}_onAudio(t){this.emit("audio",t)}_afterAudioDoneEvent(){this.#u()}async#f(t,n,r){if(this.#n.websocket){t();return}if(!this.#e)throw new B("API key is not set. Please call `connect()` with an API key first.");if(fb()&&!this.#e.startsWith("ek_")&&!this.#a)throw new B("Using the WebSocket connection in a browser environment requires an ephemeral client key. If you have to use a regular API key, set the `useInsecureApiKey` option to true.");let o=null;if(this.#c)o=await this.#c({url:this.#t,apiKey:this.#e});else{let s=pb?["realtime","openai-insecure-api-key."+this.#e,nb]:{headers:p({Authorization:`Bearer ${this.#e}`},this.getCommonRequestHeaders())};o=new db(this.#t,s)}this.#n={status:"connecting",websocket:o},this.emit("connection_change",this.#n.status);let i=()=>{this.#n={status:"connected",websocket:o},this.emit("connection_change",this.#n.status),this._onOpen(),t()};this.#l===!0?i():o.addEventListener("open",i),o.addEventListener("error",s=>{this._onError(s),this.#n={status:"disconnected",websocket:void 0},this.emit("connection_change",this.#n.status),n(s)}),o.addEventListener("message",s=>{this._onMessage(s);let{data:a,isGeneric:u}=Zo(s);if(!(!a||u)){if(a.type==="response.output_audio.delta"){this.#s=a.content_index,this.#i=a.item_id,this._firstAudioTimestamp===void 0&&(this._firstAudioTimestamp=Date.now(),this._audioLengthMs=0);let l=oh(a.delta),d=this._rawSessionConfig?.audio?.output?.format;if(d&&typeof d=="object"){let m=d.type;if(m==="audio/pcmu"||m==="audio/pcma")this._audioLengthMs+=l.byteLength/8;else if(m==="audio/pcm"){let h=d.rate??24e3;this._audioLengthMs+=l.byteLength/2/h*1e3}else this._audioLengthMs+=l.byteLength/24/2}else typeof d=="string"?d.startsWith("g711_")?this._audioLengthMs+=l.byteLength/8:this._audioLengthMs+=l.byteLength/24/2:this._audioLengthMs+=l.byteLength/24/2;let f={type:"audio",data:l,responseId:a.response_id};this._onAudio(f)}else if(a.type==="input_audio_buffer.speech_started"){let l=this._rawSessionConfig?.audio?.input?.turn_detection?.interrupt_response??!1;this.interrupt(!l)}else if(a.type==="response.created")this.#r=!0;else if(a.type==="response.done")this.#r=!1;else if(a.type==="session.created"){this._tracingConfig=a.session.tracing;let l=typeof r.tracing>"u"?"auto":r.tracing;this._updateTracingConfig(l)}}}),o.addEventListener("close",()=>{this.#n={status:"disconnected",websocket:void 0},this.emit("connection_change",this.#n.status),this._onClose()})}async connect(t){let n=t.model??this.currentModel;this.currentModel=n,this.#e=await this._getApiKey(t);let r=t.callId,o;t.url?(o=t.url,this.#o=t.url):r?o=`wss://api.openai.com/v1/realtime?call_id=${r}`:this.#o?o=this.#o:o=`wss://api.openai.com/v1/realtime?model=${this.currentModel}`,this.#t=o;let i=g(p({},t.initialSessionConfig||{}),{model:this.currentModel});await new Promise((s,a)=>{this.#f(s,a,i).catch(a)}),await this.updateSessionConfig(i)}sendEvent(t){if(!this.#n.websocket)throw new Error("WebSocket is not connected. Make sure you call `connect()` before sending events.");this.#n.websocket.send(JSON.stringify(t))}close(){this.#n.websocket?.close(),this.#i=void 0,this._firstAudioTimestamp=void 0,this._audioLengthMs=0,this.#s=void 0}mute(t){throw new Error("Mute is not supported for the WebSocket transport. You have to mute the audio input yourself.")}sendAudio(t,n={}){this.#n.status==="connected"&&super.sendAudio(t,n)}_cancelResponse(){this.#r&&(this.sendEvent({type:"response.cancel"}),this.#r=!1)}_interrupt(t,n=!0){if(t<0)return;n&&this._cancelResponse();let r=this._audioLengthMs??Number.POSITIVE_INFINITY,o=Math.max(0,Math.floor(Math.min(t,r)));this.emit("audio_interrupted"),this.sendEvent({type:"conversation.item.truncate",item_id:this.#i,content_index:this.#s,audio_end_ms:o})}interrupt(t=!0){if(!this.#i||typeof this._firstAudioTimestamp!="number")return;let n=Date.now()-this._firstAudioTimestamp;n>=0&&this._interrupt(n,t),this.#u()}};var ik=Symbol("backgroundResult");function ph(e){return typeof e=="object"&&e!==null&&ik in e}function hb(e){return e.type==="function"||e.type==="hosted_tool"&&e.name==="hosted_mcp"}function mb(e){if(e.type==="function")return e;if(e.type==="hosted_tool"&&e.name==="hosted_mcp"){let t=e.providerData.server_url&&e.providerData.server_url.length>0?e.providerData.server_url:void 0;return{type:"mcp",server_label:e.providerData.server_label,server_url:t,headers:e.providerData.headers,allowed_tools:e.providerData.allowed_tools,require_approval:e.providerData.require_approval}}throw new B(`Invalid tool type: ${e}`)}function sk(){return JSON.parse(JSON.stringify(at))}var Qo=class e extends zt{initialAgent;options;#e;#t;#o;#n;#a=[];#i;#s={};#r=[];#c;#l={};#u=!1;#f=new Map;#d=[];#g=sk();#y=!0;constructor(t,n={}){super(),this.initialAgent=t,this.options=n,typeof n.transport>"u"&&tb()||n.transport==="webrtc"?this.#e=new $s:n.transport==="websocket"||typeof n.transport>"u"?this.#e=new Jo:this.#e=n.transport,this.#t=t,this.#n=new ot(g(p({},n.context??{}),{history:this.#r})),this.#a=(n.outputGuardrails??[]).map(ib),this.#i=ob(n.outputGuardrailSettings??{}),this.#c=n.historyStoreAudio??!1,this.#y=n.automaticallyTriggerResponseForMcpToolCalls??!0}get transport(){return this.#e}get currentAgent(){return this.#t}get usage(){return this.#n.usage}get context(){return this.#n}get muted(){return this.#e.muted}get history(){return this.#r}get availableMcpTools(){return this.#d}async#p(t){this.#t=t;let n=await this.#t.getEnabledHandoffs(this.#n),r=n.map(a=>a.getHandoffAsFunctionTool()),o=(await this.#t.getAllTools(this.#n)).filter(hb).map(mb),i=typeof this.#t.tools<"u"||typeof this.#t.mcpServers<"u",s=n.length>0;this.#o=i||s?[...o,...r]:void 0,this.#_()}async#h(t={}){let n=t??{},r=this.options.config??{},o=await this.#t.getSystemPrompt(this.#n),i=m=>m.audio?.output?.voice,s=this.options.tracingDisabled?null:this.options.workflowName?{workflow_name:this.options.workflowName}:"auto";s!==null&&s!=="auto"?(this.options.groupId&&(s.group_id=this.options.groupId),this.options.traceMetadata&&(s.metadata=this.options.traceMetadata)):(this.options.groupId||this.options.traceMetadata)&&je.warn("In order to set traceMetadata or a groupId you need to specify a workflowName.");let a=i(n)??i(r),u=n.voice??r.voice,l=typeof a<"u"?a:typeof u<"u"?u:this.#t.voice,d=p(p(p({},this.#g??{}),r),n),f=g(p({},d),{instructions:o,voice:l,model:this.options.model,tools:this.#o,tracing:s,prompt:typeof this.#t.prompt=="function"?await this.#t.prompt(this.#n,this.#t):this.#t.prompt});return this.#g=f,f}async getInitialSessionConfig(t={}){return await this.#p(this.initialAgent),this.#h(p(p({},this.options.config??{}),t??{}))}static async computeInitialSessionConfig(t,n={},r={}){let o=new e(t,n);try{return await o.getInitialSessionConfig(r)}finally{o.close()}}async updateAgent(t){return this.#t.emit("agent_handoff",this.#n,t),this.emit("agent_handoff",this.#n,this.#t,t),await this.#p(t),await this.#e.updateSessionConfig(await this.#h()),t}async#I(t,n){let r=await n.onInvokeHandoff(this.#n,t.arguments);this.#t.emit("agent_handoff",this.#n,r),this.emit("agent_handoff",this.#n,this.#t,r),await this.#p(r),await this.#e.updateSessionConfig(await this.#h());let o=xs(r);return this.#e.sendFunctionCallOutput(t,o,!0),r}async#m(t,n){this.#n.context.history=JSON.parse(JSON.stringify(this.#r));let r=t.arguments;if(n.parameters&&(Qe(n.parameters)?r=n.parameters.parse(r):r=JSON.parse(r)),await n.needsApproval(this.#n,r,t.callId)){let a=this.context.isToolApproved({toolName:n.name,callId:t.callId});if(a===!1){this.emit("agent_tool_start",this.#n,this.#t,n,{toolCall:t}),this.#t.emit("agent_tool_start",this.#n,n,{toolCall:t});let u="Tool execution was not approved.";this.#e.sendFunctionCallOutput(t,u,!0),this.emit("agent_tool_end",this.#n,this.#t,n,u,{toolCall:t}),this.#t.emit("agent_tool_end",this.#n,n,u,{toolCall:t});return}else if(typeof a>"u"){this.emit("tool_approval_requested",this.#n,this.#t,{type:"function_approval",tool:n,approvalItem:new ue(t,this.#t)});return}}this.emit("agent_tool_start",this.#n,this.#t,n,{toolCall:t}),this.#t.emit("agent_tool_start",this.#n,n,{toolCall:t}),this.#n.context.history=JSON.parse(JSON.stringify(this.#r));let i=await n.invoke(this.#n,t.arguments,{toolCall:t}),s;ph(i)?(s=Ye(i.content),this.#e.sendFunctionCallOutput(t,s,!1)):(s=Ye(i),this.#e.sendFunctionCallOutput(t,s,!0)),this.emit("agent_tool_end",this.#n,this.#t,n,s,{toolCall:t}),this.#t.emit("agent_tool_end",this.#n,n,s,{toolCall:t})}async#w(t){let n=await this.#t.getEnabledHandoffs(this.#n),r=new Map(n.map(a=>[a.toolName,a])),o=await this.#t.getAllTools(this.#n),i=new Map(o.map(a=>[a.name,a])),s=r.get(t.name);if(s)await this.#I(t,s);else{let a=i.get(t.name);if(a&&a.type==="function")await this.#m(t,a);else throw new ae(`Tool ${t.name} not found`)}}async#v(t,n,r){if(this.#a.length===0)return;let o={agent:this.#t,agentOutput:t,context:this.#n},s=(await Promise.all(this.#a.map(a=>a.run(o)))).find(a=>a.output.tripwireTriggered);if(s){if(this.#l[n])return;this.#l[n]=!0;let a=new ln(`Output guardrail triggered: ${JSON.stringify(s.output.outputInfo)}`,s);this.emit("guardrail_tripped",this.#n,this.#t,a,{itemId:r}),this.interrupt();let u=sb(s);this.sendMessage(u);return}}#b(){this.#e.on("*",r=>{if(this.emit("transport_event",r),r.type==="conversation.item.input_audio_transcription.completed")try{let o=r;this.#r=ah(this.#r,o,this.#c),this.#n.context.history=this.#r,this.emit("history_updated",this.#r)}catch(o){this.emit("error",{type:"error",error:o})}}),this.#e.on("mcp_tools_listed",({serverLabel:r,tools:o})=>{try{this.#f.set(r,o??[]),this.#_()}catch(i){this.emit("error",{type:"error",error:i})}}),this.#e.on("audio",r=>{this.#u||(this.#u=!0,this.emit("audio_start",this.#n,this.#t)),this.emit("audio",r)}),this.#e.on("turn_started",()=>{this.#u=!1,this.emit("agent_start",this.#n,this.#t),this.#t.emit("agent_start",this.#n,this.#t)}),this.#e.on("turn_done",r=>{let o=r.response.output[r.response.output.length-1],i=sh(o)??"",s=o?.id??"";this.emit("agent_end",this.#n,this.#t,i),this.#t.emit("agent_end",this.#n,i),this.#v(i,r.response.id,s)}),this.#e.on("audio_done",()=>{this.#u&&(this.#u=!1),this.emit("audio_stopped",this.#n,this.#t)});let t=0,n;this.#e.on("audio_transcript_delta",r=>{try{let o=r.delta,i=r.itemId,s=r.responseId;n!==i&&(n=i,t=0);let u=(this.#s[i]??"")+o;if(this.#s[i]=u,this.#i.debounceTextLength<0)return;let l=Math.floor(u.length/this.#i.debounceTextLength);l>t&&(t=l,this.#v(u,s,i))}catch(o){this.emit("error",{type:"error",error:o})}}),this.#e.on("item_update",r=>{try{let o=!this.#r.some(i=>i.itemId===r.itemId);if(this.#r=ah(this.#r,r,this.#c),this.#n.context.history=this.#r,o){let i=this.#r.find(s=>s.itemId===r.itemId);i&&this.emit("history_added",i)}this.emit("history_updated",this.#r)}catch(o){this.emit("error",{type:"error",error:o})}}),this.#e.on("item_deleted",r=>{try{this.#r=this.#r.filter(o=>o.itemId!==r.itemId),this.#n.context.history=this.#r,this.emit("history_updated",this.#r)}catch(o){this.emit("error",{type:"error",error:o})}}),this.#e.on("function_call",async r=>{try{await this.#w(r)}catch(o){je.error("Error handling function call",o),this.emit("error",{type:"error",error:o})}}),this.#e.on("usage_update",r=>{this.#n.usage.add(r)}),this.#e.on("audio_interrupted",()=>{this.#u&&(this.#u=!1),this.emit("audio_interrupted",this.#n,this.#t)}),this.#e.on("error",r=>{this.emit("error",r)}),this.#e.on("mcp_tool_call_completed",r=>{this.emit("mcp_tool_call_completed",this.#n,this.#t,r),this.#y&&this.#e.sendEvent({type:"response.create"})}),this.#e.on("mcp_approval_request",r=>{this.emit("tool_approval_requested",this.#n,this.#t,{type:"mcp_approval_request",approvalItem:rb(this.#t,r)})})}#_(){let t=this.#o?.filter(a=>a.type==="mcp"),n=a=>{let u=a.allowed_tools;if(u){if(Array.isArray(u))return u;if(u&&Array.isArray(u.tool_names))return u.tool_names}},r=new Map;for(let a of t){let u=this.#f.get(a.server_label)??[],l=n(a);for(let d of u)l&&!l.includes(d.name)||r.has(d.name)||r.set(d.name,d)}let o=Array.from(r.values()),i=this.#d;(i.length!==o.length||JSON.stringify(i.map(a=>a.name).sort())!==JSON.stringify(o.map(a=>a.name).sort()))&&(this.#d=o,this.emit("mcp_tools_changed",this.#d))}async connect(t){await this.#p(this.initialAgent),this.#b(),await this.#e.connect({apiKey:t.apiKey??this.options.apiKey,model:this.options.model,url:t.url,callId:t.callId,initialSessionConfig:await this.#h(this.options.config)}),this.#r=[],this.emit("history_updated",this.#r)}updateHistory(t){let n;typeof t=="function"?n=t(this.#r):n=t,this.#e.resetHistory(this.#r,n)}sendMessage(t,n={}){this.#e.sendMessage(t,n)}addImage(t,{triggerResponse:n=!0}={}){this.#e.addImage(t,{triggerResponse:n})}mute(t){this.#e.mute(t)}close(){this.#l={},this.#e.close()}sendAudio(t,n={}){this.#e.sendAudio(t,n)}interrupt(){this.#e.interrupt()}async approve(t,n={alwaysApprove:!1}){this.#n.approveTool(t,n);let r=t.toolName??t.rawItem.name,o=this.#t.tools.find(i=>i.name===r);if(o&&o.type==="function"&&t.rawItem.type==="function_call")await this.#m(t.rawItem,o);else if(t.rawItem.type==="hosted_tool_call"){n.alwaysApprove&&je.warn("Always approving MCP tools is not supported. Use the allowed tools configuration instead.");let i=ch(t);this.#e.sendMcpResponse(i,!0)}else throw new ae(`Tool ${r??"unknown"} not found`)}async reject(t,n={alwaysReject:!1}){this.#n.rejectTool(t,n);let r=t.toolName??t.rawItem.name,o=this.#t.tools.find(i=>i.name===r);if(o&&o.type==="function"&&t.rawItem.type==="function_call")await this.#m(t.rawItem,o);else if(t.rawItem.type==="hosted_tool_call"){n.alwaysReject&&je.warn("Always rejecting MCP tools is not supported. Use the allowed tools configuration instead.");let i=ch(t);this.#e.sendMcpResponse(i,!1)}else throw new ae(`Tool ${r??"unknown"} not found`)}};var gb=["Hungarian kings","astronomy","space exploration","hungarian history","the second world war"],yb=()=>gb[Math.floor(Math.random()*gb.length)],ak=(e,t)=>`
Act as a quizmaster. Speak Hungarian.
First greet the player called '${e}',
and then ask 3 random questions about ${t}.
Do not ask too simple questions.
When the player answers a question,
 call \`correct_answer\` if the answer was correct,
 otherwise call \`incorrect_answer\`.
After 3 question say goodbye, call \`end_conversation\` and end the quiz.`;function hh(e,t,n){return{type:"function",name:e,description:t,parameters:{type:"object",properties:{},required:[],additionalProperties:!1},strict:!1,needsApproval:async()=>!1,isEnabled:async()=>!0,invoke:n}}var mh=kt(null);async function vb(e,t,n){let r=await fetch("/api/token");if(!r.ok)throw new Error("Failed to fetch token.");let{token:o}=await r.json();console.log("Token:",o);let i=new Fs({name:"Three questions quiz",instructions:ak(e,t),voice:"ballad",tools:[hh("end_conversation","Call this function after the farewell at the end of the quiz",n.endConversation),hh("correct_answer","Call this function every time when the player responds with a correct answer",n.correctAnswer),hh("incorrect_answer","Call this function every time when the player responds with an incorrect answer",n.incorrectAnswer)]}),s=new Qo(i,{});await s.connect({apiKey:o}),s.sendMessage("Kezdj\xFCk!"),mh.set(s)}function gh(){mh()?.close(),mh.set(null)}var ck=["test"],uk=["intro"],lk=["outro"],dk=["correct"],fk=["incorrect"];function pk(e,t){if(e&1){let n=ji();xn(0,"button",15),fo("click",function(){Xr(n);let o=$i();return eo(o.enableMic())}),Lt(1,"img",16),nn()}}function hk(e,t){e&1&&Lt(0,"img",7)}function mk(e,t){if(e&1){let n=ji();xn(0,"button",15),fo("click",function(){Xr(n);let o=$i();return eo(o.start())}),Lt(1,"img",17),nn()}}function gk(e,t){if(e&1){let n=ji();xn(0,"button",15),fo("click",function(){Xr(n);let o=$i();return eo(o.stop())}),Lt(1,"img",18),nn()}}function yk(e,t){e&1&&Lt(0,"img",8)}function vk(e,t){e&1&&Lt(0,"img",9)}var Au=class e{status=kt("loading");testSound;introSound;outroSound;correctSound;incorrectSound;activatedRoute=x($t);ngAfterViewInit(){this.testSound.nativeElement.volume=.5,this.introSound.nativeElement.volume=.5,this.outroSound.nativeElement.volume=.3,this.correctSound.nativeElement.volume=.4,this.incorrectSound.nativeElement.volume=.5,this.checkPermissions()}checkPermissions(){navigator.permissions.query({name:"microphone"}).then(t=>{t.state==="granted"?(this.status.set("loading"),setTimeout(()=>this.status.set("ready"),2e3),console.log("Microphone permission granted.")):t.state==="prompt"?(this.status.set("noMic"),console.log("Need microphone permission.")):t.state==="denied"&&(this.status.set("error"),console.log("Microphone permission denied."))})}enableMic(){this.status.set("askForMic"),this.testSound.nativeElement.play(),navigator.mediaDevices.getUserMedia({video:!1,audio:!0}).finally(()=>{this.checkPermissions()})}start(){let t=this.activatedRoute.snapshot.queryParamMap.get("name")||"Karesz",n=this.activatedRoute.snapshot.queryParamMap.get("topic")||yb();console.log(`Name: ${t}`),console.log(`Topic: ${n}`),console.log("Starting quiz."),this.introSound.nativeElement.play(),this.status.set("starting"),setTimeout(()=>vb(t,n,{correctAnswer:()=>{console.log("Correct answer."),this.correctSound.nativeElement.play()},incorrectAnswer:()=>{console.log("Incorrect answer."),this.incorrectSound.nativeElement.play()},endConversation:()=>{console.log("End of quiz."),setTimeout(()=>{this.outroSound.nativeElement.play(),this.status.set("stopping")},2e3),setTimeout(()=>{gh(),this.status.set("ready")},16e3)}}).then(()=>{this.status.set("playing"),this.introSound.nativeElement.volume=.2}).catch(r=>{console.error(r),this.status.set("error")}),3e3)}stop(){this.status.set("stopping"),gh(),setTimeout(()=>this.status.set("ready"),1e3)}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=Pi({type:e,selectors:[["app-root"]],viewQuery:function(n,r){if(n&1&&(ur(ck,5),ur(uk,5),ur(lk,5),ur(dk,5),ur(fk,5)),n&2){let o;lr(o=dr())&&(r.testSound=o.first),lr(o=dr())&&(r.introSound=o.first),lr(o=dr())&&(r.outroSound=o.first),lr(o=dr())&&(r.correctSound=o.first),lr(o=dr())&&(r.incorrectSound=o.first)}},decls:18,vars:1,consts:[["test",""],["intro",""],["outro",""],["correct",""],["incorrect",""],[1,"flex","items-center","justify-center","h-screen","w-screen","bg-blue-900"],[1,"max-w-[60vw]","max-h-[60vh]","aspect-square"],["src","arrow.svg"],["src","error.svg"],["src","spinner.svg",1,"w-[100%]"],["src","test.mp3","preload","auto"],["src","intro.mp3","preload","auto"],["src","outro.mp3","preload","auto"],["src","correct.mp3","preload","auto"],["src","incorrect.mp3","preload","auto"],[3,"click"],["src","microphone.svg",1,"animate-[arrowBounce]"],["src","play.svg"],["src","stop.svg"]],template:function(n,r){if(n&1&&(xn(0,"div",5)(1,"div",6),tf(2,pk,2,0,"button")(3,hk,1,0,"img",7)(4,mk,2,0,"button")(5,gk,2,0,"button")(6,yk,1,0,"img",8)(7,vk,1,0,"img",9),nn(),Lt(8,"audio",10,0)(10,"audio",11,1)(12,"audio",12,2)(14,"audio",13,3)(16,"audio",14,4),nn()),n&2){let o;$d(2),rf((o=r.status())==="noMic"?2:o==="askForMic"?3:o==="ready"?4:o==="playing"?5:o==="error"?6:7)}},encapsulation:2})};_f(Au,v_).catch(e=>console.error(e));
